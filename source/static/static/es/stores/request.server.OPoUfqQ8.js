import{d as m}from"../pinia.DPawhP_y.js";import{M as n}from"../resources/util/map.BoklfroI.js";import{C as u}from"../resources/util/cache.indexeddb.CXuVJu8M.js";import{T as p}from"../resources/util/timer.util.DJ34cZ81.js";const D="NBA-API-ADMIN",i={storeName:"nba-api-cache",storeOptions:{keyPath:"id"}},s={storeName:"nba-other-config-cache",storeOptions:{keyPath:"id"}},l={indexName:"id",keyPath:"id",indexOptions:{}},f=[{store:i,index:l},{store:s,index:l}],g=4,I=m("request.server.default",{state:()=>({isShare:!1,domainOptions:[],selectEntityId:-1,entityMap:new n,defaultApiDetail:{id:-1,config:{method:"POST",header:[],query:[],bodyDocument:[],formBodyDocument:[],urlBodyDocument:[]}},apiDetail:{id:-1,config:{method:"POST",header:[],query:[],bodyDocument:[],formBodyDocument:[],urlBodyDocument:[]}},refreshApiTree:e=>{},batchReqNum:5,selectParentId:void 0,apiDetailClone:void 0,apiChangeDetail:new n,fileDetail:new n,runDetail:new n,apiDocDetail:{},refreshDocTree:e=>{},cacheHelp:new u(D,f,g)}),getters:{},actions:{reset(){this.$reset()},setRunDetail(e,t){const a=this.runDetail.putIfAbsent(e,()=>({}));if(a.loading=t,!t)return a.timer.pause();a.timer||(a.timer=new p),a.timer.reset(),a.timer.start(r=>{const o=Math.floor(r/1e3),c=Math.floor(o/60).toString().padStart(2,"0"),h=Math.floor(o%60).toString().padStart(2,"0"),d=Math.floor(r%1e3).toString().padStart(3,"0");a.time=`${c}:${h}:${d} (${Math.round(r).toString().padStart(6,"0")}ms)`})},getRunDetail(e){return this.runDetail.getOrDefault(e,()=>({}))},clearApiCache(e){e?(this.runDetail.remove(e),this.fileDetail.remove(e),this.apiChangeDetail.remove(e),this.cacheHelp.delete("id",IDBKeyRange.only(e),i.storeName)):(this.runDetail.clear(),this.fileDetail.clear(),this.apiChangeDetail.clear(),this.cacheHelp.deleteAll(i.storeName))},setFileDetail(e,t){this.fileDetail.putIfAbsent(e,()=>new n).put(t.name,t)},getFileDetail(e){return this.fileDetail.getOrDefault(e,()=>new n)},removeFileDetail(e,t){var a;(a=this.fileDetail.get(e))==null||a.remove(t.name)},setResDetailOnce(e,t){this.runDetail.putIfAbsent(e,()=>({})).once=t},setResDetailBatch(e,t,a){const r=this.runDetail.putIfAbsent(e,()=>({})),o=a?[]:r.batch||[];o.push(t),r.batch=o},cacheId(e){return this.cacheHelp.get(e,i.storeName).then(t=>{if(!t)return this.cacheHelp.add({id:e,cTime:Date.now()},i.storeName)})},delCacheId(e){return this.cacheHelp.delete("id",IDBKeyRange.only(e),i.storeName)},clearCache(){return this.cacheHelp.deleteAll(i.storeName)},getAllCacheId(){return this.cacheHelp.getAll(i.storeName)},setOtherConfigCache(e,t){return this.cacheHelp.delete("id",IDBKeyRange.only(e),s.storeName),this.cacheHelp.add({id:e,value:t},s.storeName)},getOtherConfigCache(e){return this.cacheHelp.get(e,s.storeName)}}});export{I as r};
