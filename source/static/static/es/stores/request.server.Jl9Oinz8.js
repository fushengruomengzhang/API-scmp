import{d as m}from"../pinia.C4zkjZtA.js";import{M as r}from"../resources/util/map.DsJxN4sz.js";import{C as u}from"../resources/util/cache.indexeddb.CXuVJu8M.js";import{T as D}from"../resources/util/timer.util.DJ34cZ81.js";const f="NBA-API-ADMIN",i={storeName:"nba-api-cache",storeOptions:{keyPath:"id"}},n={storeName:"nba-other-config-cache",storeOptions:{keyPath:"id"}},l={indexName:"id",keyPath:"id",indexOptions:{}},p=[{store:i,index:l},{store:n,index:l}],g=4,S=m("request.server.default",{state:()=>({isShare:!1,isSwagger:!1,domainOptions:[],selectEntityId:void 0,entityMap:new r,defaultApiDetail:{id:-1,config:{method:"POST",header:[],query:[],bodyDocument:[],formBodyDocument:[],urlBodyDocument:[]}},apiDetail:{id:-1,config:{method:"POST",header:[],query:[],bodyDocument:[],formBodyDocument:[],urlBodyDocument:[]}},refreshApiTree:e=>{},batchReqNum:5,selectParentId:void 0,apiDetailClone:void 0,apiChangeDetail:new r,fileDetail:new r,runDetail:new r,apiDocDetail:{},refreshDocTree:e=>{},cacheHelp:new u(f,p,g)}),getters:{},actions:{reset(){this.$reset()},setRunDetail(e,t){const a=this.runDetail.putIfAbsent(e,()=>({}));if(a.loading=t,!t)return a.timer.pause();a.timer||(a.timer=new D),a.timer.reset(),a.timer.start(o=>{const s=Math.floor(o/1e3),h=Math.floor(s/60).toString().padStart(2,"0"),c=Math.floor(s%60).toString().padStart(2,"0"),d=Math.floor(o%1e3).toString().padStart(3,"0");a.time=`${h}:${c}:${d} (${Math.round(o).toString().padStart(6,"0")}ms)`})},getRunDetail(e){return this.runDetail.getOrDefault(e,()=>({}))},clearApiCache(e){e?(this.runDetail.remove(e),this.fileDetail.remove(e),this.apiChangeDetail.remove(e),this.cacheHelp.delete("id",IDBKeyRange.only(e),i.storeName)):(this.runDetail.clear(),this.fileDetail.clear(),this.apiChangeDetail.clear(),this.cacheHelp.deleteAll(i.storeName))},setFileDetail(e,t){this.fileDetail.putIfAbsent(e,()=>new r).put(t.name,t)},getFileDetail(e){return this.fileDetail.getOrDefault(e,()=>new r)},removeFileDetail(e,t){var a;(a=this.fileDetail.get(e))==null||a.remove(t.name)},setResDetailOnce(e,t){this.runDetail.putIfAbsent(e,()=>({})).once=t},initResDetailBatch(e){this.runDetail.putIfAbsent(e,()=>({})).batch=Array.from({length:this.batchReqNum},(t,a)=>({}))},setResDetailBatch(e,t,a){this.runDetail.get(e).batch[a]=t},cacheId(e){return this.cacheHelp.get(e,i.storeName).then(t=>{if(!t)return this.cacheHelp.add({id:e,cTime:Date.now()},i.storeName)})},delCacheId(e){return this.cacheHelp.delete("id",IDBKeyRange.only(e),i.storeName)},clearCache(){return this.cacheHelp.deleteAll(i.storeName)},getAllCacheId(){return this.cacheHelp.getAll(i.storeName)},setOtherConfigCache(e,t){return this.cacheHelp.delete("id",IDBKeyRange.only(e),n.storeName),this.cacheHelp.add({id:e,value:t},n.storeName)},getOtherConfigCache(e){return this.cacheHelp.get(e,n.storeName)}}});export{S as r};
