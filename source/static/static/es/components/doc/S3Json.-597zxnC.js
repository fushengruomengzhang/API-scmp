import{S as v,r as _,q as j,a as p,o as r,j as g,c as b,f as k,k as S,w as h,s as w,t as V,x as P,b as E,m as K}from"../../vue.CpRb0aFL.js";import{s as x}from"../../resources/util/snowflake.util.C4QYlgiq.js";import{_ as B}from"../address/S3Address.BvGSUWFm.js";const N={name:"S3Json",components:{VueJsonPretty:v},setup(){return{}},emits:["update:modelValue"],props:{modelValue:{type:[Object,String,Array],default:null},rootPath:{type:String,default:"root"},editable:{type:Boolean,default:!1},editableTrigger:{type:String,default:"click"},deep:{type:Number,default:void 0}},data(){return{key:void 0,openEdit:{},clipboardOptions:{getElement:e=>e,options:{text:e=>JSON.stringify(this.data,null,2)},onSuccess:e=>this.$message({type:"success",showClose:!0,message:"内容已复制",center:!0})}}},computed:{data:{get(){try{return this.modelValue&&typeof this.modelValue=="string"?JSON.parse(this.modelValue):this.modelValue}catch{return this.modelValue}},set(e,i){this.$emit("update:modelValue",e)}},dataIsObj(){const e=this.data&&typeof this.data=="object";return e&&(this.key=x("json_pretty")),e}},watch:{},created(){},mounted(){},beforeUnmount(){},methods:{onKeyClick(e,i){this.openEdit[e.path]={edit:!0,value:e.key}},onKeyBlur(e,i){const{path:a,key:y}=e;this.openEdit[a].edit=!1;const s=this.openEdit[a].value,o=a.split("."),c=o.slice(0,o.length-1).join("."),d=new Function("data",`return data${c.slice(this.rootPath.length)}`)(this.data),l=d instanceof Array?[]:{};for(let t in d)t===y?l[s]=d[t]:l[t]=d[t];new Function("data","newVal",`data${c.slice(this.rootPath.length)}=newVal`)(this.data,l),Reflect.deleteProperty(this.openEdit,a)}}},O={class:"s3-json"},T={class:"copy-content-button"},C=["onUpdate:modelValue","onBlur"],I={key:1,class:"pre-text"};function J(e,i,a,y,s,o){const c=_("el-text"),d=_("vue-json-pretty"),l=j("copy");return r(),p("div",O,[g((r(),p("button",T,[k("复制")])),[[l,s.clipboardOptions]]),o.dataIsObj?(r(),b(d,K({key:s.key,class:"s3-json-content",data:o.data,"onUpdate:data":i[0]||(i[0]=t=>o.data=t),rootPath:a.rootPath,editable:a.editable,editableTrigger:a.editableTrigger,deep:a.deep},e.$attrs),S({_:2},[a.editable?{name:"renderNodeKey",fn:h(({node:t,defaultKey:u})=>{var f;return[(f=s.openEdit[t.path])!=null&&f.edit?g((r(),p("input",{key:1,class:"key-edit",ref:n=>{var m;return(m=n==null?void 0:n.focus)==null?void 0:m.call(n)},"onUpdate:modelValue":n=>s.openEdit[t.path].value=n,onBlur:n=>o.onKeyBlur(t,u)},null,40,C)),[[P,s.openEdit[t.path].value]]):(r(),b(c,{key:0,[w(a.editableTrigger)]:n=>o.onKeyClick(t,u)},{default:h(()=>[k(V(u),1)]),_:2},1040))]}),key:"0"}:void 0,e.$slots.renderNodeValue?{name:"renderNodeValue",fn:h(({node:t,defaultValue:u})=>[E(e.$slots,"renderNodeValue",{node:t,defaultValue:u},void 0,!0)]),key:"1"}:void 0]),1040,["data","rootPath","editable","editableTrigger","deep"])):(r(),p("pre",I,V(o.data||""),1))])}const F=B(N,[["render",J],["__scopeId","data-v-f3fafc0f"]]);export{F as default};
