import{J as i}from"../Java8Parser.CF2-JRMB.js";import{J as p}from"../Java8ParserListener.qTYW0woq.js";import{M as f}from"../../../util/map.DsJxN4sz.js";class T extends p{constructor(){super(),this.classDetail=new f,this.fieldDetail=new f}exitClassDeclaration(n){const t=n.children[0];if(!(t instanceof i.NormalClassDeclarationContext))return;const e={},a=[];this.deepClassAnnotation(t,e);const s=this.getText(t.Identifier());this.classDetail.put(s,{annotation:e}),this.fieldDetail.put(s,a),this.deepField(t.children,a)}deepClassAnnotation(n,t={}){n.children.forEach(e=>{if(e instanceof i.ClassModifierContext){const a=e.annotation();a&&this.deepAnnotation(a,t)}})}deepField(n=[],t=[]){n.forEach(e=>{if(e instanceof i.FieldDeclarationContext){const a={};this.deepFieldDetail(e,a),t.push(a)}else e.children&&e.children.length&&this.deepField(e.children,t)})}deepFieldDetail(n,t={}){n.children.forEach(e=>{if(e instanceof i.FieldModifierContext){const a=e.annotation();t.annotation===void 0&&(t.annotation={}),a&&this.deepAnnotation(a,t.annotation)}else e instanceof i.UnannTypeContext?t.type=this.deepFieldType(e.children):e instanceof i.VariableDeclaratorListContext&&(t.name=this.deepFieldName(e))})}deepFieldName(n){return this.getText(n.variableDeclarator()[0].variableDeclaratorId())}deepFieldType(n=[]){let t=[];return n.forEach(e=>{e instanceof i.UnannPrimitiveTypeContext?t=[this.getText(e)]:e instanceof i.UnannReferenceTypeContext&&(t=this.deepFieldReferenceType(e))}),t}deepFieldReferenceType(n){const t=n.unannClassOrInterfaceType(),e=n.unannArrayType();if(t){const a=t.unannClassType_lfno_unannClassOrInterfaceType();if(a instanceof i.UnannClassType_lfno_unannClassOrInterfaceTypeContext){const s=a.Identifier().getText(),r=a.typeArguments();if(r===null)return[s];if(r instanceof i.TypeArgumentsContext){const o=r.typeArgumentList(),l=this.deepFieldArgumentType(o);return[s,l]}}}else if(e)return["List",e.unannClassOrInterfaceType().getText()]}deepFieldArgumentType(n){if(n instanceof i.TypeArgumentListContext)return n.typeArgument().map(e=>{if(e instanceof i.TypeArgumentContext){const a=e.referenceType().classOrInterfaceType().classType_lfno_classOrInterfaceType(),s=a.Identifier().getText(),r=a.typeArguments();if(r===null)return s;const o=r.typeArgumentList(),l=this.deepFieldArgumentType(o);return[s,l]}})}deepAnnotation(n,t={}){const e=this.getText(n.children[0].typeName());n.children.forEach(a=>t[e]=this.deepAnnotationDetail(a))}deepAnnotationDetail(n){let t;return n.children.forEach(e=>{e instanceof i.ElementValuePairListContext?(t={},e.elementValuePair().forEach(a=>{const s=this.getText(a.Identifier());t[s]=this.getText(a.elementValue())})):e instanceof i.ElementValueContext&&(t=this.getText(e))}),t}getText(n){var t;return(t=n.getText())==null?void 0:t.replace(/^"|"/g,"")}}export{T as J};
