import{g as O5}from"./antlr4.BZgrZd6q.js";import{W as Dm,U as I5,aj as L5,G as $5,Z as Jw,X as F5,a3 as M5,a5 as U5,ad as z5,al as ek}from"./vue.CpRb0aFL.js";var ok={exports:{}};(function(te){(function(){var Be=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},ke=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},nt=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},st=function(e,t){return Ke(function(n,s){return e.eq(t(n),t(s))})},Ke=function(e){return{eq:e}},Qt=Ke(function(e,t){return e===t}),Tt=Qt,Ge=function(e){return Ke(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},Hs=function(e,t){return st(Ge(e),function(n){return nt(n,t)})},Uo=function(e){return Ke(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!Hs(Tt).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},Vs=Ke(function(e,t){if(e===t)return!0;var n=Be(e),s=Be(t);return n!==s?!1:ke(n)?e===t:n==="array"?Ge(Vs).eq(e,t):n==="object"?Uo(Vs).eq(e,t):!1});const _r=Object.getPrototypeOf,Qa=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},zo=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Qa(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},Ar=e=>t=>zo(t)===e,ss=e=>t=>typeof t===e,Za=e=>t=>e===t,ft=(e,t)=>Ye(e)&&Qa(e,t,(n,s)=>_r(n)===s),q=Ar("string"),Ye=Ar("object"),Ja=e=>ft(e,Object),ot=Ar("array"),hn=Za(null),Ws=ss("boolean"),Pt=Za(void 0),Je=e=>e==null,z=e=>!Je(e),Ce=ss("function"),Sn=ss("number"),Ho=(e,t)=>{if(ot(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},de=()=>{},js=(e,t)=>(...n)=>e(t.apply(null,n)),Bm=(e,t)=>n=>e(t(n)),K=e=>()=>e,Dt=e=>e,ak=(e,t)=>e===t;function G(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const ei=e=>t=>!e(t),Om=e=>()=>{throw new Error(e)},pc=e=>e(),Rr=e=>{e()},ze=K(!1),et=K(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return z(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const hc=Array.prototype.slice,ik=Array.prototype.indexOf,lk=Array.prototype.push,Im=(e,t)=>ik.call(e,t),ck=(e,t)=>{const n=Im(e,t);return n===-1?m.none():m.some(n)},Te=(e,t)=>Im(e,t)>-1,Xe=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},ve=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},B=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},Lm=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},Tr=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},oe=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},Pr=(e,t,n)=>(Lm(e,(s,o)=>{n=t(n,s,o)}),n),Wt=(e,t,n)=>(B(e,(s,o)=>{n=t(n,s,o)}),n),$m=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},rt=(e,t)=>$m(e,t,ze),Dr=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return m.some(n)}return m.none()},Fm=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!ot(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);lk.apply(t,e[n])}return t},Fn=(e,t)=>Fm(ve(e,t)),vs=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},Br=e=>{const t=hc.call(e,0);return t.reverse(),t},ti=(e,t)=>oe(e,n=>!Te(t,n)),bc=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},qs=(e,t)=>{const n=hc.call(e,0);return n.sort(t),n},ni=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),Mt=e=>ni(e,0),Ks=e=>ni(e,e.length-1),jt=Ce(Array.from)?Array.from:e=>hc.call(e),Vo=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return m.none()},uk=(e,t)=>{const n=[],s=Ce(t)?o=>Xe(n,r=>t(r,o)):o=>Te(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},qt=Object.keys,fk=Object.hasOwnProperty,Pe=(e,t)=>{const n=qt(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},si=(e,t)=>dk(e,(n,s)=>({k:s,v:t(n,s)})),dk=(e,t)=>{const n={};return Pe(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},vc=e=>(t,n)=>{e[n]=t},Mm=(e,t,n,s)=>{Pe(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},mk=(e,t)=>{const n={},s={};return Mm(e,t,vc(n),vc(s)),{t:n,f:s}},Or=(e,t)=>{const n={};return Mm(e,t,vc(n),de),n},Cc=(e,t)=>{const n=[];return Pe(e,(s,o)=>{n.push(t(s,o))}),n},yc=e=>Cc(e,Dt),Oe=(e,t)=>le(e,t)?m.from(e[t]):m.none(),le=(e,t)=>fk.call(e,t),Wo=(e,t)=>le(e,t)&&e[t]!==void 0&&e[t]!==null,gk=(e,t,n=Vs)=>Uo(n).eq(e,t),Um=e=>{const t={};return B(e,n=>{t[n]={}}),qt(t)},zm=e=>e.length!==void 0,Ec=Array.isArray,pk=e=>{if(Ec(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},oi=(e,t,n)=>{if(!e)return!1;if(n=n||e,zm(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(const s in e)if(le(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},Sc=(e,t)=>{const n=[];return oi(e,(s,o)=>{n.push(t(s,o,e))}),n},Ir=(e,t)=>{const n=[];return oi(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},hk=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},ri=(e,t,n,s)=>{let o=Pt(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},Hm=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},Gs=e=>e[e.length-1],Ys=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},bk=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,f=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,u=!c&&!l&&!f;return{isiPad:K(o),isiPhone:K(r),isTablet:K(l),isPhone:K(c),isTouch:K(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:K(f),isDesktop:K(u)}},vk=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},Ck=(e,t)=>{const n=vk(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return wc(s(1),s(2))},yk=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Vm():Ck(e,n)},Vm=()=>wc(0,0),wc=(e,t)=>({major:e,minor:t}),Lr={nu:wc,detect:yk,unknown:Vm},Ek=(e,t)=>Vo(t.brands,n=>{const s=n.brand.toLowerCase();return rt(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:Lr.nu(parseInt(n.version,10),0)}))}),Wm=(e,t)=>{const n=String(t).toLowerCase();return rt(e,s=>s.search(n))},Sk=(e,t)=>Wm(e,t).map(n=>{const s=Lr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),wk=(e,t)=>Wm(e,t).map(n=>{const s=Lr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),kk=(e,t)=>e.substring(t),jm=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,qm=(e,t)=>bt(e,t)?kk(e,t.length):e,wt=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1?Pt(s)?!0:o+t.length<=s:!1},bt=(e,t)=>jm(e,t,0),Km=(e,t)=>jm(e,t,e.length-t.length),kc=e=>t=>t.replace(e,""),jo=kc(/^\s+|\s+$/g),xk=kc(/^\s+/g),Gm=kc(/\s+$/g),Mn=e=>e.length>0,$r=e=>!Mn(e),Nk=(e,t)=>t<=0?"":new Array(t+1).join(e),ai=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},xc=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,os=e=>t=>wt(t,e),_k=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>wt(e,"edge/")&&wt(e,"chrome")&&wt(e,"safari")&&wt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xc],search:e=>wt(e,"chrome")&&!wt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>wt(e,"msie")||wt(e,"trident")},{name:"Opera",versionRegexes:[xc,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:os("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:os("firefox")},{name:"Safari",versionRegexes:[xc,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(wt(e,"safari")||wt(e,"mobile/"))&&wt(e,"applewebkit")}],Ak=[{name:"Windows",search:os("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>wt(e,"iphone")||wt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:os("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:os("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:os("linux"),versionRegexes:[]},{name:"Solaris",search:os("sunos"),versionRegexes:[]},{name:"FreeBSD",search:os("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:os("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ym={browsers:K(_k),oses:K(Ak)},Rk="Edge",Tk="Chromium",Pk="IE",Dk="Opera",Bk="Firefox",Ok="Safari",Ik=()=>Xm({current:void 0,version:Lr.unknown()}),Xm=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(Rk),isChromium:s(Tk),isIE:s(Pk),isOpera:s(Dk),isFirefox:s(Bk),isSafari:s(Ok)}},Qm={unknown:Ik,nu:Xm},Lk="Windows",$k="iOS",Fk="Android",Mk="Linux",Uk="macOS",zk="Solaris",Hk="FreeBSD",Vk="ChromeOS",Wk=()=>Zm({current:void 0,version:Lr.unknown()}),Zm=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(Lk),isiOS:s($k),isAndroid:s(Fk),isMacOS:s(Uk),isLinux:s(Mk),isSolaris:s(zk),isFreeBSD:s(Hk),isChromeOS:s(Vk)}},Jm={unknown:Wk,nu:Zm},jk={detect:(e,t,n)=>{const s=Ym.browsers(),o=Ym.oses(),r=t.bind(l=>Ek(s,l)).orThunk(()=>Sk(s,e)).fold(Qm.unknown,Qm.nu),a=wk(o,e).fold(Jm.unknown,Jm.nu),i=bk(a,r,e,n);return{browser:r,os:a,deviceType:i}}},qk=e=>window.matchMedia(e).matches;let Kk=Ys(()=>jk.detect(navigator.userAgent,m.from(navigator.userAgentData),qk));const Cs=()=>Kk(),Gk=navigator.userAgent,Nc=Cs(),Un=Nc.browser,zn=Nc.os,Xs=Nc.deviceType,Yk=Gk.indexOf("Windows Phone")!==-1,be={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:Un.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!Un.isIE(),windowsPhone:Yk,browser:{current:Un.current,version:Un.version,isChromium:Un.isChromium,isEdge:Un.isEdge,isFirefox:Un.isFirefox,isIE:Un.isIE,isOpera:Un.isOpera,isSafari:Un.isSafari},os:{current:zn.current,version:zn.version,isAndroid:zn.isAndroid,isChromeOS:zn.isChromeOS,isFreeBSD:zn.isFreeBSD,isiOS:zn.isiOS,isLinux:zn.isLinux,isMacOS:zn.isMacOS,isSolaris:zn.isSolaris,isWindows:zn.isWindows},deviceType:{isDesktop:Xs.isDesktop,isiPad:Xs.isiPad,isiPhone:Xs.isiPhone,isPhone:Xs.isPhone,isTablet:Xs.isTablet,isTouch:Xs.isTouch,isWebView:Xs.isWebView}},Xk=/^\s*|\s*$/g,eg=e=>Je(e)?"":(""+e).replace(Xk,""),Qk=(e,t)=>t?t==="array"&&Ec(e)?!0:typeof e===t:e!==void 0,Zk=(e,t,n={})=>{const s=q(e)?e.split(t||","):e||[];let o=s.length;for(;o--;)n[s[o]]={};return n},Jk=le,ex=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(le(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},tg=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),oi(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(tg(o,t,n,s),!0)))},L={trim:eg,isArray:Ec,is:Qk,toArray:pk,makeMap:Zk,each:oi,map:Sc,grep:Ir,inArray:hk,hasOwn:Jk,extend:ex,walk:tg,resolve:(e,t=window)=>{const n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>ot(e)?e:e===""?[]:Sc(e.split(t||","),eg),_addCacheSuffix:e=>{const t=be.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},qo=(e,t,n=ak)=>e.exists(s=>n(s,t)),tx=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},Bt=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),nx=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),Fr=(e,t)=>e?m.some(t):m.none(),sx=typeof window<"u"?window:Function("return this;")(),ox=(e,t)=>{let n=t??sx;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},ng=(e,t)=>{const n=e.split(".");return ox(n,t)},rx=(e,t)=>ng(e,t),ax=(e,t)=>{const n=rx(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},ix=Object.getPrototypeOf,lx=e=>ax("HTMLElement",e),cx=e=>{const t=ng("ownerDocument.defaultView",e);return Ye(e)&&(lx(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(ix(e).constructor.name))},sg=8,og=9,rg=11,Mr=1,ag=3,Ie=e=>e.dom.nodeName.toLowerCase(),ig=e=>e.dom.nodeType,ii=e=>t=>ig(t)===e,ux=e=>ig(e)===sg||Ie(e)==="#comment",fx=e=>Ut(e)&&cx(e.dom),Ut=ii(Mr),Zt=ii(ag),dx=ii(og),mx=ii(rg),_c=e=>t=>Ut(t)&&Ie(t)===e,lg=(e,t,n)=>{if(q(n)||Ws(n)||Sn(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},dt=(e,t,n)=>{lg(e.dom,t,n)},ys=(e,t)=>{const n=e.dom;Pe(t,(s,o)=>{lg(n,o,s)})},Jt=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},rs=(e,t)=>m.from(Jt(e,t)),li=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},vt=(e,t)=>{e.dom.removeAttribute(t)},gx=e=>{const t=e.dom.attributes;return t==null||t.length===0},cg=e=>Wt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Ac=(e,t)=>{const n=Jt(e,t);return n===void 0||n===""?[]:n.split(" ")},px=(e,t,n)=>{const o=Ac(e,t).concat([n]);return dt(e,t,o.join(" ")),!0},hx=(e,t,n)=>{const s=oe(Ac(e,t),o=>o!==n);return s.length>0?dt(e,t,s.join(" ")):vt(e,t),!1},Ur=e=>e.dom.classList!==void 0,ug=e=>Ac(e,"class"),fg=(e,t)=>px(e,"class",t),dg=(e,t)=>hx(e,"class",t),bx=(e,t)=>Te(ug(e),t)?dg(e,t):fg(e,t),Ko=(e,t)=>{Ur(e)?e.dom.classList.add(t):fg(e,t)},mg=e=>{(Ur(e)?e.dom.classList:ug(e)).length===0&&vt(e,"class")},zr=(e,t)=>{Ur(e)?e.dom.classList.remove(t):dg(e,t),mg(e)},vx=(e,t)=>{const n=Ur(e)?e.dom.classList.toggle(t):bx(e,t);return mg(e),n},Rc=(e,t)=>Ur(e)&&e.dom.classList.contains(t),Cx=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return Hr(s.childNodes[0])},yx=(e,t)=>{const s=(t||document).createElement(e);return Hr(s)},Ex=(e,t)=>{const s=(t||document).createTextNode(e);return Hr(s)},Hr=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},v={fromHtml:Cx,fromTag:yx,fromText:Ex,fromDom:Hr,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(Hr)},gg=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},wn=(e,t)=>{const n=e.dom;if(n.nodeType!==Mr)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},pg=e=>e.nodeType!==Mr&&e.nodeType!==og&&e.nodeType!==rg||e.childElementCount===0,Sx=(e,t)=>{const n=t===void 0?document:t.dom;return pg(n)?[]:ve(n.querySelectorAll(e),v.fromDom)},wx=(e,t)=>{const n=t===void 0?document:t.dom;return pg(n)?m.none():m.from(n.querySelector(e)).map(v.fromDom)},ye=(e,t)=>e.dom===t.dom,as=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},hg=e=>v.fromDom(e.dom.ownerDocument),is=e=>dx(e)?e:hg(e),kx=e=>v.fromDom(is(e).dom.documentElement),Vr=e=>v.fromDom(is(e).dom.defaultView),kn=e=>m.from(e.dom.parentNode).map(v.fromDom),Tc=e=>m.from(e.dom.parentElement).map(v.fromDom),bg=(e,t)=>{const n=Ce(t)?t:ze;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=v.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},xx=e=>{const t=n=>oe(n,s=>!ye(e,s));return kn(e).map(Ct).map(t).getOr([])},Qs=e=>m.from(e.dom.previousSibling).map(v.fromDom),Wr=e=>m.from(e.dom.nextSibling).map(v.fromDom),vg=e=>Br(gg(e,Qs)),Cg=e=>gg(e,Wr),Ct=e=>ve(e.dom.childNodes,v.fromDom),ci=(e,t)=>{const n=e.dom.childNodes;return m.from(n[t]).map(v.fromDom)},Pc=e=>ci(e,0),Dc=e=>ci(e,e.dom.childNodes.length-1),yg=e=>e.dom.childNodes.length,Nx=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return v.fromDom(t)},Bc=e=>mx(e)&&z(e.dom.host),Eg=Ce(Element.prototype.attachShadow)&&Ce(Node.prototype.getRootNode),_x=K(Eg),Es=Eg?e=>v.fromDom(e.dom.getRootNode()):is,Oc=e=>Bc(e)?e:Nx(is(e)),Ax=e=>Bc(e)?e:v.fromDom(is(e).dom.body),Rx=e=>{const t=Es(e);return Bc(t)?m.some(t):m.none()},Tx=e=>v.fromDom(e.dom.host),Sg=e=>{if(_x()&&z(e.target)){const t=v.fromDom(e.target);if(Ut(t)&&Px(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return Mt(n)}}return m.from(e.target)},Px=e=>z(e.dom.shadowRoot),Go=e=>{const t=Zt(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Rx(v.fromDom(t)).fold(()=>n.body.contains(t),Bm(Go,Tx))};var wg=(e,t,n,s,o)=>e(n,s)?m.some(n):Ce(o)&&o(n)?m.none():t(n,s,o);const ls=(e,t,n)=>{let s=e.dom;const o=Ce(n)?n:ze;for(;s.parentNode;){s=s.parentNode;const r=v.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},Zs=(e,t,n)=>wg((o,r)=>r(o),ls,e,t,n),Dx=(e,t)=>{const n=e.dom;return n.parentNode?Bx(v.fromDom(n.parentNode),s=>!ye(e,s)&&t(s)):m.none()},Bx=(e,t)=>{const n=o=>t(v.fromDom(o));return rt(e.dom.childNodes,n).map(v.fromDom)},Ox=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=v.fromDom(s.childNodes[o]);if(t(r))return m.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},jr=(e,t,n)=>ls(e,s=>wn(s,t),n),qr=(e,t)=>wx(t,e),Js=(e,t,n)=>wg((o,r)=>wn(o,r),jr,e,t,n),Ix=e=>Js(e,"[contenteditable]"),ui=(e,t=!1)=>Go(e)?e.dom.isContentEditable:Ix(e).fold(K(t),n=>Lx(n)==="true"),Lx=e=>e.dom.contentEditable,Kr=e=>e.style!==void 0&&Ce(e.style.getPropertyValue),kg=(e,t,n)=>{if(!q(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Kr(e)&&e.style.setProperty(t,n)},$x=(e,t)=>{Kr(e)&&e.style.removeProperty(t)},xg=(e,t,n)=>{const s=e.dom;kg(s,t,n)},fi=(e,t)=>{const n=e.dom;Pe(t,(s,o)=>{kg(n,o,s)})},Hn=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!Go(e)?Ng(n,t):o},Ng=(e,t)=>Kr(e)?e.style.getPropertyValue(t):"",di=(e,t)=>{const n=e.dom,s=Ng(n,t);return m.from(s).filter(o=>o.length>0)},_g=e=>{const t={},n=e.dom;if(Kr(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},Ag=(e,t)=>{const n=e.dom;$x(n,t),qo(rs(e,"style").map(jo),"")&&vt(e,"style")},Fx=e=>e.dom.offsetWidth,en=(e,t)=>{kn(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},Ss=(e,t)=>{Wr(e).fold(()=>{kn(e).each(o=>{at(o,t)})},s=>{en(s,t)})},Rg=(e,t)=>{Pc(e).fold(()=>{at(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},at=(e,t)=>{e.dom.appendChild(t.dom)},Tg=(e,t)=>{en(e,t),at(t,e)},Mx=(e,t)=>{B(t,(n,s)=>{const o=s===0?e:t[s-1];Ss(o,n)})},eo=(e,t)=>{B(t,n=>{at(e,n)})},Yo=e=>{e.dom.textContent="",B(Ct(e),t=>{Fe(t)})},Fe=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},cs=e=>{const t=Ct(e);t.length>0&&Mx(e,t),Fe(e)},Ux=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,Ct(v.fromDom(s))},Pg=e=>ve(e,v.fromDom),Dg=e=>e.dom.innerHTML,mi=(e,t)=>{const s=hg(e).dom,o=v.fromDom(s.createDocumentFragment()),r=Ux(t,s);eo(o,r),Yo(e),at(e,o)},zx=e=>{const t=v.fromTag("div"),n=v.fromDom(e.dom.cloneNode(!0));return at(t,n),Dg(t)},Hx=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),Vx=e=>{const t=v.fromDom(Sg(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=js(s,n);return Hx(t,e.clientX,e.clientY,n,s,o,e)},Wx=(e,t)=>n=>{e(n)&&t(Vx(n))},jx=(e,t,n,s,o)=>{const r=Wx(n,s);return e.dom.addEventListener(t,r,o),{unbind:G(Kx,e,t,r,o)}},qx=(e,t,n,s)=>jx(e,t,n,s,!1),Kx=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Bg=(e,t)=>({left:e,top:t,translate:(s,o)=>Bg(e+s,t+o)}),Xo=Bg,Gx=e=>{const t=e.getBoundingClientRect();return Xo(t.left,t.top)},gi=(e,t)=>e!==void 0?e:t!==void 0?t:0,Yx=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Xo(n.offsetLeft,n.offsetTop);const r=gi(s==null?void 0:s.pageYOffset,o.scrollTop),a=gi(s==null?void 0:s.pageXOffset,o.scrollLeft),i=gi(o.clientTop,n.clientTop),l=gi(o.clientLeft,n.clientLeft);return Ic(e).translate(a-l,r-i)},Ic=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?Xo(s.offsetLeft,s.offsetTop):Go(e)?Gx(t):Xo(0,0)},Lc=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Xo(n,s)},Og=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},Ig=(e,t)=>{Cs().browser.isSafari()&&Ce(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Xx=e=>{const t=e===void 0?window:e;return Cs().browser.isFirefox()?m.none():m.from(t.visualViewport)},Lg=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),$g=e=>{const t=e===void 0?window:e,n=t.document,s=Lc(v.fromDom(n));return Xx(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return Lg(s.left,s.top,r,a)},o=>Lg(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))},Qx=(e,t)=>oe(Ct(e),t),Fg=(e,t)=>{let n=[];return B(Ct(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(Fg(s,t))}),n},kt=(e,t)=>Sx(t,e),Mg=(e,t,n)=>jr(e,t,n).isSome();class it{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){const s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}const o=t.parentNode;if(o&&o!==this.rootNode)return o}}}const to=e=>t=>!!t&&t.nodeType===e,pi=e=>!!e&&!Object.getPrototypeOf(e),H=to(1),$c=e=>{const t=e.toLowerCase();return n=>z(n)&&n.nodeName.toLowerCase()===t},xn=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return Te(t,s)}return!1}},hi=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(H(s)){const o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){const a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},Ug=e=>t=>H(t)&&t.hasAttribute(e),Zx=(e,t)=>n=>H(n)&&n.getAttribute(e)===t,no=e=>H(e)&&e.hasAttribute("data-mce-bogus"),Jx=e=>H(e)&&e.getAttribute("data-mce-bogus")==="all",us=e=>H(e)&&e.tagName==="TABLE",zg=e=>t=>!!(H(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),Fc=xn(["textarea","input"]),P=to(3),eN=to(4),tN=to(7),ws=to(8),Gr=to(9),Mc=to(11),We=$c("br"),Hg=$c("img"),Nn=zg("true"),De=zg("false"),bi=xn(["td","th"]),nN=xn(["td","th","caption"]),Vn=xn(["video","audio","object","embed"]),sN=$c("li"),Qo="\uFEFF",mt=" ",Vg=e=>e===Qo,oN=e=>e.replace(/\uFEFF/g,""),Uc=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(Zt,"text"),vi=e=>Uc.get(e),Wg=e=>Uc.getOption(e),rN=(e,t)=>Uc.set(e,t),aN=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],iN=["td","th"],lN=["thead","tbody","tfoot"],cN=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],uN=["h1","h2","h3","h4","h5","h6"],fN=["li","dd","dt"],dN=["ul","ol","dl"],mN=["pre","script","textarea","style"],gN=["pre"].concat(uN),ks=e=>{let t;return n=>(t=t||bc(e,et),le(t,Ie(n)))},tn=ks(aN),pN=e=>Ie(e)==="table",Ci=e=>Ut(e)&&!tn(e),so=e=>Ut(e)&&Ie(e)==="br",jg=ks(cN),zc=ks(dN),Yr=ks(fN),hN=ks(lN),Xr=ks(iN),yi=ks(mN),bN=ks(gN),vN=e=>bN(e)||Ci(e),CN=e=>{const t=[];let n=e.dom;for(;n;)t.push(v.fromDom(n)),n=n.lastChild;return t},yN=e=>{const t=kt(e,"br"),n=oe(CN(e).slice(-1),so);t.length===n.length&&B(n,Fe)},Ei=()=>{const e=v.fromTag("br");return dt(e,"data-mce-bogus","1"),e},oo=e=>{Yo(e),at(e,Ei())},EN=e=>{Dc(e).each(t=>{Qs(t).each(n=>{tn(e)&&so(t)&&tn(n)&&Fe(t)})})},yt=Qo,Si=Vg,fs=oN,SN=H,Zo=P,Jo=e=>(Zo(e)&&(e=e.parentNode),SN(e)&&e.hasAttribute("data-mce-caret")),xs=e=>Zo(e)&&Si(e.data),nn=e=>Jo(e)||xs(e),qg=e=>e.firstChild!==e.lastChild||!We(e.firstChild),wN=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(yt),r=e.parentNode;if(t){const a=e.previousSibling;if(Zo(a)){if(nn(a))return a;if(ki(a))return a.splitText(a.data.length-1)}r==null||r.insertBefore(o,e)}else{const a=e.nextSibling;if(Zo(a)){if(nn(a))return a;if(wi(a))return a.splitText(1),a}e.nextSibling?r==null||r.insertBefore(o,e.nextSibling):r==null||r.appendChild(o)}return o},Hc=e=>{const t=e.container();return P(t)?t.data.charAt(e.offset())===yt||e.isAtStart()&&xs(t.previousSibling):!1},Vc=e=>{const t=e.container();return P(t)?t.data.charAt(e.offset()-1)===yt||e.isAtEnd()&&xs(t.nextSibling):!1},kN=(e,t,n)=>{var s;const r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(Ei().dom);const a=t.parentNode;return n?a==null||a.insertBefore(r,t):t.nextSibling?a==null||a.insertBefore(r,t.nextSibling):a==null||a.appendChild(r),r},wi=e=>Zo(e)&&e.data[0]===yt,ki=e=>Zo(e)&&e.data[e.data.length-1]===yt,xN=e=>{var t;const n=e.getElementsByTagName("br"),s=n[n.length-1];no(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},Wc=e=>e&&e.hasAttribute("data-mce-caret")?(xN(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,Kg=e=>Jo(e.startContainer),Gg=Nn,NN=De,_N=We,AN=P,RN=xn(["script","style","textarea"]),Yg=xn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),TN=xn(["table"]),PN=nn,bn=e=>PN(e)?!1:AN(e)?!RN(e.parentNode):Yg(e)||_N(e)||TN(e)||jc(e),DN=e=>H(e)&&e.getAttribute("unselectable")==="true",jc=e=>!DN(e)&&NN(e),BN=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(jc(n))return!1;if(Gg(n))return!0}return!0},ON=e=>jc(e)?!Wt(jt(e.getElementsByTagName("*")),(t,n)=>t||Gg(n),!1):!1,IN=e=>Yg(e)||ON(e),Xg=(e,t)=>bn(e)&&BN(e,t),LN=/^[ \t\r\n]*$/,ro=e=>LN.test(e),$N=e=>" \f	\v".indexOf(e)!==-1,Qg=e=>e===`
`||e==="\r",FN=(e,t)=>t<e.length&&t>=0?Qg(e[t]):!1,Zg=(e,t=4,n=!0,s=!0)=>{const o=Nk(" ",t),r=e.replace(/\t/g,o);return Wt(r,(i,l)=>$N(l)||l===mt?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||FN(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+mt}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Qg(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},MN=(e,t)=>{const n=v.fromDom(t),s=v.fromDom(e);return Mg(s,"pre,code",G(ye,n))},UN=(e,t)=>P(e)&&ro(e.data)&&!MN(e,t),zN=e=>H(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),xi=(e,t)=>bn(e)&&!UN(e,t)||zN(e)||HN(e),HN=Ug("data-mce-bookmark"),VN=Ug("data-mce-bogus"),WN=Zx("data-mce-bogus","all"),jN=(e,t)=>{let n=0;if(xi(e,e))return!1;{let s=e.firstChild;if(!s)return!0;const o=new it(s,e);do{if(t){if(WN(s)){s=o.next(!0);continue}if(VN(s)){s=o.next();continue}}if(We(s)){n++,s=o.next();continue}if(xi(s,e))return!1;s=o.next()}while(s);return n<=1}},Qe=(e,t=!0)=>jN(e.dom,t),Qr="data-mce-block",qN=e=>oe(qt(e),t=>!/[A-Z]/.test(t)),qc=e=>qN(e).join(","),Jg=(e,t)=>z(t.querySelector(e))?(t.setAttribute(Qr,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(Qr),!1),ep=(e,t)=>{const n=qc(e.getTransparentElements()),s=qc(e.getBlockElements());return oe(t.querySelectorAll(n),o=>Jg(s,o))},tp=(e,t)=>{var n;const s=t?"lastChild":"firstChild";for(let o=e[s];o;o=o[s])if(Qe(v.fromDom(o))){(n=o.parentNode)===null||n===void 0||n.removeChild(o);return}},KN=(e,t)=>{const n=document.createRange(),s=e.parentNode;if(s){n.setStartBefore(e),n.setEndBefore(t);const o=n.extractContents();tp(o,!0),n.setStartAfter(t),n.setEndAfter(e);const r=n.extractContents();tp(r,!1),Qe(v.fromDom(o))||s.insertBefore(o,e),Qe(v.fromDom(t))||s.insertBefore(t,e),Qe(v.fromDom(r))||s.insertBefore(r,e),s.removeChild(e)}},GN=(e,t,n)=>{const s=e.getBlockElements(),o=v.fromDom(t),r=i=>Ie(i)in s,a=i=>ye(i,o);B(Pg(n),i=>{ls(i,r,a).each(l=>{const c=Qx(i,f=>r(f)&&!e.isValidChild(Ie(l),Ie(f)));if(c.length>0){const f=Tc(l);B(c,u=>{ls(u,r,a).each(d=>{KN(d.dom,u.dom)})}),f.each(u=>ep(e,u.dom))}})})},YN=(e,t,n)=>{B([...n,...ao(e,t)?[t]:[]],s=>B(kt(v.fromDom(s),s.nodeName.toLowerCase()),o=>{ZN(e,o.dom)&&cs(o)}))},Kc=(e,t)=>{const n=ep(e,t);GN(e,t,n),YN(e,t,n)},XN=(e,t)=>{if(Yc(e,t)){const n=qc(e.getBlockElements());Jg(n,t)}},QN=(e,t,n)=>{const s=r=>ye(r,v.fromDom(t)),o=bg(v.fromDom(n),s);ni(o,o.length-2).filter(Ut).fold(()=>Kc(e,t),r=>Kc(e,r.dom))},Gc=e=>e.hasAttribute(Qr),Ni=(e,t)=>le(e.getTransparentElements(),t),Yc=(e,t)=>H(t)&&Ni(e,t.nodeName),ao=(e,t)=>Yc(e,t)&&Gc(t),ZN=(e,t)=>Yc(e,t)&&!Gc(t),JN=(e,t)=>t.type===1&&Ni(e,t.name)&&q(t.attr(Qr)),np=(e,t)=>t.type===1&&Ni(e,t.name)&&Pt(t.attr(Qr)),e_=Cs().browser,sp=e=>rt(e,Ut),t_=e=>e_.isFirefox()&&Ie(e)==="table"?sp(Ct(e)).filter(t=>Ie(t)==="caption").bind(t=>sp(Cg(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,op=(e,t)=>e.children&&Te(e.children,t),n_=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&Hn(v.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!op(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!op(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=t_(v.fromDom(t))}return{x:s,y:o}},rp=(e,t={})=>{let n=0;const s={},o=v.fromDom(e),r=is(o),a=g=>{t.referrerPolicy=g},i=g=>{t.contentCssCors=g},l=g=>{at(Oc(o),g)},c=g=>{const h=Oc(o);qr(h,"#"+g).each(Fe)},f=g=>Oe(s,g).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),u=g=>new Promise((h,y)=>{let C;const E=L._addCacheSuffix(g),S=f(E);s[E]=S,S.count++;const R=(x,U)=>{B(x,Rr),S.status=U,S.passed=[],S.failed=[],C&&(C.onload=null,C.onerror=null,C=null)},$=()=>R(S.passed,2),I=()=>R(S.failed,3);if(h&&S.passed.push(h),y&&S.failed.push(y),S.status===1)return;if(S.status===2){$();return}if(S.status===3){I();return}S.status=1;const N=v.fromTag("link",r.dom);ys(N,{rel:"stylesheet",type:"text/css",id:S.id}),t.contentCssCors&&dt(N,"crossOrigin","anonymous"),t.referrerPolicy&&dt(N,"referrerpolicy",t.referrerPolicy),C=N.dom,C.onload=$,C.onerror=I,l(N),dt(N,"href",E)}),d=g=>Promise.allSettled(ve(g,y=>u(y).then(K(y)))).then(y=>{const C=Tr(y,E=>E.status==="fulfilled");return C.fail.length>0?Promise.reject(ve(C.fail,E=>E.reason)):ve(C.pass,E=>E.value)}),p=g=>{const h=L._addCacheSuffix(g);Oe(s,h).each(y=>{--y.count===0&&(delete s[h],c(y.id))})};return{load:u,loadAll:d,unload:p,unloadAll:g=>{B(g,h=>{p(h)})},_setReferrerPolicy:a,_setContentCssCors:i}},ap=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=Es(n).dom;return m.from(e.get(r)).getOrThunk(()=>{const a=rp(r,s);return e.set(r,a),a})}}})(),s_=e=>e.nodeName.toLowerCase()==="span",ip=(e,t)=>z(e)&&(xi(e,t)||Ci(v.fromDom(e))),o_=(e,t)=>{const n=new it(e,t).prev(!1),s=new it(e,t).next(!1),o=Pt(n)||ip(n,t),r=Pt(s)||ip(s,t);return o&&r},lp=e=>s_(e)&&e.getAttribute("data-mce-type")==="bookmark",r_=(e,t)=>P(e)&&e.data.length>0&&o_(e,t),a_=e=>H(e)?e.childNodes.length>0:!1,i_=e=>Mc(e)||Gr(e),Xc=(e,t,n)=>{var s;const o=n||t;if(H(t)&&lp(t))return t;const r=t.childNodes;for(let a=r.length-1;a>=0;a--)Xc(e,r[a],o);if(H(t)){const a=t.childNodes;a.length===1&&lp(a[0])&&((s=t.parentNode)===null||s===void 0||s.insertBefore(a[0],t))}return!i_(t)&&!xi(t,o)&&!a_(t)&&!r_(t,o)&&e.remove(t),t},l_=L.makeMap,_i=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ai=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c_=/[<>&\"\']/g,u_=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,f_={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},io={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},d_={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},m_=e=>{const t=v.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},cp=(e,t)=>{const n={};if(e){const s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){const r=String.fromCharCode(parseInt(s[o],t));if(!io[r]){const a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},Qc=cp("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),up=(e,t)=>e.replace(t?_i:Ai,n=>io[n]||n),g_=e=>(""+e).replace(c_,t=>io[t]||t),fp=(e,t)=>e.replace(t?_i:Ai,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":io[n]||"&#"+n.charCodeAt(0)+";"),Zc=(e,t,n)=>{const s=n||Qc;return e.replace(t?_i:Ai,o=>io[o]||s[o]||o)},Ns={encodeRaw:up,encodeAllRaw:g_,encodeNumeric:fp,encodeNamed:Zc,getEncodeFunc:(e,t)=>{const n=cp(t)||Qc,s=(a,i)=>a.replace(i?_i:Ai,l=>io[l]!==void 0?io[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>Zc(a,i,n),r=l_(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:Zc:r.numeric?fp:up},decode:e=>e.replace(u_,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):f_[n]||String.fromCharCode(n)):d_[t]||Qc[t]||m_(t))},Ri={},Ti={},p_={},er=L.makeMap,xt=L.each,Jc=L.extend,dp=L.explode,h_=L.inArray,Et=(e,t)=>(e=L.trim(e),e?e.split(t||" "):[]),mp=(e,t={})=>{const n=er(e," ",er(e.toUpperCase()," "));return Jc(n,t)},gp=e=>mp("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),b_=e=>{const t={};let n,s,o,r;const a=(l,c="",f="")=>{const u=Et(f),d=Et(l);let p=d.length;for(;p--;){const b=Et([n,c].join(" "));t[d[p]]={attributes:bc(b,()=>({})),attributesOrder:b,children:bc(u,K(p_))}}},i=(l,c)=>{const f=Et(l),u=Et(c);let d=f.length;for(;d--;){const p=t[f[d]];for(let b=0,g=u.length;b<g;b++)p.attributes[u[b]]={},p.attributesOrder.push(u[b])}};if(Ri[e])return Ri[e];if(n="id accesskey class dir lang style tabindex title role",s="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"){const l="a ins del canvas map";n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",s+=" article aside details dialog figure main header footer hgroup section nav "+l,o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"}if(e!=="html5-strict"){n+=" xml:lang";const l="acronym applet basefont big font strike tt";o=[o,l].join(" "),xt(Et(l),f=>{a(f,"",o)});const c="center dir isindex noframes";s=[s,c].join(" "),r=[s,o].join(" "),xt(Et(c),f=>{a(f,"",r)})}return r=r||[s,o].join(" "),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",r),a("address dt dd div caption","",r),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),a("blockquote","cite",r),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",r),a("dl","","dt dd"),a("a","href target rel media hreflang type",r),a("q","cite",o),a("ins del","cite datetime",r),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",r),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[r,"param"].join(" ")),a("param","name value"),a("map","name",[r,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",r),a("th","colspan rowspan headers scope abbr",r),a("form","accept-charset action autocomplete enctype method name novalidate target",r),a("fieldset","disabled form name",[r,"legend"].join(" ")),a("label","form for",o),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?r:o),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[r,"li"].join(" ")),a("noscript","",r),e!=="html4"&&(a("wbr"),a("ruby","",[o,"rt rp"].join(" ")),a("figcaption","",r),a("mark rt rp summary bdi","",o),a("canvas","width height",r),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[r,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[r,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[o,"option"].join(" ")),a("article section nav aside main header footer","",r),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[r,"figcaption"].join(" ")),a("time","datetime",o),a("dialog","open",r),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",o),a("progress","value max",o),a("meter","value min max low high optimum",o),a("details","open",[r,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name")),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading")),e!=="html4"&&B([t.video,t.audio],l=>{delete l.children.audio,delete l.children.video}),xt(Et("a form meter progress dfn"),l=>{t[l]&&delete t[l].children[l]}),delete t.caption.children.table,delete t.script,Ri[e]=t,t},eu=(e,t)=>{if(e){const n={};return q(e)&&(e={"*":e}),xt(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?er(s,/[, ]/):dp(s,/[, ]/)}),n}else return},_s=(e={})=>{var t;const n={},s={};let o=[];const r={},a={},i=(se,pe,He)=>{const we=e[se];if(we)return er(we,/[, ]/,er(we.toUpperCase(),/[, ]/));{let Le=Ti[se];return Le||(Le=mp(pe,He),Ti[se]=Le),Le}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=b_(l);e.verify_html===!1&&(e.valid_elements="*[*]");const f=eu(e.valid_styles),u=eu(e.invalid_styles,"map"),d=eu(e.valid_classes,"map"),p=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),b=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),g=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",C=i("non_empty_elements",y+" pre",g),E=i("move_caret_before_on_enter_elements",y+" table",g),S=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),R=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",S),$=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),I=i("transparent_elements","a ins del canvas map");xt("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),se=>{a[se]=new RegExp("</"+se+"[^>]*>","gi")});const N=se=>new RegExp("^"+se.replace(/([?+*])/g,".$1")+"$"),x=se=>{const pe=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,He=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,we=/[*?+]/;if(se){const Le=Et(se,",");let Me,Re;n["@"]&&(Me=n["@"].attributes,Re=n["@"].attributesOrder);for(let Ve=0,dn=Le.length;Ve<dn;Ve++){let ht=pe.exec(Le[Ve]);if(ht){const On=ht[1],Yt=ht[2],Io=ht[3],Lo=ht[5],In={},yn=[],qe={attributes:In,attributesOrder:yn};if(On==="#"&&(qe.paddEmpty=!0),On==="-"&&(qe.removeEmpty=!0),ht[4]==="!"&&(qe.removeEmptyAttrs=!0),Me&&(Pe(Me,(mn,Ln)=>{In[Ln]=mn}),Re&&yn.push(...Re)),Lo){const mn=Et(Lo,"|");for(let Ln=0,gn=mn.length;Ln<gn;Ln++)if(ht=He.exec(mn[Ln]),ht){const pn={},ts=ht[1],St=ht[2].replace(/[\\:]:/g,":"),bs=ht[3],ns=ht[4];if(ts==="!"&&(qe.attributesRequired=qe.attributesRequired||[],qe.attributesRequired.push(St),pn.required=!0),ts==="-"){delete In[St],yn.splice(h_(yn,St),1);continue}if(bs&&(bs==="="&&(qe.attributesDefault=qe.attributesDefault||[],qe.attributesDefault.push({name:St,value:ns}),pn.defaultValue=ns),bs==="~"&&(qe.attributesForced=qe.attributesForced||[],qe.attributesForced.push({name:St,value:ns}),pn.forcedValue=ns),bs==="<"&&(pn.validValues=er(ns,"?"))),we.test(St)){const En=pn;qe.attributePatterns=qe.attributePatterns||[],En.pattern=N(St),qe.attributePatterns.push(En)}else In[St]||yn.push(St),In[St]=pn}}if(!Me&&Yt==="@"&&(Me=In,Re=yn),Io&&(qe.outputName=Yt,n[Io]=qe),we.test(Yt)){const mn=qe;mn.pattern=N(Yt),o.push(mn)}else n[Yt]=qe}}}},U=se=>{o=[],B(qt(n),pe=>{delete n[pe]}),x(se),xt(c,(pe,He)=>{s[He]=pe.children})},X=se=>{const pe=/^(~)?(.+)$/;se&&(delete Ti.text_block_elements,delete Ti.block_elements,xt(Et(se,","),He=>{const we=pe.exec(He);if(we){const Le=we[1]==="~",Me=Le?"span":"div",Re=we[2];if(s[Re]=s[Me],r[Re]=Me,C[Re.toUpperCase()]={},C[Re]={},Le||(R[Re.toUpperCase()]={},R[Re]={}),!n[Re]){let Ve=n[Me];Ve=Jc({},Ve),delete Ve.removeEmptyAttrs,delete Ve.removeEmpty,n[Re]=Ve}xt(s,(Ve,dn)=>{Ve[Me]&&(s[dn]=Ve=Jc({},s[dn]),Ve[Re]=Ve[Me])})}}))},J=se=>{const pe=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;delete Ri[l],se&&xt(Et(se,","),He=>{const we=pe.exec(He);if(we){const Le=we[1];let Me;Le?Me=s[we[2]]:Me=s[we[2]]={"#comment":{}},Me=s[we[2]],xt(Et(we[3],"|"),Re=>{Le==="-"?delete Me[Re]:Me[Re]={}})}})},re=se=>{const pe=n[se];if(pe)return pe;let He=o.length;for(;He--;){const we=o[He];if(we.pattern.test(se))return we}};e.valid_elements?U(e.valid_elements):(xt(c,(se,pe)=>{n[pe]={attributes:se.attributes,attributesOrder:se.attributesOrder},s[pe]=se.children}),xt(Et("strong/b em/i"),se=>{const pe=Et(se,"/");n[pe[1]].outputName=pe[0]}),xt($,(se,pe)=>{n[pe]&&(e.padd_empty_block_inline_children&&(n[pe].paddInEmptyBlock=!0),n[pe].removeEmpty=!0)}),xt(Et("ol ul blockquote a table tbody"),se=>{n[se]&&(n[se].removeEmpty=!0)}),xt(Et("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),se=>{n[se].paddEmpty=!0}),xt(Et("span"),se=>{n[se].removeEmptyAttrs=!0})),X(e.custom_elements),J(e.valid_children),x(e.extended_valid_elements),J("+ol[ul|ol],+ul[ul|ol]"),xt({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(se,pe)=>{n[pe]&&(n[pe].parentsRequired=Et(se))}),e.invalid_elements&&xt(dp(e.invalid_elements),se=>{n[se]&&delete n[se]}),re("span")||x("span[!data-mce-type|*]");const fe=K(f),he=K(u),Se=K(d),$e=K(h),pt=K(R),Ze=K(S),D=K($),j=K(Object.seal(g)),me=K(b),F=K(C),Z=K(E),ee=K(p),M=K(I),ue=K(Object.seal(a)),ce=(se,pe)=>{const He=s[se.toLowerCase()];return!!(He&&He[pe.toLowerCase()])},tt=(se,pe)=>{const He=re(se);if(He)if(pe){if(He.attributes[pe])return!0;const we=He.attributePatterns;if(we){let Le=we.length;for(;Le--;)if(we[Le].pattern.test(pe))return!0}}else return!0;return!1},Ae=K(r);return{type:l,children:s,elements:n,getValidStyles:fe,getValidClasses:Se,getBlockElements:pt,getInvalidStyles:he,getVoidElements:j,getTextBlockElements:Ze,getTextInlineElements:D,getBoolAttrs:$e,getElementRule:re,getSelfClosingElements:me,getNonEmptyElements:F,getMoveCaretBeforeOnEnterElements:Z,getWhitespaceElements:ee,getTransparentElements:M,getSpecialElements:ue,isValidChild:ce,isValid:tt,getCustomElements:Ae,addValidElements:x,setValidElements:U,addCustomElements:X,addValidChildren:J}},tu=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r={};let a,i;const l=Qo;t&&(a=t.getValidStyles(),i=t.getInvalidStyles());const c=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let u=0;u<c.length;u++)r[c[u]]=l+u,r[l+u]=c[u];const f={parse:u=>{const d={};let p=!1;const b=e.url_converter,g=e.url_converter_scope||f,h=(N,x,U)=>{const X=d[N+"-top"+x];if(!X)return;const J=d[N+"-right"+x];if(!J)return;const re=d[N+"-bottom"+x];if(!re)return;const fe=d[N+"-left"+x];if(!fe)return;const he=[X,J,re,fe];let Se=he.length-1;for(;Se--&&he[Se]===he[Se+1];);Se>-1&&U||(d[N+x]=Se===-1?he[0]:he.join(" "),delete d[N+"-top"+x],delete d[N+"-right"+x],delete d[N+"-bottom"+x],delete d[N+"-left"+x])},y=N=>{const x=d[N];if(!x)return;const U=x.split(" ");let X=U.length;for(;X--;)if(U[X]!==U[0])return!1;return d[N]=U[0],!0},C=(N,x,U,X)=>{y(x)&&y(U)&&y(X)&&(d[N]=d[x]+" "+d[U]+" "+d[X],delete d[x],delete d[U],delete d[X])},E=N=>(p=!0,r[N]),S=(N,x)=>(p&&(N=N.replace(/\uFEFF[0-9]/g,U=>r[U])),x||(N=N.replace(/\\([\'\";:])/g,"$1")),N),R=N=>String.fromCharCode(parseInt(N.slice(1),16)),$=N=>N.replace(/\\[0-9a-f]+/gi,R),I=(N,x,U,X,J,re)=>{if(J=J||re,J)return J=S(J),"'"+J.replace(/\'/g,"\\'")+"'";if(x=S(x||U||X||""),!e.allow_script_urls){const fe=x.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(fe)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(fe))return""}return b&&(x=b.call(g,x,"style")),"url('"+x.replace(/\'/g,"\\'")+"')"};if(u){u=u.replace(/[\u0000-\u001F]/g,""),u=u.replace(/\\[\"\';:\uFEFF]/g,E).replace(/\"[^\"]+\"|\'[^\']+\'/g,x=>x.replace(/[;:]/g,E));let N;for(;N=s.exec(u);){s.lastIndex=N.index+N[0].length;let x=N[1].replace(o,"").toLowerCase(),U=N[2].replace(o,"");if(x&&U){if(x=$(x),U=$(U),x.indexOf(l)!==-1||x.indexOf('"')!==-1||!e.allow_script_urls&&(x==="behavior"||/expression\s*\(|\/\*|\*\//.test(U)))continue;x==="font-weight"&&U==="700"?U="bold":(x==="color"||x==="background-color")&&(U=U.toLowerCase()),U=U.replace(n,I),d[x]=p?S(U,!0):U}}h("border","",!0),h("border","-width"),h("border","-color"),h("border","-style"),h("padding",""),h("margin",""),C("border","border-width","border-style","border-color"),d.border==="medium none"&&delete d.border,d["border-image"]==="none"&&delete d["border-image"]}return d},serialize:(u,d)=>{let p="";const b=(h,y)=>{const C=y[h];if(C)for(let E=0,S=C.length;E<S;E++){const R=C[E],$=u[R];$&&(p+=(p.length>0?" ":"")+R+": "+$+";")}},g=(h,y)=>{if(!i||!y)return!0;let C=i["*"];return C&&C[h]?!1:(C=i[y],!(C&&C[h]))};return d&&a?(b("*",a),b(d,a)):Pe(u,(h,y)=>{h&&g(y,d)&&(p+=(p.length>0?" ":"")+y+": "+h+";")}),p}};return f},v_={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},C_=e=>e instanceof Event||Ce(e.initEvent),y_=e=>e.isDefaultPrevented===et||e.isDefaultPrevented===ze,E_=e=>Je(e.preventDefault)||C_(e),pp=(e,t)=>{const n=t??{};for(const s in e)le(v_,s)||(n[s]=e[s]);return z(e.composedPath)&&(n.composedPath=()=>e.composedPath()),n},nu=(e,t,n,s)=>{var o;const r=pp(t,s);return r.type=e,Je(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),E_(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=et,Ce(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=et,Ce(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=et,r.stopPropagation()},y_(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?et:ze,r.isPropagationStopped=r.cancelBubble===!0?et:ze,r.isImmediatePropagationStopped=ze)),r},S_="mce-data-",w_=/^(?:mouse|contextmenu)|click/,su=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},Pi=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},k_=e=>z(e)&&w_.test(e.type),Zr=(e,t)=>{const n=nu(e.type,e,document,t);if(k_(e)&&Pt(e.pageX)&&!Pt(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},x_=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Pi(e,"DOMContentLoaded",a),Pi(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():su(e,"DOMContentLoaded",a),n.domLoaded||su(e,"load",a)};class lo{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=S_+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a;const i=window,l=d=>{r.executeHandlers(Zr(d||i.event),c)};if(!t||P(t)||ws(t))return s;let c;t[r.expando]?c=t[r.expando]:(c=r.count++,t[r.expando]=c,r.events[c]={}),o=o||t;const f=n.split(" ");let u=f.length;for(;u--;){let d=f[u],p=l,b=!1,g=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,Zr({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(b=!0,g=d==="focusin"?"focus":"blur",p=h=>{const y=Zr(h||i.event);y.type=y.type==="focus"?"focusin":"focusout",r.executeHandlers(y,c)}),a=r.events[c][d],a?d==="ready"&&r.domLoaded?s(Zr({type:d})):a.push({func:s,scope:o}):(r.events[c][d]=a=[{func:s,scope:o}],a.fakeName=g,a.capture=b,a.nativeHandler=p,d==="ready"?x_(t,p,r):su(t,g||d,p,b))}return t=a=null,s}unbind(t,n,s){if(!t||P(t)||ws(t))return this;const o=t[this.expando];if(o){let r=this.events[o];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=r[l];if(c){if(s){let f=c.length;for(;f--;)if(c[f].func===s){const u=c.nativeHandler,d=c.fakeName,p=c.capture,b=c.slice(0,f).concat(c.slice(f+1));b.nativeHandler=u,b.fakeName=d,b.capture=p,r[l]=b}}(!s||c.length===0)&&(delete r[l],Pi(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Pe(r,(a,i)=>{Pi(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(const a in r)if(le(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||P(t)||ws(t))return this;const o=Zr({type:n,target:t},s);do{const r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||P(t)||ws(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}lo.Event=new lo;const ou=L.each,N_=L.grep,ru="data-mce-style",__=L.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Jr=(e,t,n)=>{Je(n)||n===""?vt(e,t):dt(e,t,n)},hp=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),tr=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){const r=o.nodeType;t&&P(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},bp=(e,t)=>{const n=Jt(t,"style"),s=e.serialize(e.parse(n),Ie(t));Jr(t,ru,s)},A_=(e,t)=>Sn(e)?le(__,t)?e+"":e+"px":e,vp=(e,t,n)=>{const s=hp(t);Je(n)||n===""?Ag(e,s):xg(e,s,A_(n,s))},R_=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,l)=>{const c=v.fromDom(a);Ce(t.url_converter)&&z(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),l,a));const f="data-mce-"+l;Jr(c,f,i),Jr(c,l,i)},get:(a,i)=>{const l=v.fromDom(a);return Jt(l,"data-mce-"+i)||Jt(l,i)}},r={style:{set:(a,i)=>{const l=v.fromDom(a);s&&Jr(l,ru,i),vt(l,"style"),q(i)&&fi(l,e.parse(i))},get:a=>{const i=v.fromDom(a),l=Jt(i,ru)||Jt(i,"style");return e.serialize(e.parse(l),Ie(i))}}};return s&&(r.href=r.src=o),r},_e=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,l=ap.forElement(v.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],f=t.schema?t.schema:_s({}),u=tu({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new lo:lo.Event,p=f.getBlockElements(),b=w=>q(w)?le(p,w):H(w)&&(le(p,w.nodeName)||ao(f,w)),g=w=>w&&e&&q(w)?e.getElementById(w):w,h=w=>{const k=g(w);return z(k)?v.fromDom(k):null},y=(w,k,O="")=>{let T;const Q=h(w);if(z(Q)&&Ut(Q)){const ge=Nr[k];ge&&ge.get?T=ge.get(Q.dom,k):T=Jt(Q,k)}return z(T)?T:O},C=w=>{const k=g(w);return Je(k)?[]:k.attributes},E=(w,k,O)=>{j(w,T=>{if(H(T)){const Q=v.fromDom(T),ge=O===""?null:O,xe=Jt(Q,k),Ne=Nr[k];Ne&&Ne.set?Ne.set(Q.dom,ge,k):Jr(Q,k,ge),xe!==ge&&t.onSetAttrib&&t.onSetAttrib({attrElm:Q.dom,attrName:k,attrValue:ge})}})},S=(w,k)=>w.cloneNode(k),R=()=>t.root_element||e.body,$=w=>{const k=$g(w);return{x:k.x,y:k.y,w:k.width,h:k.height}},I=(w,k)=>n_(e.body,g(w),k),N=(w,k,O)=>{j(w,T=>{const Q=v.fromDom(T);vp(Q,k,O),t.update_styles&&bp(u,Q)})},x=(w,k)=>{j(w,O=>{const T=v.fromDom(O);Pe(k,(Q,ge)=>{vp(T,ge,Q)}),t.update_styles&&bp(u,T)})},U=(w,k,O)=>{const T=g(w);if(!(Je(T)||!H(T)))return O?Hn(v.fromDom(T),hp(k)):(k=k.replace(/-(\D)/g,(Q,ge)=>ge.toUpperCase()),k==="float"&&(k="cssFloat"),T.style?T.style[k]:void 0)},X=w=>{const k=g(w);if(!k)return{w:0,h:0};let O=U(k,"width"),T=U(k,"height");return(!O||O.indexOf("px")===-1)&&(O="0"),(!T||T.indexOf("px")===-1)&&(T="0"),{w:parseInt(O,10)||k.offsetWidth||k.clientWidth,h:parseInt(T,10)||k.offsetHeight||k.clientHeight}},J=w=>{const k=g(w),O=I(k),T=X(k);return{x:O.x,y:O.y,w:T.w,h:T.h}},re=(w,k)=>{if(!w)return!1;const O=ot(w)?w:[w];return Xe(O,T=>wn(v.fromDom(T),k))},fe=(w,k,O,T)=>{const Q=[];let ge=g(w);T=T===void 0;const xe=O||(R().nodeName!=="BODY"?R().parentNode:null);if(q(k))if(k==="*")k=H;else{const Ne=k;k=$o=>re($o,Ne)}for(;ge&&!(ge===xe||Je(ge.nodeType)||Gr(ge)||Mc(ge));){if(!k||k(ge))if(T)Q.push(ge);else return[ge];ge=ge.parentNode}return T?Q:null},he=(w,k,O)=>{const T=fe(w,k,O,!1);return T&&T.length>0?T[0]:null},Se=(w,k,O)=>{let T=k;if(w){q(k)&&(T=Q=>re(Q,k));for(let Q=w[O];Q;Q=Q[O])if(Ce(T)&&T(Q))return Q}return null},$e=(w,k)=>Se(w,k,"nextSibling"),pt=(w,k)=>Se(w,k,"previousSibling"),Ze=w=>Ce(w.querySelectorAll),D=(w,k)=>{var O,T;const Q=(T=(O=g(k))!==null&&O!==void 0?O:t.root_element)!==null&&T!==void 0?T:e;return Ze(Q)?jt(Q.querySelectorAll(w)):[]},j=function(w,k,O){const T=O??this;if(ot(w)){const Q=[];return ou(w,(ge,xe)=>{const Ne=g(ge);Ne&&Q.push(k.call(T,Ne,xe))}),Q}else{const Q=g(w);return Q?k.call(T,Q):!1}},me=(w,k)=>{j(w,O=>{Pe(k,(T,Q)=>{E(O,Q,T)})})},F=(w,k)=>{j(w,O=>{const T=v.fromDom(O);mi(T,k)})},Z=(w,k,O,T,Q)=>j(w,ge=>{const xe=q(k)?e.createElement(k):k;return z(O)&&me(xe,O),T&&(!q(T)&&T.nodeType?xe.appendChild(T):q(T)&&F(xe,T)),Q?xe:ge.appendChild(xe)}),ee=(w,k,O)=>Z(e.createElement(w),w,k,O,!0),M=Ns.decode,ue=Ns.encodeAllRaw,ce=(w,k,O="")=>{let T="<"+w;for(const Q in k)Wo(k,Q)&&(T+=" "+Q+'="'+ue(k[Q])+'"');return $r(O)&&le(f.getVoidElements(),w)?T+" />":T+">"+O+"</"+w+">"},tt=w=>{const k=e.createElement("div"),O=e.createDocumentFragment();O.appendChild(k),w&&(k.innerHTML=w);let T;for(;T=k.firstChild;)O.appendChild(T);return O.removeChild(k),O},Ae=(w,k)=>j(w,O=>{const T=v.fromDom(O);return k&&B(Ct(T),Q=>{Zt(Q)&&Q.dom.length===0?Fe(Q):en(T,Q)}),Fe(T),T.dom}),se=w=>j(w,k=>{const O=k.attributes;for(let T=O.length-1;T>=0;T--)k.removeAttributeNode(O.item(T))}),pe=w=>u.parse(w),He=(w,k)=>u.serialize(w,k),we=w=>{if($n!==_e.DOM&&e===document){if(n[w])return;n[w]=!0}let k=e.getElementById("mceDefaultStyles");if(!k){k=e.createElement("style"),k.id="mceDefaultStyles",k.type="text/css";const O=e.head;O.firstChild?O.insertBefore(k,O.firstChild):O.appendChild(k)}k.styleSheet?k.styleSheet.cssText+=w:k.appendChild(e.createTextNode(w))},Le=w=>{w||(w=""),B(w.split(","),k=>{o[k]=!0,l.load(k).catch(de)})},Me=(w,k,O)=>{j(w,T=>{if(H(T)){const Q=v.fromDom(T),ge=k.split(" ");B(ge,xe=>{z(O)?(O?Ko:zr)(Q,xe):vx(Q,xe)})}})},Re=(w,k)=>{Me(w,k,!0)},Ve=(w,k)=>{Me(w,k,!1)},dn=(w,k)=>{const O=h(w),T=k.split(" ");return z(O)&&vs(T,Q=>Rc(O,Q))},ht=w=>{j(w,k=>Ag(v.fromDom(k),"display"))},On=w=>{j(w,k=>xg(v.fromDom(k),"display","none"))},Yt=w=>{const k=h(w);return z(k)&&qo(di(k,"display"),"none")},Io=w=>(w||"mce_")+r++,Lo=w=>{const k=h(w);return z(k)?H(k.dom)?k.dom.outerHTML:zx(k):""},In=(w,k)=>{j(w,O=>{H(O)&&(O.outerHTML=k)})},yn=(w,k)=>{const O=g(k);return j(w,T=>{const Q=O==null?void 0:O.parentNode,ge=O==null?void 0:O.nextSibling;return Q&&(ge?Q.insertBefore(T,ge):Q.appendChild(T)),T})},qe=(w,k,O)=>j(k,T=>{var Q;const ge=ot(k)?w.cloneNode(!0):w;return O&&ou(N_(T.childNodes),xe=>{ge.appendChild(xe)}),(Q=T.parentNode)===null||Q===void 0||Q.replaceChild(ge,T),T}),mn=(w,k)=>{if(w.nodeName!==k.toUpperCase()){const O=ee(k);return ou(C(w),T=>{E(O,T.nodeName,y(w,T.nodeName))}),qe(O,w,!0),O}else return w},Ln=(w,k)=>{let O=w;for(;O;){let T=k;for(;T&&O!==T;)T=T.parentNode;if(O===T)break;O=O.parentNode}return!O&&w.ownerDocument?w.ownerDocument.documentElement:O},gn=w=>{if(H(w)){const k=w.nodeName.toLowerCase()==="a"&&!y(w,"href")&&y(w,"id");if(y(w,"name")||y(w,"data-mce-bookmark")||k)return!0}return!1},pn=(w,k)=>{let O=0;if(gn(w))return!1;const T=w.firstChild;if(T){const Q=new it(T,w),ge=f?f.getWhitespaceElements():{},xe=k||(f?f.getNonEmptyElements():null);let Ne=T;do{if(H(Ne)){const $o=Ne.getAttribute("data-mce-bogus");if($o){Ne=Q.next($o==="all");continue}const Xa=Ne.nodeName.toLowerCase();if(xe&&xe[Xa]){if(Xa==="br"){O++,Ne=Q.next();continue}return!1}if(gn(Ne))return!1}if(ws(Ne)||P(Ne)&&!ro(Ne.data)||P(Ne)&&Ne.parentNode&&ge[Ne.parentNode.nodeName]&&ro(Ne.data))return!1;Ne=Q.next()}while(Ne)}return O<=1},ts=()=>e.createRange(),St=(w,k,O)=>{let T=ts(),Q,ge;if(w&&k&&w.parentNode&&k.parentNode){const xe=w.parentNode;return T.setStart(xe,tr(w)),T.setEnd(k.parentNode,tr(k)),Q=T.extractContents(),T=ts(),T.setStart(k.parentNode,tr(k)+1),T.setEnd(xe,tr(w)+1),ge=T.extractContents(),xe.insertBefore(Xc($n,Q),w),O?xe.insertBefore(O,w):xe.insertBefore(k,w),xe.insertBefore(Xc($n,ge),w),Ae(w),O||k}else return},bs=(w,k,O,T)=>{if(ot(w)){let Q=w.length;const ge=[];for(;Q--;)ge[Q]=bs(w[Q],k,O,T);return ge}else return t.collect&&(w===e||w===s)&&c.push([w,k,O,T]),d.bind(w,k,O,T||$n)},ns=(w,k,O)=>{if(ot(w)){let T=w.length;const Q=[];for(;T--;)Q[T]=ns(w[T],k,O);return Q}else{if(c.length>0&&(w===e||w===s)){let T=c.length;for(;T--;){const[Q,ge,xe]=c[T];w===Q&&(!k||k===ge)&&(!O||O===xe)&&d.unbind(Q,ge,xe)}}return d.unbind(w,k,O)}},En=(w,k,O)=>d.dispatch(w,k,O),zs=(w,k,O)=>d.dispatch(w,k,O),Ya=w=>{if(w&&H(w)){const k=w.getAttribute("data-mce-contenteditable");return k&&k!=="inherit"?k:w.contentEditable!=="inherit"?w.contentEditable:null}else return null},$n={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:u,schema:f,events:d,isBlock:b,root:null,clone:S,getRoot:R,getViewPort:$,getRect:J,getSize:X,getParent:he,getParents:fe,get:g,getNext:$e,getPrev:pt,select:D,is:re,add:Z,create:ee,createHTML:ce,createFragment:tt,remove:Ae,setStyle:N,getStyle:U,setStyles:x,removeAllAttribs:se,setAttrib:E,setAttribs:me,getAttrib:y,getPos:I,parseStyle:pe,serializeStyle:He,addStyle:we,loadCSS:Le,addClass:Re,removeClass:Ve,hasClass:dn,toggleClass:Me,show:ht,hide:On,isHidden:Yt,uniqueId:Io,setHTML:F,getOuterHTML:Lo,setOuterHTML:In,decode:M,encode:ue,insertAfter:yn,replace:qe,rename:mn,findCommonAncestor:Ln,run:j,getAttribs:C,isEmpty:pn,createRng:ts,nodeIndex:tr,split:St,bind:bs,unbind:ns,fire:zs,dispatch:En,getContentEditable:Ya,getContentEditableParent:w=>{const k=R();let O=null;for(let T=w;T&&T!==k&&(O=Ya(T),O===null);T=T.parentNode);return O},isEditable:w=>{if(z(w)){const k=H(w)?w:w.parentElement,O=Ya(R())==="true";return z(k)&&ui(v.fromDom(k),O)}else return!1},destroy:()=>{if(c.length>0){let w=c.length;for(;w--;){const[k,O,T]=c[w];d.unbind(k,O,T)}}Pe(o,(w,k)=>{l.unload(k),delete o[k]})},isChildOf:(w,k)=>w===k||k.contains(w),dumpRng:w=>"startContainer: "+w.startContainer.nodeName+", startOffset: "+w.startOffset+", endContainer: "+w.endContainer.nodeName+", endOffset: "+w.endOffset},Nr=R_(u,t,K($n));return $n};_e.DOM=_e(document),_e.nodeIndex=tr;const T_=_e.DOM,P_=0,D_=1,Di=2,Cp=3;class ds{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=T_;let r;const a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=L._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Di}markDone(t){this.states[t]=Di}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=P_),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(l,c)=>{Oe(n.scriptLoadedCallbacks,c).each(f=>{B(f,u=>u[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{const c=oe(l,f=>f.status==="rejected");return c.length>0?Promise.reject(Fn(c,({reason:f})=>ot(f)?f:[f])):Promise.resolve()},r=l=>Promise.allSettled(ve(l,c=>n.states[c]===Di?(s("resolve",c),Promise.resolve()):n.states[c]===Cp?(s("reject",c),Promise.reject(c)):(n.states[c]=D_,n.loadScript(c).then(()=>{n.states[c]=Di,s("resolve",c);const f=n.queue;return f.length>0?(n.queue=[],r(f).then(o)):Promise.resolve()},()=>(n.states[c]=Cp,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;const f=n.queueLoadedCallbacks.shift();return m.from(f).each(Rr),o(c)})),i=Um(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>a(i).then(l,c))}):a(i)}}ds.ScriptLoader=new ds;const ct=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},B_=e=>Ye(e)&&le(e,"raw"),O_=e=>ot(e)&&e.length>1,ea={},au=ct("en"),yp=()=>Oe(ea,au.get()),_n={getData:()=>si(ea,e=>({...e})),setCode:e=>{e&&au.set(e)},getCode:()=>au.get(),add:(e,t)=>{let n=ea[e];n||(ea[e]=n={}),Pe(t,(s,o)=>{n[o.toLowerCase()]=s})},translate:e=>{const t=yp().getOr({}),n=a=>Ce(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return Oe(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(B_(e))return n(e.raw);if(O_(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>le(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>yp().bind(e=>Oe(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>le(ea,e)},Nt=()=>{const e=[],t={},n={},s=[],o=(g,h)=>{const y=oe(s,C=>C.name===g&&C.state===h);B(y,C=>C.resolve())},r=g=>le(t,g),a=g=>le(n,g),i=g=>{if(n[g])return n[g].instance},l=(g,h)=>{const y=_n.getCode(),C=","+(h||"")+",";!y||h&&C.indexOf(","+y+",")===-1||ds.ScriptLoader.add(t[g]+"/langs/"+y+".js")},c=(g,h)=>{Nt.languageLoad!==!1&&(r(g)?l(g,h):b(g,"loaded").then(()=>l(g,h)))},f=(g,h)=>(e.push(h),n[g]={instance:h},o(g,"added"),h),u=g=>{delete t[g],delete n[g]},d=(g,h)=>q(h)?q(g)?{prefix:"",resource:h,suffix:""}:{prefix:g.prefix,resource:h,suffix:g.suffix}:h,p=(g,h)=>{if(t[g])return Promise.resolve();let y=q(h)?h:h.prefix+h.resource+h.suffix;y.indexOf("/")!==0&&y.indexOf("://")===-1&&(y=Nt.baseURL+"/"+y),t[g]=y.substring(0,y.lastIndexOf("/"));const C=()=>(o(g,"loaded"),Promise.resolve());return n[g]?C():ds.ScriptLoader.add(y).then(C)},b=(g,h="added")=>h==="added"&&a(g)||h==="loaded"&&r(g)?Promise.resolve():new Promise(y=>{s.push({name:g,state:h,resolve:y})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:f,remove:u,createUrl:d,load:p,waitFor:b}};Nt.languageLoad=!0,Nt.baseURL="",Nt.PluginManager=Nt(),Nt.ThemeManager=Nt(),Nt.ModelManager=Nt();const I_=e=>{const t=ct(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},L_=e=>{const t=ct(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},As=()=>{const e=I_(de);return{...e,on:n=>e.get().each(n)}},Bi=(e,t)=>{let n=null;return{cancel:()=>{hn(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{hn(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},iu=(e,t)=>{let n=null;const s=()=>{hn(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},ta=K("mce-annotation"),co=K("data-mce-annotation"),nr=K("data-mce-annotation-uid"),na=K("data-mce-annotation-active"),sa=K("data-mce-annotation-classes"),oa=K("data-mce-annotation-attrs"),Ep=e=>t=>ye(t,e),Sp=(e,t)=>{const n=e.selection.getRng(),s=v.fromDom(n.startContainer),o=v.fromDom(e.getBody()),r=t.fold(()=>"."+ta(),l=>`[${co()}="${l}"]`),a=ci(s,n.startOffset).getOr(s);return Js(a,r,Ep(o)).bind(l=>rs(l,`${nr()}`).bind(c=>rs(l,`${co()}`).map(f=>{const u=kp(e,c);return{uid:c,name:f,elements:u}})))},$_=e=>Ut(e)&&Rc(e,ta()),wp=(e,t)=>li(e,"data-mce-bogus")||Mg(e,'[data-mce-bogus="all"]',Ep(t)),kp=(e,t)=>{const n=v.fromDom(e.getBody()),s=kt(n,`[${nr()}="${t}"]`);return oe(s,o=>!wp(o,n))},xp=(e,t)=>{const n=v.fromDom(e.getBody()),s=kt(n,`[${co()}="${t}"]`),o={};return B(s,r=>{if(!wp(r,n)){const a=Jt(r,nr()),i=Oe(o,a).getOr([]);o[a]=i.concat([r])}}),o},F_=(e,t)=>{const n=ct({}),s=()=>({listeners:[],previous:As()}),o=(u,d)=>{r(u,p=>(d(p),p))},r=(u,d)=>{const p=n.get(),b=Oe(p,u).getOrThunk(s),g=d(b);p[u]=g,n.set(p)},a=(u,d,p)=>{o(u,b=>{B(b.listeners,g=>g(!0,u,{uid:d,nodes:ve(p,h=>h.dom)}))})},i=u=>{o(u,d=>{B(d.listeners,p=>p(!1,u))})},l=(u,d)=>{B(kp(e,u),p=>{d?dt(p,na(),"true"):vt(p,na())})},c=iu(()=>{const u=qs(t.getNames());B(u,d=>{r(d,p=>{const b=p.previous.get();return Sp(e,m.some(d)).fold(()=>{b.each(g=>{i(d),p.previous.clear(),l(g,!1)})},({uid:g,name:h,elements:y})=>{qo(b,g)||(b.each(C=>l(C,!1)),a(h,g,y),p.previous.set(g),l(g,!0))}),{previous:p.previous,listeners:p.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(u,d)=>{r(u,p=>({previous:p.previous,listeners:p.listeners.concat([d])}))}}},M_=(e,t)=>{const n=co(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(nr(),null),r.attr(co(),null),r.attr(na(),null);const l=m.from(r.attr(oa())).map(d=>d.split(",")).getOr([]),c=m.from(r.attr(sa())).map(d=>d.split(",")).getOr([]);B(l,d=>r.attr(d,null));const f=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],u=ti(f,[ta()].concat(c));r.attr("class",u.length>0?u.join(" "):null),r.attr(sa(),null),r.attr(oa(),null)};e.serializer.addTempAttr(na()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},U_=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>Oe(e,o).map(r=>r.settings),getNames:()=>qt(e)}};let Np=0;const _p=e=>{const n=new Date().getTime(),s=Math.floor(Math.random()*1e9);return Np++,e+"_"+s+Np+String(n)},z_=(e,t)=>{B(t,n=>{Ko(e,n)})},H_=(e,t)=>{B(t,n=>{zr(e,n)})},Ap=(e,t)=>v.fromDom(e.dom.cloneNode(t)),uo=e=>Ap(e,!1),Rp=e=>Ap(e,!0),V_=(e,t)=>{const n=v.fromTag(t),s=cg(e);return ys(n,s),n},W_=(e,t)=>{const n=V_(e,t);Ss(e,n);const s=Ct(e);return eo(n,s),Fe(e),n},Tp=(e,t,n=ze)=>{const s=new it(e,t),o=r=>{let a;do a=s[r]();while(a&&!P(a)&&!n(a));return m.from(a).filter(P)};return{current:()=>m.from(s.current()).filter(P),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},fo=(e,t)=>{const n=t||(a=>e.isBlock(a)||We(a)||De(a)),s=(a,i,l,c)=>{if(P(a)){const f=c(a,i,a.data);if(f!==-1)return m.some({container:a,offset:f})}return l().bind(f=>s(f.container,f.offset,l,c))};return{backwards:(a,i,l,c)=>{const f=Tp(a,c??e.getRoot(),n);return s(a,i,()=>f.prev().map(u=>({container:u,offset:u.length})),l).getOrNull()},forwards:(a,i,l,c)=>{const f=Tp(a,c??e.getRoot(),n);return s(a,i,()=>f.next().map(u=>({container:u,offset:0})),l).getOrNull()}}},sr=Math.round,mo=e=>e?{left:sr(e.left),top:sr(e.top),bottom:sr(e.bottom),right:sr(e.right),width:sr(e.width),height:sr(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Pp=(e,t)=>(e=mo(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),j_=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,Dp=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,ra=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:Dp(t.top-e.bottom,e,t)},aa=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:Dp(t.bottom-e.top,e,t),q_=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,K_=e=>Wt(e,(t,n)=>t.fold(()=>m.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),Bp=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},G_=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),Y_=(e,t,n)=>Math.min(Math.max(e,t),n),Oi=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Rs=(e,t)=>{if(H(e)&&e.hasChildNodes()){const n=e.childNodes,s=Y_(t,0,n.length-1);return n[s]}else return e},X_=(e,t)=>{if(!(t<0&&H(e)&&e.hasChildNodes()))return Rs(e,t)},Q_=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Op=e=>q(e)&&e.charCodeAt(0)>=768&&Q_.test(e),Z_=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},J_=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},Ip=H,eA=bn,Lp=hi("display","block table"),tA=hi("float","left right"),ia=J_(Ip,eA,ei(tA)),nA=ei(hi("white-space","pre pre-line pre-wrap")),la=P,lu=We,$p=_e.nodeIndex,Ii=X_,cu=e=>e?e.createRange():_e.DOM.createRng(),uu=e=>q(e)&&/[\r\n\t ]/.test(e),Fp=e=>!!e.setStart&&!!e.setEnd,fu=e=>{const t=e.startContainer,n=e.startOffset;if(uu(e.toString())&&nA(t.parentNode)&&P(t)){const s=t.data;if(uu(s[n-1])||uu(s[n+1]))return!0}return!1},sA=e=>{const t=e.ownerDocument,n=cu(t),s=t.createTextNode(mt),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=mo(n.getBoundingClientRect());return o.removeChild(s),r},oA=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&P(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),Ts(r)}else return null},Mp=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,Ts=e=>{var t;let n;const s=e.getClientRects();return s.length>0?n=mo(s[0]):n=mo(e.getBoundingClientRect()),!Fp(e)&&lu(e)&&Mp(n)?sA(e):Mp(n)&&Fp(e)&&(t=oA(e))!==null&&t!==void 0?t:n},go=(e,t)=>{const n=Pp(e,t);return n.width=1,n.right=n.left+1,n},rA=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&j_(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const l=cu(a.ownerDocument);if(i<a.data.length){if(Op(a.data[i]))return;if(Op(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!fu(l))){n(go(Ts(l),!1));return}}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),fu(l)||n(go(Ts(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),fu(l)||n(go(Ts(l),!0)))},o=e.container(),r=e.offset();if(la(o))return s(o,r),t;if(Ip(o))if(e.isAtEnd()){const a=Ii(o,r);la(a)&&s(a,a.data.length),ia(a)&&!lu(a)&&n(go(Ts(a),!1))}else{const a=Ii(o,r);if(la(a)&&s(a,0),ia(a)&&e.isAtEnd())return n(go(Ts(a),!1)),t;const i=Ii(e.container(),e.offset()-1);ia(i)&&!lu(i)&&(Lp(i)||Lp(a)||!ia(a))&&n(go(Ts(i),!1)),ia(a)&&n(go(Ts(a),!0))}return t},A=(e,t,n)=>{const s=()=>(la(e),t===0),o=()=>la(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const f=cu(e.ownerDocument);return f.setStart(e,t),f.setEnd(e,t),f},a=()=>(n||(n=rA(A(e,t))),n),i=()=>a().length>0,l=f=>f&&e===f.container()&&t===f.offset(),c=f=>Ii(e,f?t-1:t);return{container:K(e),offset:K(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};A.fromRangeStart=e=>A(e.startContainer,e.startOffset),A.fromRangeEnd=e=>A(e.endContainer,e.endOffset),A.after=e=>A(e.parentNode,$p(e)+1),A.before=e=>A(e.parentNode,$p(e)),A.isAbove=(e,t)=>Bt(Mt(t.getClientRects()),Ks(e.getClientRects()),ra).getOr(!1),A.isBelow=(e,t)=>Bt(Ks(t.getClientRects()),Mt(e.getClientRects()),aa).getOr(!1),A.isAtStart=e=>e?e.isAtStart():!1,A.isAtEnd=e=>e?e.isAtEnd():!1,A.isTextPosition=e=>e?P(e.container()):!1,A.isElementPosition=e=>!A.isTextPosition(e);const Li=(e,t)=>{P(t)&&t.data.length===0&&e.remove(t)},aA=(e,t,n)=>{t.insertNode(n),Li(e,n.previousSibling),Li(e,n.nextSibling)},iA=(e,t,n)=>{const s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Li(e,r.previousSibling)),o.each(r=>Li(e,r.nextSibling))},du=(e,t,n)=>{Mc(n)?iA(e,t,n):aA(e,t,n)},An=P,Up=no,zp=_e.nodeIndex,Hp=e=>{const t=e.parentNode;return Up(t)?Hp(t):t},mu=e=>e?ri(e.childNodes,(t,n)=>(Up(n)&&n.nodeName!=="BR"?t=t.concat(mu(n)):t.push(n),t),[]):[],lA=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&An(n);)t+=n.data.length;return t},Vp=e=>t=>e===t,cA=e=>{let t,n;t=mu(Hp(e)),n=Hm(t,Vp(e),e),t=t.slice(0,n+1);const s=ri(t,(o,r,a)=>(An(r)&&An(t[a-1])&&o++,o),0);return t=Ir(t,xn([e.nodeName])),n=Hm(t,Vp(e),e),n-s},Wp=e=>(An(e)?"text()":e.nodeName.toLowerCase())+"["+cA(e)+"]",uA=(e,t,n)=>{const s=[];for(let o=t.parentNode;o&&o!==e;o=o.parentNode)s.push(o);return s},jp=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(An(s))r=lA(s,o);else{const i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(Wp(s));let a=uA(e,s);return a=Ir(a,ei(no)),n=n.concat(Sc(a,i=>Wp(i))),n.reverse().join("/")+","+r},fA=(e,t,n)=>{let s=mu(e);return s=Ir(s,(o,r)=>!An(o)||!An(s[r-1])),s=Ir(s,xn([t])),s[n]},dA=(e,t)=>{let n=e,s=0;for(;An(n);){const o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!An(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return An(e)&&t>e.data.length&&(t=e.data.length),A(e,t)},qp=(e,t)=>{if(!t)return null;const n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=ri(s,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),fA(a,l[1],parseInt(l[2],10))):null},e);if(!r)return null;if(!An(r)&&r.parentNode){let a;return o==="after"?a=zp(r)+1:a=zp(r),A(r.parentNode,a)}return dA(r,parseInt(o,10))},$i=De,mA=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&P(o);o=o.previousSibling)s+=e(o.data).length;return s},Kp=(e,t,n,s,o)=>{const r=o?s.startContainer:s.endContainer;let a=o?s.startOffset:s.endOffset;const i=[],l=e.getRoot();if(P(r))i.push(n?mA(t,r,a):a);else{let c=0;const f=r.childNodes;a>=f.length&&f.length&&(c=1,a=Math.max(0,f.length-1)),i.push(e.nodeIndex(f[a],n)+c)}for(let c=r;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},gA=(e,t,n,s)=>{const o=t.dom,r=Kp(o,e,n,s,!0),a=t.isForward(),i=Kg(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const l=Kp(o,e,n,s,!1);return{start:r,end:l,forward:a,...i}}},gu=(e,t,n)=>{let s=0;return L.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},Gp=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(H(n)&&n.nodeName==="TR"){const o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},Yp=e=>(Gp(e,!0),Gp(e,!1),e),Xp=(e,t)=>{if(H(e)&&(e=Rs(e,t),$i(e)))return e;if(nn(e)){P(e)&&Jo(e)&&(e=e.parentNode);let n=e.previousSibling;if($i(n)||(n=e.nextSibling,$i(n)))return n}},pA=e=>Xp(e.startContainer,e.startOffset)||Xp(e.endContainer,e.endOffset),Qp=(e,t,n)=>{const s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||$i(s)){const a=s.nodeName;return{name:a,index:gu(n.dom,a,s)}}const r=pA(o);if(r){const a=r.tagName;return{name:a,index:gu(n.dom,a,r)}}return gA(e,n,t,o)},hA=e=>{const t=e.getRng();return{start:jp(e.dom.getRoot(),A.fromRangeStart(t)),end:jp(e.dom.getRoot(),A.fromRangeEnd(t)),forward:e.isForward()}},bA=e=>({rng:e.getRng(),forward:e.isForward()}),Zp=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},Jp=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:gu(n,i,a)};const c=Yp(s.cloneRange());if(!r){c.collapse(!1);const u=Zp(n,o+"_end",t);du(n,c,u)}s=Yp(s),s.collapse(!0);const f=Zp(n,o+"_start",t);return du(n,s,f),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},vA=(e,t,n=!1)=>t===2?Qp(fs,n,e):t===3?hA(e):t?bA(e):Jp(e,!1),pu=G(Qp,Dt,!0),eh=e=>{const t=r=>r(e),n=K(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:et,isError:ze,map:r=>Ot.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},th=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:ze,isError:et,map:t,mapError:s=>Ot.error(s(e)),bind:t,exists:ze,forall:et,getOr:Dt,or:Dt,getOrThunk:pc,orThunk:pc,getOrDie:Om(String(e)),each:de,toOptional:m.none};return n},Ot={value:eh,error:th,fromOption:(e,t)=>e.fold(()=>th(t),eh)},Wn={generate:e=>{if(!ot(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return B(e,(s,o)=>{const r=qt(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!ot(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...u)=>{if(u.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+u.length);return u[o].apply(null,l)},match:u=>{const d=qt(u);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!vs(t,b=>Te(d,b)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return u[a].apply(null,l)},log:u=>{console.log(u,{constructors:t,constructor:a,params:l})}}}}),n}};Wn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const CA=e=>{const t=[],n=[];return B(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},yA=e=>e.type==="inline-command"||e.type==="inline-format",EA=e=>e.type==="block-command"||e.type==="block-format",SA=e=>{const t=s=>Ot.error({message:s,pattern:e}),n=(s,o,r)=>{if(e.format!==void 0){let a;if(ot(e.format)){if(!vs(e.format,q))return t(s+" pattern has non-string items in the `format` array");a=e.format}else if(q(e.format))a=[e.format];else return t(s+" pattern has non-string `format` parameter");return Ot.value(o(a))}else return e.cmd!==void 0?q(e.cmd)?Ot.value(r(e.cmd,e.value)):t(s+" pattern has non-string `cmd` parameter"):t(s+" pattern is missing both `format` and `cmd` parameters")};if(!Ye(e))return t("Raw pattern is not an object");if(!q(e.start))return t("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!q(e.end))return t("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return t("Inline pattern has empty `start` and `end` parameters");let s=e.start,o=e.end;return o.length===0&&(o=s,s=""),n("Inline",r=>({type:"inline-format",start:s,end:o,format:r}),(r,a)=>({type:"inline-command",start:s,end:o,cmd:r,value:a}))}else return e.replacement!==void 0?q(e.replacement)?e.start.length===0?t("Replacement pattern has empty `start` parameter"):Ot.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):e.start.length===0?t("Block pattern has empty `start` parameter"):n("Block",s=>({type:"block-format",start:e.start,format:s[0]}),(s,o)=>({type:"block-command",start:e.start,cmd:s,value:o}))},nh=e=>oe(e,EA),sh=e=>oe(e,yA),wA=(e,t)=>({inlinePatterns:sh(e),blockPatterns:nh(e),dynamicPatternsLookup:t}),oh=e=>{const t=CA(ve(e,SA));return B(t.errors,n=>console.error(n.message,n.pattern)),t.values},kA=e=>t=>{const n=e(t);return oh(n)},hu=Cs().deviceType,xA=hu.isTouch(),NA=_e.DOM,_A=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Wt(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[jo(r)]=jo(a),n},{})},rh=e=>ft(e,RegExp),V=e=>t=>t.options.get(e),bu=e=>q(e)||Ye(e),ah=(e,t="")=>n=>{const s=q(n);if(s)if(n.indexOf("=")!==-1){const o=_A(n);return{value:Oe(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},AA=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:ah(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:ah(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=q(n)&&Mn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=Te(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Ws(n)?{valid:!0,value:n}:q(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||q(n)||Ho(n,q);return s?q(n)?{value:ve(n.split(","),jo),valid:s}:ot(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:yu(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=q(n)||Ho(n,q);return s?{value:ot(n)?n:ve(n.split(","),jo),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=Ws(n)||q(n);return s?n===!1||hu.isiPhone()||hu.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!xA}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:n=>n===!1||q(n)||Ce(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{const s=n===!1||q(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean"}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:bu}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:bu}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:bu}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>q(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>Ho(n,Ye)||n===!1?{value:oh(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("text_patterns_lookup",{processor:n=>Ce(n)?{value:kA(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>Ho(n,rh)?{value:n,valid:!0}:rh(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!1}),t("xss_sanitization",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:_n.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:NA.getAttrib(e.getElement(),"placeholder")})})},RA=V("iframe_attrs"),TA=V("doctype"),ih=V("document_base_url"),PA=V("body_id"),DA=V("body_class"),lh=V("content_security_policy"),BA=V("br_in_pre"),Kt=V("forced_root_block"),ca=V("forced_root_block_attrs"),OA=V("newline_behavior"),IA=V("br_newline_selector"),LA=V("no_newline_selector"),$A=V("keep_styles"),FA=V("end_container_on_empty_block"),ch=V("automatic_uploads"),uh=V("images_reuse_filename"),MA=V("images_replace_blob_uris"),fh=V("icons"),UA=V("icons_url"),zA=V("images_upload_url"),HA=V("images_upload_base_path"),VA=V("images_upload_credentials"),WA=V("images_upload_handler"),jA=V("content_css_cors"),vu=V("referrer_policy"),dh=V("language"),qA=V("language_url"),mh=V("indent_use_margin"),KA=V("indentation"),GA=V("content_css"),YA=V("content_style"),gh=V("font_css"),XA=V("directionality"),QA=V("inline_boundaries_selector"),ph=V("object_resizing"),ZA=V("resize_img_proportional"),JA=V("placeholder"),hh=V("event_root"),eR=V("service_message"),or=V("theme"),tR=V("theme_url"),Cu=V("model"),nR=V("model_url"),ua=V("inline_boundaries"),sR=V("formats"),oR=V("preview_styles"),rR=V("format_empty_lines"),aR=V("format_noneditable_selector"),iR=V("custom_ui_selector"),yu=V("inline"),lR=V("hidden_input"),cR=V("submit_patch"),uR=V("add_form_submit_trigger"),fR=V("add_unload_trigger"),dR=V("custom_undo_redo_levels"),mR=V("disable_nodechange"),bh=V("readonly"),vh=V("content_css_cors"),Fi=V("plugins"),gR=V("external_plugins"),pR=V("block_unsupported_drop"),hR=V("visual"),bR=V("visual_table_class"),Ch=V("visual_anchor_class"),vR=V("iframe_aria_text"),CR=V("setup"),yR=V("init_instance_callback"),ER=V("urlconverter_callback"),SR=V("auto_focus"),wR=V("browser_spellcheck"),kR=V("protect"),xR=V("paste_block_drop"),Mi=V("paste_data_images"),NR=V("paste_preprocess"),_R=V("paste_postprocess"),AR=V("paste_webkit_styles"),RR=V("paste_remove_styles_if_webkit"),TR=V("paste_merge_formats"),PR=V("smart_paste"),DR=V("paste_as_text"),BR=V("paste_tab_spaces"),OR=V("allow_html_data_urls"),IR=V("text_patterns"),LR=V("text_patterns_lookup"),yh=V("noneditable_class"),$R=V("editable_class"),FR=V("noneditable_regexp"),MR=V("preserve_cdata"),UR=V("highlight_on_focus"),Eu=V("xss_sanitization"),zR=e=>e.options.isSet("text_patterns_lookup"),HR=e=>L.explode(e.options.get("font_size_style_values")),VR=e=>L.explode(e.options.get("font_size_classes")),WR=e=>e.options.get("encoding")==="xml",Eh=e=>L.explode(e.options.get("images_file_types")),jR=V("table_tab_navigation"),qR=H,Sh=P,wh=e=>{const t=e.parentNode;t&&t.removeChild(e)},kh=e=>{const t=fs(e);return{count:e.length-t.length,text:t}},xh=e=>{let t;for(;(t=e.data.lastIndexOf(yt))!==-1;)e.deleteData(t,1)},Nh=(e,t)=>(po(e),t),KR=(e,t)=>{const n=kh(e.data.substr(0,t.offset())),s=kh(e.data.substr(t.offset()));return(n.text+s.text).length>0?(xh(e),A(e,t.offset()-n.count)):t},GR=(e,t)=>{const n=t.container(),s=ck(jt(n.childNodes),e).map(o=>o<t.offset()?A(n,t.offset()-1):t).getOr(t);return po(e),s},YR=(e,t)=>Sh(e)&&t.container()===e?KR(e,t):Nh(e,t),XR=(e,t)=>t.container()===e.parentNode?GR(e,t):Nh(e,t),QR=(e,t)=>A.isTextPosition(t)?YR(e,t):XR(e,t),po=e=>{qR(e)&&nn(e)&&(qg(e)?e.removeAttribute("data-mce-caret"):wh(e)),Sh(e)&&(xh(e),e.data.length===0&&wh(e))},ZR=De,JR=Vn,eT=bi,tT="*[contentEditable=false],video,audio,embed,object",_h=(e,t,n)=>{const s=Pp(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},nT=e=>{var t,n;const s=kt(v.fromDom(e),tT);for(let o=0;o<s.length;o++){const r=s[o].dom;let a=r.previousSibling;if(ki(a)){const i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,wi(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},sT=(e,t,n,s)=>{const o=As();let r,a;const i=Kt(e),l=e.dom,c=(g,h)=>{let y;if(f(),eT(h))return null;if(n(h)){const C=kN(i,h,g),E=_h(t,h,g);l.setStyle(C,"top",E.top),a=C;const S=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(S,{...E}),l.add(t,S),o.set({caret:S,element:h,before:g}),g&&l.addClass(S,"mce-visual-caret-before"),u(),y=h.ownerDocument.createRange(),y.setStart(C,0),y.setEnd(C,0)}else return a=wN(h,g),y=h.ownerDocument.createRange(),fa(a.nextSibling)?(y.setStart(a,0),y.setEnd(a,0)):(y.setStart(a,1),y.setEnd(a,1)),y;return y},f=()=>{nT(t),a&&(po(a),a=null),o.on(g=>{l.remove(g.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},u=()=>{r=setInterval(()=>{o.on(g=>{s()?l.toggleClass(g.caret,"mce-visual-caret-hidden"):l.addClass(g.caret,"mce-visual-caret-hidden")})},500)};return{show:c,hide:f,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(g=>{const h=_h(t,g.element,g.before);l.setStyles(g.caret,{...h})})},destroy:()=>clearInterval(r)}},Ah=()=>be.browser.isFirefox(),fa=e=>ZR(e)||JR(e),da=e=>(fa(e)||us(e)&&Ah())&&Tc(v.fromDom(e)).exists(ui),oT=Nn,Su=De,rT=Vn,Rh=hi("display","block table table-cell table-caption list-item"),Th=nn,Ph=Jo,aT=H,iT=P,lT=bn,rr=e=>e>0,ho=e=>e<0,Ui=(e,t)=>{let n;for(;n=e(t);)if(!Ph(n))return n;return null},ma=(e,t,n,s,o)=>{const r=new it(e,s),a=Su(e)||Ph(e);let i;if(ho(t)){if(a&&(i=Ui(r.prev.bind(r),!0),n(i)))return i;for(;i=Ui(r.prev.bind(r),o);)if(n(i))return i}if(rr(t)){if(a&&(i=Ui(r.next.bind(r),!0),n(i)))return i;for(;i=Ui(r.next.bind(r),o);)if(n(i))return i}return null},cT=(e,t)=>{const n=o=>oT(o.dom),s=o=>o.dom===t;return ls(v.fromDom(e),n,s).map(o=>o.dom).getOr(t)},Ps=(e,t)=>{for(;e&&e!==t;){if(Rh(e))return e;e=e.parentNode}return null},jn=(e,t,n)=>Ps(e.container(),n)===Ps(t.container(),n),wu=(e,t)=>{if(!t)return m.none();const n=t.container(),s=t.offset();return aT(n)?m.from(n.childNodes[s+e]):m.none()},Dh=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},uT=(e,t,n)=>Ps(t,e)===Ps(n,e),Bh=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";let o=n;for(;o&&o!==t;){let r=o[s];if(r&&Th(r)&&(r=r[s]),Su(r)||rT(r)){if(uT(t,r,o))return r;break}if(lT(r))break;o=o.parentNode}return null},ga=G(Dh,!0),pa=G(Dh,!1),ku=(e,t,n)=>{let s;const o=G(Bh,!0,t),r=G(Bh,!1,t),a=n.startContainer,i=n.startOffset;if(Jo(a)){const l=iT(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(s=l.nextSibling,da(s)))return ga(s);if(c==="after"&&(s=l.previousSibling,da(s)))return pa(s)}if(!n.collapsed)return n;if(P(a)){if(Th(a)){if(e===1){if(s=r(a),s)return ga(s);if(s=o(a),s)return pa(s)}if(e===-1){if(s=o(a),s)return pa(s);if(s=r(a),s)return ga(s)}return n}if(ki(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?ga(s):n;if(wi(a)&&i<=1)return e===-1&&(s=o(a),s)?pa(s):n;if(i===a.data.length)return s=r(a),s?ga(s):n;if(i===0)return s=o(a),s?pa(s):n}return n},Oh=(e,t)=>wu(e?0:-1,t).filter(Su),ha=(e,t,n)=>{const s=ku(e,t,n);return e===-1?A.fromRangeStart(s):A.fromRangeEnd(s)},zi=e=>m.from(e.getNode()).map(v.fromDom),fT=e=>m.from(e.getNode(!0)).map(v.fromDom),xu=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},Hi=(e,t)=>{const n=jn(e,t);return!n&&We(e.getNode())?!0:n};var ut;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(ut||(ut={}));const dT=De,qn=P,Ih=H,Nu=We,ar=bn,Lh=IN,Vi=Xg,mT=(e,t)=>{const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},$h=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,Fh=(e,t)=>{if(rr(e)){if(ar(t.previousSibling)&&!qn(t.previousSibling))return A.before(t);if(qn(t))return A(t,0)}if(ho(e)){if(ar(t.nextSibling)&&!qn(t.nextSibling))return A.after(t);if(qn(t))return A(t,t.data.length)}return ho(e)?Nu(t)?A.before(t):A.after(t):A.before(t)},gT=(e,t)=>{const n=t.nextSibling;return n&&ar(n)?qn(n)?A(n,0):A.before(n):_u(ut.Forwards,A.after(t),e)},_u=(e,t,n)=>{let s,o,r,a;if(!Ih(n)||!t)return null;if(t.isEqual(A.after(n))&&n.lastChild){if(a=A.after(n.lastChild),ho(e)&&ar(n.lastChild)&&Ih(n.lastChild))return Nu(n.lastChild)?A.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(qn(i)){if(ho(e)&&l>0)return A(i,--l);if(rr(e)&&l<i.length)return A(i,++l);s=i}else{if(ho(e)&&l>0&&(o=$h(i,l-1),ar(o)))return!Lh(o)&&(r=ma(o,e,Vi,o),r)?qn(r)?A(r,r.data.length):A.after(r):qn(o)?A(o,o.data.length):A.before(o);if(rr(e)&&l<i.childNodes.length&&(o=$h(i,l),ar(o)))return Nu(o)?gT(n,o):!Lh(o)&&(r=ma(o,e,Vi,o),r)?qn(r)?A(r,0):A.before(r):qn(o)?A(o,0):A.after(o);s=o||a.getNode()}if(s&&(rr(e)&&a.isAtEnd()||ho(e)&&a.isAtStart())&&(s=ma(s,e,et,n,!0),Vi(s,n)))return Fh(e,s);o=s&&ma(s,e,Vi,n);const c=Gs(oe(mT(i,n),dT));return c&&(!o||!c.contains(o))?(rr(e)?a=A.after(c):a=A.before(c),a):o?Fh(e,o):null},Kn=e=>({next:t=>_u(ut.Forwards,t,e),prev:t=>_u(ut.Backwards,t,e)}),pT=(e,t,n)=>{const s=e?A.before(n):A.after(n);return sn(e,t,s)},hT=e=>We(e)?A.before(e):A.after(e),Mh=e=>A.isTextPosition(e)?e.offset()===0:bn(e.getNode()),Uh=e=>{if(A.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return bn(e.getNode(!0))},zh=(e,t)=>!A.isTextPosition(e)&&!A.isTextPosition(t)&&e.getNode()===t.getNode(!0),bT=e=>!A.isTextPosition(e)&&We(e.getNode()),vT=(e,t,n)=>e?!zh(t,n)&&!bT(t)&&Uh(t)&&Mh(n):!zh(n,t)&&Mh(t)&&Uh(n),sn=(e,t,n)=>{const s=Kn(t);return m.from(e?s.next(n):s.prev(n))},Wi=(e,t,n)=>sn(e,t,n).bind(s=>jn(n,s,t)&&vT(e,n,s)?sn(e,t,s):m.some(s)),Hh=(e,t,n,s)=>Wi(e,t,n).bind(o=>s(o)?Hh(e,t,o,s):m.some(o)),ir=(e,t)=>{const n=e?t.firstChild:t.lastChild;return P(n)?m.some(A(n,e?0:n.data.length)):n?bn(n)?m.some(e?A.before(n):hT(n)):pT(e,t,n):m.none()},zt=G(sn,!0),on=G(sn,!1),It=G(ir,!0),Gn=G(ir,!1),Au="_mce_caret",vn=e=>H(e)&&e.id===Au,bo=(e,t)=>{let n=t;for(;n&&n!==e;){if(vn(n))return n;n=n.parentNode}return null},CT=e=>q(e.start),yT=e=>le(e,"rng"),ET=e=>le(e,"id"),Vh=e=>le(e,"name"),Wh=e=>L.isArray(e.start),ji=e=>!Vh(e)&&Ws(e.forward)?e.forward:!0,jh=(e,t)=>(H(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),ST=(e,t)=>{const n=m.from(qp(e.getRoot(),t.start)),s=m.from(qp(e.getRoot(),t.end));return Bt(n,s,(o,r)=>{const a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:ji(t)}})},wT=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(yt);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},kT=e=>!e.hasChildNodes(),xT=(e,t)=>Gn(e).fold(ze,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),qh=(e,t,n)=>kT(t)&&bo(e,t)?(wT(t,n),!0):!1,Kh=(e,t,n,s)=>{const o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let l=o.length-1;a&&l>=1;l--){const c=a.childNodes;if(qh(r,a,s))return!0;if(o[l]>c.length-1)return qh(r,a,s)?!0:xT(a,s);a=c[o[l]]}P(a)&&(i=Math.min(o[0],a.data.length)),H(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Ru=e=>P(e)&&e.data.length>0,Gh=(e,t,n)=>{const s=e.get(n.id+"_"+t),o=s==null?void 0:s.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):Ru(s.nextSibling)?(a=s.nextSibling,i=0):Ru(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):Ru(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){const l=s.previousSibling,c=s.nextSibling;L.each(L.grep(s.childNodes),u=>{P(u)&&(u.data=u.data.replace(/\uFEFF/g,""))});let f;for(;f=e.get(n.id+"_"+t);)e.remove(f,!0);if(P(c)&&P(l)&&!be.browser.isOpera()){const u=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=u}}return m.some(A(a,i))}else return m.none()},NT=(e,t)=>{const n=e.createRng();return Kh(e,!0,t,n)&&Kh(e,!1,t,n)?m.some({range:n,forward:ji(t)}):m.none()},_T=(e,t)=>{const n=Gh(e,"start",t),s=Gh(e,"end",t);return Bt(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(jh(e,o.container()),o.offset()),a.setEnd(jh(e,r.container()),r.offset()),{range:a,forward:ji(t)}})},AT=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),RT=(e,t)=>{const n=e.dom;if(t){if(Wh(t))return NT(n,t);if(CT(t))return ST(n,t);if(ET(t))return _T(n,t);if(Vh(t))return AT(n,t);if(yT(t))return m.some({range:t.rng,forward:ji(t)})}return m.none()},TT=(e,t,n)=>vA(e,t,n),PT=(e,t)=>{RT(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},rn=e=>H(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",qi=(e=>t=>e===t)(mt),lr=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Tu=e=>!lr(e)&&!qi(e)&&!Vg(e),DT=e=>({value:BT(e)}),BT=e=>qm(e,"#").toUpperCase(),Pu=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},OT=e=>{const t=Pu(e.red)+Pu(e.green)+Pu(e.blue);return DT(t)},IT=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,LT=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Yh=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),Xh=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return Yh(o,r,a,i)},$T=e=>{if(e==="transparent")return m.some(Yh(0,0,0,0));const t=IT.exec(e);if(t!==null)return m.some(Xh(t[1],t[2],t[3],"1"));const n=LT.exec(e);return n!==null?m.some(Xh(n[1],n[2],n[3],n[4])):m.none()},Ki=e=>$T(e).map(OT).map(t=>"#"+t.value).getOr(e),Du=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},FT=e=>Fn(e,t=>{const n=Oi(t);return n?[v.fromDom(n)]:[]}),MT=e=>Du(e).length>1,UT=e=>oe(FT(e),Xr),zT=e=>kt(e,"td[data-mce-selected],th[data-mce-selected]"),Qh=(e,t)=>{const n=zT(t);return n.length>0?n:UT(e)},cr=e=>Qh(Du(e.selection.getSel()),v.fromDom(e.getBody())),ba=(e,t)=>jr(e,"table",t),HT=e=>{const t=e.startContainer,n=e.startOffset;return P(t)?n===0?m.some(v.fromDom(t)):m.none():m.from(t.childNodes[n]).map(v.fromDom)},VT=e=>{const t=e.endContainer,n=e.endOffset;return P(t)?n===t.data.length?m.some(v.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(v.fromDom)},Zh=e=>Pc(e).fold(K([e]),t=>[e].concat(Zh(t))),Bu=e=>Dc(e).fold(K([e]),t=>Ie(t)==="br"?Qs(t).map(n=>[e].concat(Bu(n))).getOr([]):[e].concat(Bu(t))),Ou=(e,t)=>Bt(HT(t),VT(t),(n,s)=>{const o=rt(Zh(e),G(ye,n)),r=rt(Bu(e),G(ye,s));return o.isSome()&&r.isSome()}).getOr(!1),Iu=(e,t,n,s)=>{const o=n,r=new it(n,o),a=Or(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Te(["td","th","table"],c.toLowerCase()));let i=n;do{if(P(i)&&L.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Gi=e=>{const t=e.selection.getSel();return z(t)&&t.rangeCount>0},Lu=(e,t)=>{const n=cr(e);n.length>0?B(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},Jh=(e,t,n)=>{const s=Jp(e,t);n(s),e.moveToBookmark(s)},Yi=e=>Sn(e==null?void 0:e.nodeType),$u=e=>H(e)&&!rn(e)&&!vn(e)&&!no(e),WT=(e,t)=>{if($u(t)&&!/^(TD|TH)$/.test(t.nodeName)){const n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},vo=e=>e.isContentEditable===!0,eb=(e,t,n)=>{const{selection:s,dom:o}=e,r=s.getNode(),a=De(r);Jh(s,!0,()=>{t()}),a&&De(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&jT(o,s)},jT=(e,t)=>{var n,s;const o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!WT(e,i)&&H(r)){const l=r.childNodes,c=e.getRoot();let f;if(a<l.length){const u=l[a];f=new it(u,(n=e.getParent(u,e.isBlock))!==null&&n!==void 0?n:c)}else{const u=l[l.length-1];f=new it(u,(s=e.getParent(u,e.isBlock))!==null&&s!==void 0?s:c),f.next(!0)}for(let u=f.current();u;u=f.next()){if(e.getContentEditable(u)==="false")return;if(P(u)&&!Mu(u)){o.setStart(u,0),t.setRng(o);return}}}},tb=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=e[s];e;e=e[s])if(H(e)||!Mu(e))return e}},Fu=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||ao(e,t),ur=(e,t,n)=>e.schema.isValidChild(t,n),Mu=(e,t=!1)=>{if(z(e)&&P(e)){const n=t?e.data.replace(/ /g," "):e.data;return ro(n)}else return!1},qT=e=>z(e)&&P(e)&&e.length===0,KT=(e,t)=>{const n="[data-mce-cef-wrappable]",s=aR(e),o=$r(s)?n:`${n},${s}`;return wn(v.fromDom(t),o)},nb=(e,t)=>{const n=e.dom;return $u(t)&&n.getContentEditable(t)==="false"&&KT(e,t)&&n.select('[contenteditable="true"]',t).length===0},Ds=(e,t)=>Ce(e)?e(t):(z(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),Uu=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),zu=(e,t)=>{if(Je(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=Ki(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Xi=(e,t,n)=>{const s=e.getStyle(t,n);return zu(s,n)},sb=(e,t)=>{let n;return e.getParent(t,s=>H(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},Qi=(e,t,n)=>e.getParents(t,n,e.getRoot()),Hu=(e,t,n)=>{const s=e.formatter.get(t);return z(s)&&Xe(s,n)},GT=(e,t)=>Hu(e,t,s=>{const o=r=>Ce(r)||r.length>1&&r.charAt(0)==="%";return Xe(["styles","attributes"],r=>Oe(s,r).exists(a=>{const i=ot(a)?a:yc(a);return Xe(i,o)}))}),YT=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>Or(r,(a,i)=>Xe(s,l=>l===i));return Hu(e,t,r=>{const a=o(r);return Hu(e,n,i=>{const l=o(i);return gk(a,l)})})},Yn=e=>Wo(e,"block"),XT=e=>Yn(e)&&e.wrapper===!0,QT=e=>Yn(e)&&e.wrapper!==!0,an=e=>Wo(e,"selector"),lt=e=>Wo(e,"inline"),ZT=e=>an(e)&&lt(e)&&qo(Oe(e,"mixed"),!0),Vu=e=>an(e)&&e.expand!==!1&&!lt(e),fr=rn,ob=Qi,rb=Mu,JT=Fu,e1=e=>We(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,ab=(e,t)=>{let n=t;for(;n;){if(H(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},ib=(e,t,n,s)=>{const o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},t1=(e,t,n)=>ib(e,t,n,s=>qi(s)||lr(s)),n1=(e,t,n)=>ib(e,t,n,Tu),lb=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(f,u,d)=>{const p=fo(e),b=o?p.backwards:p.forwards;return m.from(b(f,u,(g,h)=>fr(g.parentNode)?-1:(a=g,d(o,g,h)),i))};return l(n,s,t1).bind(f=>r?l(f.container,f.offset+(o?-1:0),n1):m.some(f)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},cb=(e,t,n,s,o)=>{const r=s[o];P(s)&&$r(s.data)&&r&&(s=r);const a=ob(e,s);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){const c=t[l];if(!(z(c.collapsed)&&c.collapsed!==n.collapsed)&&an(c)&&e.is(a[i],c.selector))return a[i]}return s},ub=(e,t,n,s)=>{var o;let r=n;const a=e.getRoot(),i=t[0];if(Yn(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){const l=(o=e.getParent(n,"LI,TD,TH"))!==null&&o!==void 0?o:a;r=e.getParent(P(n)?n.parentNode:n,c=>c!==a&&JT(e.schema,c),l)}if(r&&Yn(i)&&i.wrapper&&(r=ob(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!Uu(r,"br")););return r||n},fb=(e,t,n,s)=>{const o=n.parentNode;return z(n[s])?!1:o===t||Je(o)||e.isBlock(o)?!0:fb(e,t,o,s)},Zi=(e,t,n,s,o)=>{let r=n;const a=o?"previousSibling":"nextSibling",i=e.getRoot();if(P(n)&&!rb(n)&&(o?s>0:s<n.data.length))return n;for(;r;){if(!t[0].block_expand&&e.isBlock(r))return r;for(let l=r[a];l;l=l[a]){const c=P(l)&&!fb(e,i,l,a);if(!fr(l)&&!e1(l)&&!rb(l,c))return r}if(r===i||r.parentNode===i){n=r;break}r=r.parentNode}return n},db=e=>fr(e.parentNode)||fr(e),Co=(e,t,n,s=!1)=>{let{startContainer:o,startOffset:r,endContainer:a,endOffset:i}=t;const l=n[0];return H(o)&&o.hasChildNodes()&&(o=Rs(o,r),P(o)&&(r=0)),H(a)&&a.hasChildNodes()&&(a=Rs(a,t.collapsed?i:i-1),P(a)&&(i=a.data.length)),o=ab(e,o),a=ab(e,a),db(o)&&(o=fr(o)?o:o.parentNode,t.collapsed?o=o.previousSibling||o:o=o.nextSibling||o,P(o)&&(r=t.collapsed?o.length:0)),db(a)&&(a=fr(a)?a:a.parentNode,t.collapsed?a=a.nextSibling||a:a=a.previousSibling||a,P(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(lb(e,e.getRoot(),o,r,!0,s).each(({container:u,offset:d})=>{o=u,r=d}),lb(e,e.getRoot(),a,i,!1,s).each(({container:u,offset:d})=>{a=u,i=d})),(lt(l)||l.block_expand)&&((!lt(l)||!P(o)||r===0)&&(o=Zi(e,n,o,r,!0)),(!lt(l)||!P(a)||i===a.data.length)&&(a=Zi(e,n,a,i,!1))),Vu(l)&&(o=cb(e,n,t,o,"previousSibling"),a=cb(e,n,t,a,"nextSibling")),(Yn(l)||an(l))&&(o=ub(e,n,o,"previousSibling"),a=ub(e,n,a,"nextSibling"),Yn(l)&&(e.isBlock(o)||(o=Zi(e,n,o,r,!0)),e.isBlock(a)||(a=Zi(e,n,a,i,!1)))),H(o)&&o.parentNode&&(r=e.nodeIndex(o),o=o.parentNode),H(a)&&a.parentNode&&(i=e.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:r,endContainer:a,endOffset:i}},va=(e,t,n)=>{var s;const o=t.startOffset,r=Rs(t.startContainer,o),a=t.endOffset,i=Rs(t.endContainer,a-1),l=h=>{const y=h[0];P(y)&&y===r&&o>=y.data.length&&h.splice(0,1);const C=h[h.length-1];return a===0&&h.length>0&&C===i&&P(C)&&h.splice(h.length-1,1),h},c=(h,y,C)=>{const E=[];for(;h&&h!==C;h=h[y])E.push(h);return E},f=(h,y)=>e.getParent(h,C=>C.parentNode===y,y),u=(h,y,C)=>{const E=C?"nextSibling":"previousSibling";for(let S=h,R=S.parentNode;S&&S!==y;S=R){R=S.parentNode;const $=c(S===h?S:S[E],E);$.length&&(C||$.reverse(),n(l($)))}};if(r===i)return n(l([r]));const d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return u(r,d,!0);if(e.isChildOf(i,r))return u(i,d);const p=f(r,d)||r,b=f(i,d)||i;u(r,p,!0);const g=c(p===r?p:p.nextSibling,"nextSibling",b===i?b.nextSibling:b);g.length&&n(l(g)),u(i,b)},s1=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],o1=e=>Zt(e)&&vi(e)===yt,r1=(e,t,n,s)=>kn(t).fold(()=>"skipping",o=>s==="br"||o1(t)?"valid":$_(t)?"existing":vn(t.dom)?"caret":Xe(s1,r=>wn(t,r))?"valid-block":!ur(e,n,s)||!ur(e,Ie(o),n)?"invalid-child":"valid"),a1=(e,t)=>{const n=Co(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},mb=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;Ko(e,ta()),dt(e,`${nr()}`,a),dt(e,`${co()}`,s);const{attributes:l={},classes:c=[]}=o(a,i);if(ys(e,l),z_(e,c),r){c.length>0&&dt(e,`${sa()}`,c.join(","));const f=qt(l);f.length>0&&dt(e,`${oa()}`,f.join(","))}},i1=e=>{zr(e,ta()),vt(e,`${nr()}`),vt(e,`${co()}`),vt(e,`${na()}`);const t=rs(e,`${oa()}`).map(s=>s.split(",")).getOr([]),n=rs(e,`${sa()}`).map(s=>s.split(",")).getOr([]);B(t,s=>vt(e,s)),H_(e,n),vt(e,`${sa()}`),vt(e,`${oa()}`)},gb=(e,t,n,s,o)=>{const r=v.fromTag("span",e);return mb(r,t,n,s,o,!1),r},l1=(e,t,n,s,o,r)=>{const a=[],i=gb(e.getDoc(),n,r,s,o),l=As(),c=()=>{l.clear()},f=()=>l.get().getOrThunk(()=>{const b=uo(i);return a.push(b),l.set(b),b}),u=b=>{B(b,d)},d=b=>{switch(r1(e,b,"span",Ie(b))){case"invalid-child":{c();const h=Ct(b);u(h),c();break}case"valid-block":{c(),mb(b,n,r,s,o,!0);break}case"valid":{const h=f();Tg(b,h);break}}},p=b=>{const g=ve(b,v.fromDom);u(g)};return va(e.dom,t,b=>{c(),p(b)}),a},c1=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=cr(e).length>0,i=_p("mce-annotation");if(r.collapsed&&!a&&a1(e,r),o.getRng().collapsed&&!a){const l=gb(e.getDoc(),i,s,t,n.decorate);mi(l,mt),o.getRng().insertNode(l.dom),o.select(l.dom)}else Jh(o,!1,()=>{Lu(e,l=>{l1(e,l,i,t,n.decorate,s)})})})},pb=e=>{const t=U_();M_(e,t);const n=F_(e,t),s=_c("span"),o=r=>{B(r,a=>{s(a)?cs(a):i1(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{c1(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{Sp(e,m.some(r)).each(({elements:a})=>{const i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{const a=e.selection.getBookmark();Pe(xp(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=xp(e,r);return si(a,i=>ve(i,l=>l.dom))}}},Ca=e=>({getBookmark:G(TT,e),moveToBookmark:G(PT,e)});Ca.isBookmarkNode=rn;const hb=(e,t,n)=>n.collapsed?!1:Xe(n.getClientRects(),s=>q_(s,e,t)),u1=(e,t)=>e.dispatch("PreProcess",t),f1=(e,t)=>e.dispatch("PostProcess",t),d1=e=>{e.dispatch("remove")},m1=e=>{e.dispatch("detach")},g1=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},p1=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},h1=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},b1=e=>{e.dispatch("PreInit")},v1=e=>{e.dispatch("PostRender")},C1=e=>{e.dispatch("Init")},y1=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},bb=(e,t,n)=>{e.dispatch(t,n)},vb=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},Cb=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},E1=(e,t)=>e.dispatch("BeforeSetContent",t),yb=(e,t)=>e.dispatch("SetContent",t),S1=(e,t)=>e.dispatch("BeforeGetContent",t),Eb=(e,t)=>e.dispatch("GetContent",t),w1=(e,t)=>{e.dispatch("AutocompleterStart",t)},k1=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},x1=e=>{e.dispatch("AutocompleterEnd")},N1=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),_1=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),Sb=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),Y={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||Y.metaKeyPressed(e),metaKeyPressed:e=>be.os.isMacOS()||be.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},yo="data-mce-selected",A1="table,img,figure.image,hr,video,span.mce-preview-object",wb=Math.abs,Ji=Math.round,Wu={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},R1=e=>e.type==="longpress"||e.type.indexOf("touch")===0,kb=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,l,c,f,u,d,p,b,g,h,y,C,E,S,R,$;const I=M=>z(M)&&(Hg(M)||n.is(M,"figure.image")),N=M=>Vn(M)||n.hasClass(M,"mce-preview-object"),x=(M,ue)=>{if(R1(M)){const ce=M.touches[0];return I(M.target)&&!hb(ce.clientX,ce.clientY,ue)}else return I(M.target)&&!hb(M.clientX,M.clientY,ue)},U=M=>{const ue=M.target;x(M,t.selection.getRng())&&!M.isDefaultPrevented()&&t.selection.select(ue)},X=M=>n.hasClass(M,"mce-preview-object")&&z(M.firstElementChild)?[M,M.firstElementChild]:n.is(M,"figure.image")?[M.querySelector("img")]:[M],J=M=>{const ue=ph(t);return!ue||M.getAttribute("data-mce-resize")==="false"||M===t.getBody()?!1:n.hasClass(M,"mce-preview-object")&&z(M.firstElementChild)?wn(v.fromDom(M.firstElementChild),ue):wn(v.fromDom(M),ue)},re=M=>N(M)?n.create("img",{src:be.transparentSrc}):M.cloneNode(!0),fe=(M,ue,ce)=>{if(z(ce)){const tt=X(M);B(tt,Ae=>{Ae.style[ue]||!t.schema.isValid(Ae.nodeName.toLowerCase(),ue)?n.setStyle(Ae,ue,ce):n.setAttrib(Ae,ue,""+ce)})}},he=(M,ue,ce)=>{fe(M,"width",ue),fe(M,"height",ce)},Se=M=>{let ue,ce,tt,Ae,se;ue=M.screenX-u,ce=M.screenY-d,E=ue*c[2]+g,S=ce*c[3]+h,E=E<5?5:E,S=S<5?5:S,(I(a)||N(a))&&ZA(t)!==!1?tt=!Y.modifierPressed(M):tt=Y.modifierPressed(M),tt&&(wb(ue)>wb(ce)?(S=Ji(E*y),E=Ji(S/y)):(E=Ji(S/y),S=Ji(E*y))),he(i,E,S),Ae=c.startPos.x+ue,se=c.startPos.y+ce,Ae=Ae>0?Ae:0,se=se>0?se:0,n.setStyles(l,{left:Ae,top:se,display:"block"}),l.innerHTML=E+" &times; "+S,c[2]<0&&i.clientWidth<=E&&n.setStyle(i,"left",p+(g-E)),c[3]<0&&i.clientHeight<=S&&n.setStyle(i,"top",b+(h-S)),ue=r.scrollWidth-R,ce=r.scrollHeight-$,ue+ce!==0&&n.setStyles(l,{left:Ae-ue,top:se-ce}),C||(p1(t,a,g,h,"corner-"+c.name),C=!0)},$e=()=>{const M=C;C=!1,M&&(fe(a,"width",E),fe(a,"height",S)),n.unbind(s,"mousemove",Se),n.unbind(s,"mouseup",$e),o!==s&&(n.unbind(o,"mousemove",Se),n.unbind(o,"mouseup",$e)),n.remove(i),n.remove(l),n.remove(f),pt(a),M&&(h1(t,a,E,S,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},pt=M=>{F();const ue=n.getPos(M,r),ce=ue.x,tt=ue.y,Ae=M.getBoundingClientRect(),se=Ae.width||Ae.right-Ae.left,pe=Ae.height||Ae.bottom-Ae.top;a!==M&&(D(),a=M,E=S=0);const He=t.dispatch("ObjectSelected",{target:M});J(M)&&!He.isDefaultPrevented()?Pe(Wu,(we,Le)=>{const Me=Ve=>{const dn=X(a)[0];u=Ve.screenX,d=Ve.screenY,g=dn.clientWidth,h=dn.clientHeight,y=h/g,c=we,c.name=Le,c.startPos={x:se*we[0]+ce,y:pe*we[1]+tt},R=r.scrollWidth,$=r.scrollHeight,f=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(f,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=re(a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:ce,top:tt,margin:0}),he(i,se,pe),i.removeAttribute(yo),r.appendChild(i),n.bind(s,"mousemove",Se),n.bind(s,"mouseup",$e),o!==s&&(n.bind(o,"mousemove",Se),n.bind(o,"mouseup",$e)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+h)};let Re=n.get("mceResizeHandle"+Le);Re&&n.remove(Re),Re=n.add(r,"div",{id:"mceResizeHandle"+Le,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+Le+"-resize; margin:0; padding:0"}),n.bind(Re,"mousedown",Ve=>{Ve.stopImmediatePropagation(),Ve.preventDefault(),Me(Ve)}),we.elm=Re,n.setStyles(Re,{left:se*we[0]+ce-Re.offsetWidth/2,top:pe*we[1]+tt-Re.offsetHeight/2})}):D(!1)},Ze=Bi(pt,0),D=(M=!0)=>{Ze.cancel(),F(),a&&M&&a.removeAttribute(yo),Pe(Wu,(ue,ce)=>{const tt=n.get("mceResizeHandle"+ce);tt&&(n.unbind(tt),n.remove(tt))})},j=(M,ue)=>n.isChildOf(M,ue),me=M=>{if(C||t.removed||t.composing)return;const ue=M.type==="mousedown"?M.target:e.getNode(),ce=Js(v.fromDom(ue),A1).map(Ae=>Ae.dom).filter(Ae=>n.isEditable(Ae.parentElement)).getOrUndefined(),tt=z(ce)?n.getAttrib(ce,yo,"1"):"1";if(B(n.select(`img[${yo}],hr[${yo}]`),Ae=>{Ae.removeAttribute(yo)}),z(ce)&&j(ce,r)){Z();const Ae=e.getStart(!0);if(j(Ae,ce)&&j(e.getEnd(!0),ce)){n.setAttrib(ce,yo,tt),Ze.throttle(ce);return}}D()},F=()=>{Pe(Wu,M=>{M.elm&&(n.unbind(M.elm),delete M.elm)})},Z=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{Z(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",me),t.on("keyup compositionend",M=>{a&&a.nodeName==="TABLE"&&me(M)}),t.on("hide blur",D),t.on("contextmenu longpress",U,!0)}),t.on("remove",F),{isResizable:J,showResizeRect:pt,hideResizeRect:D,updateResizeRect:me,destroy:()=>{Ze.cancel(),a=i=f=null}}},T1=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},P1=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},xb=(e,t,n)=>{const s=e.document.createRange();return T1(s,t),P1(s,n),s},ju=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},ya=Wn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nb=(e,t,n)=>t(v.fromDom(n.startContainer),n.startOffset,v.fromDom(n.endContainer),n.endOffset),D1=(e,t)=>t.match({domRange:n=>({ltr:K(n),rtl:m.none}),relative:(n,s)=>({ltr:Ys(()=>xb(e,n,s)),rtl:Ys(()=>m.some(xb(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Ys(()=>ju(e,n,s,o,r)),rtl:Ys(()=>m.some(ju(e,o,r,n,s)))})}),B1=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>ya.rtl(v.fromDom(o.endContainer),o.endOffset,v.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>Nb(e,ya.ltr,n)):Nb(e,ya.ltr,n)},O1=(e,t)=>{const n=D1(e,t);return B1(e,n)};ya.ltr,ya.rtl;const _b={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},I1=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(s,t,n)).bind(r=>{if(r.offsetNode===null)return m.none();const a=e.dom.createRange();return a.setStart(r.offsetNode,r.offset),a.collapse(),m.some(a)})},L1=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(s,t,n))},$1=document.caretPositionFromPoint?I1:document.caretRangeFromPoint?L1:m.none,F1=(e,t,n)=>{const s=v.fromDom(e.document);return $1(s,t,n).map(o=>_b.create(v.fromDom(o.startContainer),o.startOffset,v.fromDom(o.endContainer),o.endOffset))},qu=Wn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),M1=(e,t,n,s)=>e.fold(t,n,s),U1=e=>e.fold(Dt,Dt,Dt),z1=qu.before,H1=qu.on,V1=qu.after,ms={before:z1,on:H1,after:V1,cata:M1,getStart:U1},el=Wn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),W1=e=>el.exact(e.start,e.soffset,e.finish,e.foffset),j1=e=>e.match({domRange:t=>v.fromDom(t.startContainer),relative:(t,n)=>ms.getStart(t),exact:(t,n,s,o)=>t}),q1=el.domRange,K1=el.relative,G1=el.exact,Y1=e=>{const t=j1(e);return Vr(t)},X1=_b.create,dr={domRange:q1,relative:K1,exact:G1,exactFromRange:W1,getWin:Y1,range:X1},tl=(e,t)=>{const n=Ie(e);return n==="input"?ms.after(e):Te(["br","img"],n)?t===0?ms.before(e):ms.after(e):ms.on(e,t)},Q1=(e,t)=>{const n=e.fold(ms.before,tl,ms.after),s=t.fold(ms.before,tl,ms.after);return dr.relative(n,s)},Ab=(e,t,n,s)=>{const o=tl(e,t),r=tl(n,s);return dr.relative(o,r)},Z1=e=>e.match({domRange:t=>{const n=v.fromDom(t.startContainer),s=v.fromDom(t.endContainer);return Ab(n,t.startOffset,s,t.endOffset)},relative:Q1,exact:Ab}),Ku=(e,t)=>{const s=document.createDocumentFragment();return B(e,o=>{s.appendChild(o.dom)}),v.fromDom(s)},J1=e=>{const t=dr.getWin(e).dom,n=(o,r,a,i)=>ju(t,o,r,a,i),s=Z1(e);return O1(t,s).match({ltr:n,rtl:n})},eP=(e,t,n)=>F1(e,t,n),Rb=(e,t,n)=>{const s=Vr(v.fromDom(n));return eP(s.dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},Gu=(e,t)=>z(e)&&z(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,tP=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},Tb=(e,t,n)=>tP(e,t,n)!==null,nP=(e,t,n)=>Tb(e,t,s=>s.nodeName===n),sP=(e,t)=>nn(e)&&!Tb(e,t,vn),Pb=(e,t,n)=>{const s=t.parentNode;if(s){const o=new it(t,e.getParent(s,e.isBlock)||e.getRoot());let r;for(;r=o[n?"prev":"next"]();)if(We(r))return!0}return!1},oP=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},rP=(e,t)=>{let n=t;for(;n&&n!==e;){if(De(n))return!0;n=n.parentNode}return!1},Yu=(e,t,n,s,o)=>{const r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode;let l,c;if(!i)return m.none();const f=e.getParent(i,e.isBlock)||r;if(s&&We(o)&&t&&e.isEmpty(f))return m.some(A(i,e.nodeIndex(o)));const u=new it(o,f);for(;c=u[s?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||sP(c,r))return m.none();if(P(c)&&c.data.length>0)return nP(c,r,"A")?m.none():m.some(A(c,s?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return m.none();l=c}return ws(l)?m.none():n&&l?m.some(A(l,0)):m.none()},Db=(e,t,n,s)=>{const o=e.getRoot();let r,a=!1,i=n?s.startContainer:s.endContainer,l=n?s.startOffset:s.endOffset;const c=H(i)&&l===i.childNodes.length,f=e.schema.getNonEmptyElements();let u=n;if(nn(i))return m.none();if(H(i)&&l>i.childNodes.length-1&&(u=!1),Gr(i)&&(i=o,l=0),i===o){if(u&&(r=i.childNodes[l>0?l-1:0],r&&(nn(r)||f[r.nodeName]||us(r))))return m.none();if(i.hasChildNodes()){if(l=Math.min(!u&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=P(i)&&c?i.data.length:0,!t&&i===o.lastChild&&us(i)||rP(o,i)||nn(i))return m.none();if(i.hasChildNodes()&&!us(i)){r=i;const d=new it(i,o);do{if(De(r)||nn(r)){a=!1;break}if(P(r)&&r.data.length>0){l=u?0:r.data.length,i=r,a=!0;break}if(f[r.nodeName.toLowerCase()]&&!nN(r)){l=e.nodeIndex(r),i=r.parentNode,u||l++,a=!0;break}}while(r=u?d.next():d.prev())}}}return t&&(P(i)&&l===0&&Yu(e,c,t,!0,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),H(i)&&(r=i.childNodes[l],r||(r=i.childNodes[l-1]),r&&We(r)&&!oP(r,"A")&&!Pb(e,r,!1)&&!Pb(e,r,!0)&&Yu(e,c,t,!0,r).each(d=>{i=d.container(),l=d.offset(),a=!0}))),u&&!t&&P(i)&&l===i.data.length&&Yu(e,c,t,!1,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),a&&i?m.some(A(i,l)):m.none()},nl=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=A.fromRangeStart(t);return Db(e,n,!0,s).each(r=>{(!n||!A.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||Db(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),Gu(t,s)?m.none():m.some(s)},sl=(e,t)=>e.splitText(t),ol=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&P(t)){if(n>0&&n<t.data.length)if(s=sl(t,n),t=s.previousSibling,o>n){o=o-n;const r=sl(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(P(t)&&n>0&&n<t.data.length&&(t=sl(t,n),n=0),P(s)&&o>0&&o<s.data.length){const r=sl(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},Eo=e=>({walk:(r,a)=>va(e,r,a),split:ol,expand:(r,a={type:"word"})=>{if(a.type==="word"){const i=Co(e,r,[{inline:"span"}]),l=e.createRng();return l.setStart(i.startContainer,i.startOffset),l.setEnd(i.endContainer,i.endOffset),l}return r},normalize:r=>nl(e,r).fold(ze,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});Eo.compareRanges=Gu,Eo.getCaretRangeFromPoint=Rb,Eo.getSelectedNode=Oi,Eo.getNode=Rs;const aP=((e,t)=>{const n=(i,l)=>{if(!Sn(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=i.dom;Kr(c)&&(c.style[e]=l+"px")},s=i=>{const l=t(i);if(l<=0||l===null){const c=Hn(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>Wt(l,(c,f)=>{const u=Hn(i,f),d=u===void 0?0:parseInt(u,10);return isNaN(d)?c:c+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{const f=r(i,c);return l>f?l-f:0}}})("height",e=>{const t=e.dom;return Go(e)?t.getBoundingClientRect().height:t.offsetHeight}),iP=e=>aP.get(e),Bb=()=>v.fromDom(document),Ob=(e,t)=>e.view(t).fold(K([]),s=>{const o=e.owner(s),r=Ob(e,o);return[s].concat(r)}),lP=(e,t)=>{const n=t.owner(e);return Ob(t,n)};var cP=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(v.fromDom)},owner:e=>is(e)});const uP=e=>{const t=Bb(),n=Lc(t),s=lP(e,cP),o=Ic(e),r=Pr(s,(a,i)=>{const l=Ic(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return Xo(r.left+o.left+n.left,r.top+o.top+n.top)},Xu=e=>Ie(e)==="textarea",fP=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),dP=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},mP=(e,t)=>{const n=Ct(e);if(n.length===0||Xu(e))return{element:e,offset:t};if(t<n.length&&!Xu(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return Xu(s)?{element:e,offset:t}:Ie(s)==="img"?{element:s,offset:1}:Zt(s)?{element:s,offset:vi(s).length}:{element:s,offset:Ct(s).length}}},Ib=(e,t)=>{const n=Yx(e),s=iP(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},gP=(e,t)=>{const n=mP(e,t),s=v.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+yt+"</span>");return en(n.element,s),Ib(s,()=>Fe(s))},pP=e=>Ib(v.fromDom(e),de),Lb=(e,t,n,s)=>{bP(e,(o,r)=>hP(e,t,n,s),n)},$b=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(fP(e,r))return;const a=Lc(t).top;n(t,a,s,o),dP(e,r)},hP=(e,t,n,s)=>{const o=v.fromDom(e.getBody()),r=v.fromDom(e.getDoc());Fx(o);const a=gP(v.fromDom(n.startContainer),n.startOffset);$b(e,r,t,a,s),a.cleanup()},Fb=(e,t,n,s)=>{const o=v.fromDom(e.getDoc());$b(e,o,n,pP(t),s)},bP=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(v.fromDom(s),v.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},Qu=(e,t,n,s)=>{const o=e.pos;if(n)Og(o.left,o.top,s);else{const r=o.top-t+e.height;Og(o.left,r,s)}},Mb=(e,t,n,s,o)=>{const r=n+t,a=s.pos.top,i=s.bottom,l=i-a>=n;a<t?Qu(s,n,o!==!1,e):a>r?Qu(s,n,l?o!==!1:o===!0,e):i>r&&!l&&Qu(s,n,o===!0,e)},Ub=(e,t,n,s)=>{const o=Vr(e).dom.innerHeight;Mb(e,t,o,n,s)},zb=(e,t,n,s)=>{const o=Vr(e).dom.innerHeight;Mb(e,t,o,n,s);const r=uP(n.element),a=$g(window);r.top<a.y?Ig(n.element,s!==!1):r.top>a.bottom&&Ig(n.element,s===!0)},vP=(e,t,n)=>Lb(e,Ub,t,n),CP=(e,t,n)=>Fb(e,t,Ub,n),yP=(e,t,n)=>Lb(e,zb,t,n),EP=(e,t,n)=>Fb(e,t,zb,n),SP=(e,t,n)=>{(e.inline?CP:EP)(e,t,n)},Ea=(e,t,n)=>{(e.inline?vP:yP)(e,t,n)},Hb=e=>e.dom.focus(),Vb=e=>{const t=Es(e).dom;return e.dom===t.activeElement},Zu=(e=Bb())=>m.from(e.dom.activeElement).map(v.fromDom),wP=e=>Zu(Es(e)).filter(t=>e.dom.contains(t.dom)),Wb=(e,t)=>{const n=Zt(t)?vi(t).length:Ct(t).length+1;return e>n?n:e<0?0:e},kP=e=>dr.range(e.start,Wb(e.soffset,e.start),e.finish,Wb(e.foffset,e.finish)),jb=(e,t)=>!pi(t.dom)&&(as(e,t)||ye(e,t)),qb=e=>t=>jb(e,t.start)&&jb(e,t.finish),xP=e=>e.inline||be.browser.isFirefox(),NP=e=>dr.range(v.fromDom(e.startContainer),e.startOffset,v.fromDom(e.endContainer),e.endOffset),_P=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(NP)},AP=e=>{const t=Vr(e);return _P(t.dom).filter(qb(e))},RP=(e,t)=>m.from(t).filter(qb(e)).map(kP),TP=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},Ju=e=>{const t=xP(e)?AP(v.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},ef=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>RP(v.fromDom(e.getBody()),n)).bind(TP),PP=e=>{ef(e).each(t=>e.selection.setRng(t))},Kb={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},DP=(e,t)=>(Sn(t)||(t=0),setTimeout(e,t)),BP=(e,t)=>(Sn(t)||(t=0),setInterval(e,t)),ln={setEditorTimeout:(e,t,n)=>DP(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=BP(()=>{e.removed?clearInterval(s):t()},n);return s}},OP=e=>e.type==="nodechange"&&e.selectionChange,IP=(e,t)=>{const n=()=>{t.throttle()};_e.DOM.bind(document,"mouseup",n),e.on("remove",()=>{_e.DOM.unbind(document,"mouseup",n)})},LP=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},$P=(e,t)=>{LP(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{OP(n)||Ju(e)})},FP=e=>{const t=Bi(()=>{Ju(e)},0);e.on("init",()=>{e.inline&&IP(e,t),$P(e,t)}),e.on("remove",()=>{t.cancel()})};let mr;const tf=_e.DOM,MP=e=>H(e)&&Kb.isEditorUIElement(e),nf=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},rl=(e,t)=>{const n=iR(e);return tf.getParent(t,o=>MP(o)||(n?e.dom.is(o,n):!1))!==null},sf=e=>{try{const t=Es(v.fromDom(e.getElement()));return Zu(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},UP=(e,t)=>{const n=t.editor;FP(n);const s=(o,r)=>{if(UR(o)&&o.inline!==!0){const a=v.fromDom(o.getContainer());r(a,"tox-edit-focus")}};n.on("focusin",()=>{const o=e.focusedEditor;nf(sf(n))&&s(n,Ko),o!==n&&(o&&o.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:o}),n.focus(!0))}),n.on("focusout",()=>{ln.setEditorTimeout(n,()=>{const o=e.focusedEditor;(!nf(sf(n))||o!==n)&&s(n,zr),!rl(n,sf(n))&&o===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),mr||(mr=o=>{const r=e.activeEditor;r&&Sg(o).each(a=>{const i=a;i.ownerDocument===document&&i!==document.body&&!rl(r,i)&&e.focusedEditor===r&&(r.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},tf.bind(document,"focusin",mr))},zP=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&mr&&(tf.unbind(document,"focusin",mr),mr=null)},HP=e=>{e.on("AddEditor",G(UP,e)),e.on("RemoveEditor",G(zP,e))},VP=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),WP=e=>e.collapsed?m.from(Rs(e.startContainer,e.startOffset)).map(v.fromDom):m.none(),jP=(e,t)=>WP(t).bind(n=>hN(n)?m.some(n):as(e,n)?m.none():m.some(e)),Gb=(e,t)=>{jP(v.fromDom(e.getBody()),t).bind(n=>It(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},of=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},qP=e=>Vb(e)||wP(e).isSome(),KP=e=>z(e.iframeElement)&&Vb(v.fromDom(e.iframeElement)),GP=e=>{const t=e.getBody();return t&&qP(v.fromDom(t))},YP=e=>{const t=Es(v.fromDom(e.getElement()));return Zu(t).filter(n=>!nf(n.dom)&&rl(e,n.dom)).isSome()},So=e=>e.inline?GP(e):KP(e),XP=e=>So(e)||YP(e),QP=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable(),z(e.bookmark)&&!So(e)&&ef(e).each(r=>{e.selection.setRng(r),s=r});const o=VP(e,t.getNode());if(o&&e.dom.isChildOf(o,n)){of(o),Gb(e,s),rf(e);return}e.inline||(be.browser.isOpera()||of(n),e.getWin().focus()),(be.browser.isFirefox()||e.inline)&&(of(n),Gb(e,s)),rf(e)},rf=e=>e.editorManager.setActive(e),ZP=(e,t)=>{e.removed||(t?rf(e):QP(e))},Yb=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(v.fromDom).map(i=>!s||!t.collapsed?ci(i,o(i,a)).getOr(i):i).bind(i=>Ut(i)?m.some(i):kn(i).filter(Ut)).map(i=>i.dom).getOr(e)},Xb=(e,t,n=!1)=>Yb(e,t,!0,n,(s,o)=>Math.min(yg(s),o)),Qb=(e,t,n=!1)=>Yb(e,t,!1,n,(s,o)=>o>0?o-1:o),Zb=(e,t)=>{const n=e;for(;e&&P(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},JP=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer;const o=t.startOffset,r=t.endOffset;let a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),P(n)&&P(s)&&(n.length===o?n=Zb(n.nextSibling,!0):n=n.parentNode,r===0?s=Zb(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));const i=P(a)?a.parentNode:a;return H(i)?i:e},eD=(e,t,n,s)=>{const o=[],r=e.getRoot(),a=e.getParent(n||Xb(r,t,t.collapsed),e.isBlock),i=e.getParent(s||Qb(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let l;const c=new it(a,r);for(;(l=c.next())&&l!==i;)e.isBlock(l)&&o.push(l)}return i&&a!==i&&i!==r&&o.push(i),o},tD=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{const r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(Iu(e,a,s,!0),Iu(e,a,s,!1)),a})),af=(e,t)=>ve(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),nD=e=>Ie(e)==="img"?1:Wg(e).fold(()=>Ct(e).length,t=>t.length),sD=e=>Wg(e).filter(t=>t.trim().length!==0||t.indexOf(mt)>-1).isSome(),oD=e=>fx(e)&&Jt(e,"contenteditable")==="false",rD=["img","br"],Jb=e=>sD(e)||Te(rD,Ie(e))||oD(e),aD=e=>Ox(e,Jb),iD=e=>lD(e,Jb),lD=(e,t)=>{const n=s=>{const o=Ct(s);for(let r=o.length-1;r>=0;r--){const a=o[r];if(t(a))return m.some(a);const i=n(a);if(i.isSome())return i}return m.none()};return n(e)},ev="[data-mce-autocompleter]",cD=(e,t)=>{if(tv(v.fromDom(e.getBody())).isNone()){const n=v.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());at(n,v.fromDom(t.extractContents())),t.insertNode(n.dom),kn(n).each(s=>s.dom.normalize()),iD(n).map(s=>{e.selection.setCursorLocation(s.dom,nD(s))})}},uD=e=>Js(e,ev),tv=e=>qr(e,ev),fD=(e,t)=>tv(t).each(n=>{const s=e.selection.getBookmark();cs(n),e.selection.moveToBookmark(s)}),dD={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},al=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},mD=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!ro(n))return!1;const s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},nv=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class Lt{constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}static create(t,n){const s=new Lt(t,dD[t]||1);return n&&Pe(n,(o,r)=>{s.attr(r,o)}),s}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;if(!q(t))return z(t)&&Pe(t,(r,a)=>{s.attr(a,r)}),s;const o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new Lt(t.name,t.type),s=t.attributes;if(s){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=al(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=al(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;const r=this;let a=r.firstChild;if(nv(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||nv(a))return!1}if(a.type===8||a.type===3&&!mD(a)||a.type===3&&a.parent&&n[a.parent.name]&&ro((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=al(a,r));return!0}walk(t){return al(this,null,t)}}const gD=(e,t)=>/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t)),sv=(e,t,n=0)=>{const s=e.toLowerCase();if(s.indexOf("[if ",n)!==-1&&gD(s,n)){const o=s.indexOf("[endif]",n);return s.indexOf(">",o)}else if(t){const o=s.indexOf(">",n);return o!==-1?o:s.length}else{const o=/--!?>/g;o.lastIndex=n;const r=o.exec(e);return r?r.index+r[0].length:s.length}},pD=(e,t,n)=>{const s=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,r=e.getVoidElements();let a=1,i=n;for(;a!==0;)for(s.lastIndex=i;;){const l=s.exec(t);if(l===null)return i;if(l[1]==="!"){bt(l[2],"--")?i=sv(t,!1,l.index+3):i=sv(t,!0,l.index+1);break}else{o.lastIndex=s.lastIndex;const c=o.exec(t);if(hn(c)||c.index!==s.lastIndex)continue;l[1]==="/"?a-=1:le(r,l[2])||(a+=1),i=s.lastIndex+c[0].length;break}}return i},hD=(e,t)=>{const n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")},ov=(e,t)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,s=e.schema;let o=hD(e.getTempAttrs(),t);const r=s.getVoidElements();let a;for(;a=n.exec(o);){const i=n.lastIndex,l=a[0].length;let c;r[a[1]]?c=i:c=pD(s,o,i),o=o.substring(0,i-l)+o.substring(c),n.lastIndex=i-l}return fs(o)},bD=ov,rv=e=>{const t=kt(e,"[data-mce-bogus]");B(t,n=>{Jt(n,"data-mce-bogus")==="all"?Fe(n):so(n)?(en(n,v.fromText(Qo)),Fe(n)):cs(n)})},av=e=>{const t=kt(e,"input");B(t,n=>{vt(n,"name")})},vD=(e,t)=>{const n=Kt(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},CD=(e,t)=>{const n=e.getDoc(),s=Es(v.fromDom(e.getBody())),o=v.fromTag("div",n);dt(o,"data-mce-bogus","all"),fi(o,{position:"fixed",left:"-9999999px",top:"0"}),mi(o,t.innerHTML),rv(o),av(o);const r=Ax(s);at(r,o);const a=fs(o.dom.innerText);return Fe(o),a},yD=(e,t,n)=>{let s;return t.format==="raw"?s=L.trim(bD(e.serializer,n.innerHTML)):t.format==="text"?s=CD(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=vD(e,e.serializer.serialize(n,t)),t.format!=="text"&&!yi(v.fromDom(n))&&q(s)?L.trim(s):s},ED=(e,t)=>m.from(e.getBody()).fold(K(t.format==="tree"?new Lt("body",11):""),n=>yD(e,t,n)),iv=L.makeMap,lv=e=>{const t=[];e=e||{};const n=e.indent,s=iv(e.indent_before||""),o=iv(e.indent_after||""),r=Ns.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&s[i]&&t.length>0){const f=t[t.length-1];f.length>0&&f!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let f=0,u=l.length;f<u;f++){const d=l[f];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0){const f=t[t.length-1];f.length>0&&f!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Bs=(e={},t=_s())=>{const n=lv(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:l=>{var c;n.text((c=l.value)!==null&&c!==void 0?c:"",l.raw)},8:l=>{var c;n.comment((c=l.value)!==null&&c!==void 0?c:"")},7:l=>{n.pi(l.name,l.value)},10:l=>{var c;n.doctype((c=l.value)!==null&&c!==void 0?c:"")},4:l=>{var c;n.cdata((c=l.value)!==null&&c!==void 0?c:"")},11:l=>{let c=l;if(c=c.firstChild)do i(c);while(c=c.next)}};n.reset();const i=l=>{var c;const f=a[l.type];if(f)f(l);else{const u=l.name,d=u in t.getVoidElements();let p=l.attributes;if(r&&p&&p.length>1){const b=[];b.map={};const g=t.getElementRule(l.name);if(g){for(let h=0,y=g.attributesOrder.length;h<y;h++){const C=g.attributesOrder[h];if(C in p.map){const E=p.map[C];b.map[C]=E,b.push({name:C,value:E})}}for(let h=0,y=p.length;h<y;h++){const C=p[h].name;if(!(C in b.map)){const E=p.map[C];b.map[C]=E,b.push({name:C,value:E})}}p=b}}if(n.start(u,p,d),!d){let b=l.firstChild;if(b){(u==="pre"||u==="textarea")&&b.type===3&&((c=b.value)===null||c===void 0?void 0:c[0])===`
`&&n.text(`
`,!0);do i(b);while(b=b.next)}n.end(u)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},cv=new Set;B(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{cv.add(t)});const uv=["font","text-decoration","text-emphasis"],lf=(e,t)=>qt(e.parseStyle(e.getAttrib(t,"style"))),SD=e=>cv.has(e),wD=(e,t)=>vs(lf(e,t),n=>!SD(n)),kD=e=>oe(e,t=>Xe(uv,n=>bt(t,n))),xD=(e,t,n)=>{const s=lf(e,t),o=lf(e,n),r=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",f=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return Mn(c)&&Mn(f)&&c!==f};return Xe(s,a=>{const i=l=>Xe(l,c=>c===a);if(!i(o)&&i(uv)){const l=kD(o);return Xe(l,r)}else return r(a)})},fv=(e,t,n)=>m.from(n.container()).filter(P).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),cf=G(fv,!0,lr),uf=G(fv,!1,lr),ND=e=>{const t=e.container();return P(t)&&(t.data.length===0||Si(t.data)&&Ca.isBookmarkNode(t.parentNode))},Os=(e,t)=>n=>wu(e?0:-1,n).filter(t).isSome(),dv=e=>Hg(e)&&Hn(v.fromDom(e),"display")==="block",mv=e=>De(e)&&!Jx(e),_D=Os(!0,dv),AD=Os(!1,dv),Sa=Os(!0,Vn),wa=Os(!1,Vn),gv=Os(!0,us),pv=Os(!1,us),Is=Os(!0,mv),Ls=Os(!1,mv),RD=e=>e.slice(0,-1),TD=(e,t,n)=>as(t,e)?RD(bg(e,s=>n(s)||ye(s,t))):[],hv=(e,t)=>TD(e,t,ze),gs=(e,t)=>[e].concat(hv(e,t)),ff=(e,t,n)=>Hh(e,t,n,ND),bv=(e,t)=>rt(gs(v.fromDom(t.container()),e),tn),vv=(e,t,n)=>ff(e,t.dom,n).forall(s=>bv(t,n).fold(()=>!jn(s,n,t.dom),o=>!jn(s,n,t.dom)&&as(o,v.fromDom(s.container())))),Cv=(e,t,n)=>bv(t,n).fold(()=>ff(e,t.dom,n).forall(s=>!jn(s,n,t.dom)),s=>ff(e,s.dom,n).isNone()),df=G(Cv,!1),yv=G(Cv,!0),PD=G(vv,!1),DD=G(vv,!0),BD=e=>zi(e).exists(so),il=(e,t,n)=>{const s=oe(gs(v.fromDom(n.container()),t),tn),o=Mt(s).getOr(t);return sn(e,o.dom,n).filter(BD)},mf=(e,t)=>zi(t).exists(so)||il(!0,e,t).isSome(),gf=(e,t)=>fT(t).exists(so)||il(!1,e,t).isSome(),OD=G(il,!1),ID=G(il,!0),Ev=e=>A.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),Sv=(e,t)=>{const n=oe(gs(v.fromDom(t.container()),e),tn);return Mt(n).getOr(e)},wv=(e,t)=>Ev(t)?uf(t):uf(t)||on(Sv(e,t).dom,t).exists(uf),kv=(e,t)=>Ev(t)?cf(t):cf(t)||zt(Sv(e,t).dom,t).exists(cf),LD=e=>Te(["pre","pre-wrap"],e),pf=e=>zi(e).bind(t=>Zs(t,Ut)).exists(t=>LD(Hn(t,"white-space"))),$D=(e,t)=>on(e.dom,t).isNone(),FD=(e,t)=>zt(e.dom,t).isNone(),MD=(e,t)=>$D(e,t)||FD(e,t)||df(e,t)||yv(e,t)||gf(e,t)||mf(e,t),UD=e=>z(e)&&De(e)&&Rh(e),xv=(e,t)=>n=>UD(new it(n,e)[t]()),zD=(e,t)=>{const n=zt(e.dom,t).getOr(t),s=xv(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},HD=(e,t)=>{const n=on(e.dom,t).getOr(t),s=xv(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},VD=(e,t)=>pf(t)?!1:MD(e,t)||wv(e,t)||kv(e,t),ka=(e,t)=>pf(t)?!1:df(e,t)||PD(e,t)||gf(e,t)||wv(e,t)||HD(e,t),WD=e=>{const t=e.container(),n=e.offset();return P(t)&&n<t.data.length?A(t,n+1):e},xa=(e,t)=>pf(t)?!1:yv(e,t)||DD(e,t)||mf(e,t)||kv(e,t)||zD(e,t),hf=(e,t)=>ka(e,t)||xa(e,WD(t)),Nv=(e,t)=>qi(e.charAt(t)),_v=(e,t)=>lr(e.charAt(t)),jD=e=>{const t=e.container();return P(t)&&wt(t.data,mt)},qD=e=>{const t=e.split("");return ve(t,(n,s)=>qi(n)&&s>0&&s<t.length-1&&Tu(t[s-1])&&Tu(t[s+1])?" ":n).join("")},Av=(e,t,n)=>{const s=t.data,o=A(t,0);return!n&&Nv(s,0)&&!hf(e,o)?(t.data=" "+s.slice(1),!0):n&&_v(s,0)&&ka(e,o)?(t.data=mt+s.slice(1),!0):!1},KD=e=>{const t=e.data,n=qD(t);return n!==t?(e.data=n,!0):!1},Rv=(e,t,n)=>{const s=t.data,o=A(t,s.length-1);return!n&&Nv(s,s.length-1)&&!hf(e,o)?(t.data=s.slice(0,-1)+" ",!0):n&&_v(s,s.length-1)&&xa(e,o)?(t.data=s.slice(0,-1)+mt,!0):!1},GD=(e,t)=>{const n=t.container();if(!P(n))return m.none();if(jD(t)){const s=Av(e,n,!1)||KD(n)||Rv(e,n,!1);return Fr(s,t)}else if(hf(e,t)){const s=Av(e,n,!0)||Rv(e,n,!0);return Fr(s,t)}else return m.none()},YD=e=>{const t=v.fromDom(e.getBody());e.selection.isCollapsed()&&GD(t,A.fromRangeStart(e.selection.getRng())).each(n=>{e.selection.setRng(n.toRange())})},Tv=(e,t,n)=>{if(n===0)return;const s=v.fromDom(e),o=ls(s,tn).getOr(s),r=e.data.slice(t,t+n),a=t+n>=e.data.length&&xa(o,A(e,e.data.length)),i=t===0&&ka(o,A(e,0));e.replaceData(t,n,Zg(r,4,i,a))},ll=(e,t)=>{const n=e.data.slice(t),s=n.length-xk(n).length;Tv(e,t,s)},bf=(e,t)=>{const n=e.data.slice(0,t),s=n.length-Gm(n).length;Tv(e,t-s,s)},vf=(e,t,n,s=!0)=>{const o=Gm(e.data).length,r=s?e:t,a=s?t:e;return s?r.appendData(a.data):r.insertData(0,a.data),Fe(v.fromDom(a)),n&&ll(r,o),r},XD=(e,t)=>{const n=e.container(),s=e.offset();return!A.isTextPosition(e)&&n===t.parentNode&&s>A.before(t).offset()},QD=(e,t)=>XD(t,e)?A(t.container(),t.offset()-1):t,ZD=e=>P(e)?A(e,0):A.before(e),JD=e=>P(e)?A(e,e.data.length):A.after(e),Pv=e=>bn(e.previousSibling)?m.some(JD(e.previousSibling)):e.previousSibling?Gn(e.previousSibling):m.none(),Dv=e=>bn(e.nextSibling)?m.some(ZD(e.nextSibling)):e.nextSibling?It(e.nextSibling):m.none(),eB=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>on(e,A.before(n))).orThunk(()=>zt(e,A.after(t))),tB=(e,t)=>zt(e,A.after(t)).orThunk(()=>on(e,A.before(t))),nB=(e,t)=>Pv(t).orThunk(()=>Dv(t)).orThunk(()=>eB(e,t)),sB=(e,t)=>Dv(t).orThunk(()=>Pv(t)).orThunk(()=>tB(e,t)),oB=(e,t,n)=>e?sB(t,n):nB(t,n),rB=(e,t,n)=>oB(e,t,n).map(G(QD,n)),Bv=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},aB=e=>t=>t.dom===e,iB=(e,t)=>t&&le(e.schema.getBlockElements(),Ie(t)),lB=e=>{if(Qe(e)){const t=v.fromHtml('<br data-mce-bogus="1">');return Yo(e),at(e,t),m.some(A.before(t.dom))}else return m.none()},cB=(e,t,n)=>{const s=Qs(e).filter(Zt),o=Wr(e).filter(Zt);return Fe(e),nx(s,o,t,(r,a,i)=>{const l=r.dom,c=a.dom,f=l.data.length;return vf(l,c,n),i.container()===c?A(l,f):i}).orThunk(()=>(n&&(s.each(r=>bf(r.dom,r.dom.length)),o.each(r=>ll(r.dom,0))),t))},uB=(e,t)=>le(e.schema.getTextInlineElements(),Ie(t)),wo=(e,t,n,s=!0)=>{const o=rB(t,e.getBody(),n.dom),r=ls(n,G(iB,e),aB(e.getBody())),a=cB(n,o,uB(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):r.bind(lB).fold(()=>{s&&Bv(e,t,a)},i=>{s&&Bv(e,t,m.some(i))})},fB=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,dB=e=>fB.test(e),ko=(e,t)=>wn(v.fromDom(t),QA(e))&&!ao(e.schema,t)&&e.dom.isEditable(t),mB=e=>{var t;return _e.DOM.getStyle(e,"direction",!0)==="rtl"||dB((t=e.textContent)!==null&&t!==void 0?t:"")},gB=(e,t,n)=>oe(_e.DOM.getParents(n.container(),"*",t),e),$s=(e,t,n)=>{const s=gB(e,t,n);return m.from(s[s.length-1])},pB=(e,t,n)=>{const s=Ps(t,e),o=Ps(n,e);return z(s)&&s===o},hB=e=>Hc(e)||Vc(e),cn=(e,t)=>{const n=t.container(),s=t.offset();return e?xs(n)?P(n.nextSibling)?A(n.nextSibling,0):A.after(n):Hc(t)?A(n,s+1):t:xs(n)?P(n.previousSibling)?A(n.previousSibling,n.previousSibling.data.length):A.before(n):Vc(t)?A(n,s-1):t},Ov=G(cn,!0),Iv=G(cn,!1),Lv=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},bB=e=>{e.execCommand("delete")},Cf=e=>Lv(e,"Delete"),vB=e=>Lv(e,"ForwardDelete"),CB=e=>t=>qo(kn(t),e,ye),yB=e=>jg(e)||Yr(e),cl=(e,t)=>as(e,t)?Zs(t,yB,CB(e)):m.none(),yf=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},EB=(e,t,n)=>Bt(It(n),Gn(n),(s,o)=>{const r=cn(!0,s),a=cn(!1,o),i=cn(!1,t);return e?zt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):on(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),$v=e=>(ux(e)?Qs(e):Dc(e)).bind($v).orThunk(()=>m.some(e)),Fv=(e,t,n,s=!0)=>{var o;t.deleteContents();const r=$v(n).getOr(n),a=v.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?yf(e,s):Qe(a)&&(oo(a),s&&e.selection.setCursorLocation(a.dom,0)),!ye(n,a)){const i=qo(kn(a),n)?[]:xx(a);B(i.concat(Ct(n)),l=>{!ye(l,a)&&!as(l,a)&&Qe(l)&&Fe(l)})}},SB=e=>t=>ye(e,t),Ef=e=>kt(e,"td,th"),wB=(e,t)=>{const n=c=>ba(v.fromDom(c),t),s=n(e.startContainer),o=n(e.endContainer),r=s.isSome(),a=o.isSome(),i=Bt(s,o,ye).getOr(!1);return{startTable:s,endTable:o,isStartInTable:r,isEndInTable:a,isSameTable:i,isMultiTable:!i&&r&&a}},Sf=(e,t)=>({start:e,end:t}),kB=(e,t,n)=>({rng:e,table:t,cells:n}),Na=Wn.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),ul=(e,t)=>Js(v.fromDom(e),"td,th",t),Mv=e=>!ye(e.start,e.end),Uv=(e,t)=>ba(e.start,t).bind(n=>ba(e.end,t).bind(s=>Fr(ye(n,s),n))),xB=(e,t)=>!Mv(e)&&Uv(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),NB=(e,t)=>{const n=ul(e.startContainer,t),s=ul(e.endContainer,t);return Bt(n,s,Sf)},_B=e=>t=>ba(t,e).bind(n=>Ks(Ef(n)).map(s=>Sf(t,s))),AB=e=>t=>ba(t,e).bind(n=>Mt(Ef(n)).map(s=>Sf(s,t))),wf=e=>t=>Uv(t,e).map(n=>kB(t,n,Ef(n))),zv=(e,t,n,s)=>{if(n.collapsed||!e.forall(Mv))return m.none();if(t.isSameTable){const o=e.bind(wf(s));return m.some({start:o,end:o})}else{const o=ul(n.startContainer,s),r=ul(n.endContainer,s),a=o.bind(_B(s)).bind(wf(s)),i=r.bind(AB(s)).bind(wf(s));return m.some({start:a,end:i})}},Hv=(e,t)=>Dr(e,n=>ye(n,t)),kf=e=>Bt(Hv(e.cells,e.rng.start),Hv(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),RB=(e,t,n)=>e.exists(s=>xB(s,n)&&Ou(s.start,t)),Vv=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},TB=(e,t,n,s)=>zv(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=kf(o).getOr([]);if(r&&o.cells.length===a.length)return m.some(Na.fullTable(o.table));if(a.length>0){if(r)return m.some(Na.partialTable(a,m.none()));{const i=Vv(n,t);return m.some(Na.partialTable(a,m.some({...t,rng:i})))}}else return m.none()}),PB=(e,t,n,s)=>zv(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind(kf).getOr([]),i=r.bind(kf).getOr([]);if(a.length>0&&i.length>0){const l=Vv(n,t);return m.some(Na.multiTable(a,i,l))}else return m.none()}),DB=(e,t)=>{const n=SB(e),s=NB(t,n),o=wB(t,n);return RB(s,t,n)?s.map(r=>Na.singleCellTable(t,r.start)):o.isMultiTable?PB(s,o,t,n):TB(s,o,t,n)},Wv=e=>B(e,t=>{vt(t,"contenteditable"),oo(t)}),BB=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(v.fromDom),OB=(e,t,n)=>{n.each(s=>{t?Fe(s):(oo(s),e.selection.setCursorLocation(s.dom,0))})},xf=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Nf(e,o,t,!1).each(r=>r())},jv=e=>{const t=cr(e),n=v.fromDom(e.selection.getNode());bi(n.dom)&&Qe(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Xe(t,s=>ye(s,n))&&dt(n,"data-mce-selected","1")},qv=(e,t,n)=>m.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=BB(e,a?r.endContainer:r.startContainer);r.deleteContents(),OB(e,a,i.filter(Qe));const l=a?t[0]:t[t.length-1];return xf(e,l,s,a),Qe(l)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Wv(o),jv(e)}),IB=(e,t,n,s)=>m.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];xf(e,r,o,!0),xf(e,a,o,!1);const i=Qe(r)?t:t.slice(1),l=Qe(a)?n:n.slice(0,-1);Wv(i.concat(l)),s.deleteContents(),jv(e)}),Nf=(e,t,n,s=!0)=>m.some(()=>{Fv(e,t,n,s)}),LB=(e,t)=>m.some(()=>wo(e,!1,t)),$B=(e,t,n)=>DB(t,n).bind(s=>s.fold(G(Nf,e),G(LB,e),G(qv,e),G(IB,e))),FB=(e,t)=>fl(e,t),MB=(e,t,n,s)=>_f(t,s).fold(()=>$B(e,t,n),o=>FB(e,o)),UB=(e,t,n)=>{const s=v.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?qv(e,n,m.none()):MB(e,s,o,t)},Kv=(e,t)=>rt(gs(t,e),Xr),_f=(e,t)=>rt(gs(t,e),_c("caption")),zB=(e,t,n,s,o)=>Wi(n,e.getBody(),o).bind(r=>Kv(t,v.fromDom(r.getNode())).bind(a=>ye(a,s)?m.none():m.some(de))),fl=(e,t)=>m.some(()=>{oo(t),e.selection.setCursorLocation(t.dom,0)}),HB=(e,t,n,s)=>It(e.dom).bind(o=>Gn(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),VB=(e,t)=>fl(e,t),WB=(e,t,n)=>_f(e,v.fromDom(n.getNode())).fold(()=>m.some(de),s=>Fr(!ye(s,t),de)),jB=(e,t,n,s,o)=>Wi(n,e.getBody(),o).fold(()=>m.some(de),r=>HB(s,n,o,r)?VB(e,s):WB(t,s,r)),qB=(e,t,n,s)=>{const o=A.fromRangeStart(e.selection.getRng());return Kv(n,s).bind(r=>Qe(r)?fl(e,r):zB(e,n,t,r,o))},KB=(e,t,n,s)=>{const o=A.fromRangeStart(e.selection.getRng());return Qe(s)?fl(e,s):jB(e,n,t,s,o)},Gv=(e,t)=>e?gv(t):pv(t),GB=(e,t)=>{const n=A.fromRangeStart(e.selection.getRng());return Gv(t,n)||sn(t,e.getBody(),n).exists(s=>Gv(t,s))},YB=(e,t,n)=>{const s=v.fromDom(e.getBody());return _f(s,n).fold(()=>qB(e,t,s,n).orThunk(()=>Fr(GB(e,t),de)),o=>KB(e,t,s,o))},Af=(e,t)=>{const n=v.fromDom(e.selection.getStart(!0)),s=cr(e);return e.selection.isCollapsed()&&s.length===0?YB(e,t,n):UB(e,n,s)},xo=(e,t)=>{let n=t;for(;n&&n!==e;){if(Nn(n)||De(n))return n;n=n.parentNode}return null},XB=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],QB=L.each,Rf=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;const i=c=>{const f={};return QB(t.getAttribs(c),u=>{const d=u.nodeName.toLowerCase();d!=="style"&&!o(d)&&(f[d]=t.getAttrib(c,d))}),f},l=(c,f)=>{for(const u in c)if(le(c,u)){const d=f[u];if(Pt(d)||c[u]!==d)return!1;delete f[u]}for(const u in f)if(le(f,u))return!1;return!0};return H(r)&&H(a)&&(!l(i(r),i(a))||!l(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!rn(r)&&!rn(a)},o=r=>Xe(XB,a=>bt(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},ZB=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},Yv=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],l=i.name;if(l in n.attributes.map){const c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},JB=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&ZB(n,o=>{Yv(e,t,o,s)}),s},Xv=(e,t)=>{const n=(s,o)=>{Pe(s,r=>{const a=jt(r.nodes);B(r.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(!(o?c.attr(r.filter.name)!==void 0:c.name===r.filter.name)||Je(c.parent))&&a.splice(l,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},Qv=(e,t,n,s={})=>{const o=JB(e,t,n);Xv(o,s)},Tf=(e,t,n)=>{if(e.insert&&t(n)){const s=new Lt("br",1);s.attr("data-mce-bogus","1"),n.empty().append(s)}else n.empty().append(new Lt("#text",3)).value=mt},eO=e=>{var t;return Zv(e,"#text")&&((t=e==null?void 0:e.firstChild)===null||t===void 0?void 0:t.value)===mt},Zv=(e,t)=>{const n=e==null?void 0:e.firstChild;return z(n)&&n===e.lastChild&&n.name===t},tO=(e,t)=>{const n=e.getElementRule(t.name);return(n==null?void 0:n.paddEmpty)===!0},_a=(e,t,n,s)=>s.isEmpty(t,n,o=>tO(e,o)),nO=(e,t)=>z(e)&&(t(e)||e.name==="br"),sO=e=>{let t;for(let n=e;n;n=n.parent){const s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},Pf=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)n&&!t.isValidChild(n.name,o.name)&&Pf(o,t,n);e.unwrap()}},Df=(e,t,n,s=de)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=L.makeMap("tr,td,th,tbody,thead,tfoot,table"),l=new Set,c=f=>f!==n&&!i[f.name];for(let f=0;f<e.length;f++){const u=e[f];let d,p,b;if(!u.parent||l.has(u))continue;if(o[u.name]&&u.parent.name==="li"){let h=u.next;for(;h&&o[h.name];){h.name="li",l.add(h),u.parent.insert(h,u.parent);h=h.next}u.unwrap();continue}const g=[u];for(d=u.parent;d&&!t.isValidChild(d.name,u.name)&&c(d);d=d.parent)g.push(d);if(d&&g.length>1)if(t.isValidChild(d.name,u.name)){g.reverse(),p=g[0].clone(),s(p);let h=p;for(let y=0;y<g.length-1;y++){t.isValidChild(h.name,g[y].name)&&y>0?(b=g[y].clone(),s(b),h.append(b)):b=h;for(let C=g[y].firstChild;C&&C!==g[y+1];){const E=C.next;b.append(C),C=E}h=b}_a(t,r,a,p)?d.insert(u,g[0],!0):(d.insert(p,g[0],!0),d.insert(u,p)),d=g[0],(_a(t,r,a,d)||Zv(d,"br"))&&d.empty().remove()}else Pf(u,t);else if(u.parent){if(u.name==="li"){let h=u.prev;if(h&&(h.name==="ul"||h.name==="ol")){h.append(u);continue}if(h=u.next,h&&(h.name==="ul"||h.name==="ol")&&h.firstChild){h.insert(u,h.firstChild,!0);continue}const y=new Lt("ul",1);s(y),u.wrap(y);continue}if(t.isValidChild(u.parent.name,"div")&&t.isValidChild("div",u.name)){const h=new Lt("div",1);s(h),u.wrap(h)}else Pf(u,t)}}},oO=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},Jv=(e,t,n=t.parent)=>n&&e.children[t.name]&&!e.isValidChild(n.name,t.name)?!0:!!(n&&t.name==="a"&&oO(n,"a")),rO=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},aO=e=>{const t=A.fromRangeStart(e),n=A.fromRangeEnd(e),s=e.commonAncestorContainer;return sn(!1,s,n).map(o=>!jn(t,n,s)&&jn(t,o,s)?rO(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},Bf=e=>e.collapsed?e:aO(e),iO=e=>z(e.firstChild)&&e.firstChild===e.lastChild,lO=e=>e.name==="br"||e.value===mt,cO=(e,t)=>e.getBlockElements()[t.name]&&iO(t)&&lO(t.firstChild),uO=(e,t)=>{const n=e.getNonEmptyElements();return z(t)&&(t.isEmpty(n)||cO(e,t))},fO=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),uO(e,s)&&(s=s==null?void 0:s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},dO=e=>{var t,n;const s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},mO=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return dO(o)},gO=e=>{var t;return oe((t=e==null?void 0:e.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},pO=e=>e.data===mt||We(e),hO=e=>z(e==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&pO(e.firstChild),bO=e=>!e.firstChild||hO(e),vO=e=>e.length>0&&bO(e[e.length-1])?e.slice(0,-1):e,Of=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},CO=(e,t)=>!!Of(e,t),yO=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},EO=(e,t)=>{const n=A.before(e),o=Kn(t).next(n);return o?o.toRange():null},eC=(e,t)=>{const n=A.after(e),o=Kn(t).prev(n);return o?o.toRange():null},SO=(e,t,n,s)=>{const o=yO(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),L.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),eC(t[t.length-1],n)},wO=(e,t,n)=>{const s=e.parentNode;return s&&L.each(t,o=>{s.insertBefore(o,e)}),EO(e,n)},kO=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),eC(t[0],n)),xO=(e,t,n,s)=>{const o=mO(t,e,s),r=Of(t,n.startContainer),a=vO(gO(o.firstChild)),i=1,l=2,c=t.getRoot(),f=u=>{const d=A.fromRangeStart(n),p=Kn(t.getRoot()),b=u===i?p.prev(d):p.next(d),g=b==null?void 0:b.getNode();return g?Of(t,g)!==r:!0};return r?f(i)?wO(r,a,c):f(l)?kO(r,a,c,t):SO(r,a,c,n):null},NO=["pre"],_O=(e,t,n,s)=>{var o;const r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,l=r===i,c=Te(NO,r.name);if(l&&c){const f=r.attr("contenteditable")!=="false",u=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(xo(s,n)).forall(Nn);return f&&u&&d}else return!1},If=bi,AO=(e,t,n)=>{if(z(n)){const s=e.getParent(t.endContainer,If);return n===s&&Ou(v.fromDom(n),t)}else return!1},RO=(e,t,n)=>{var s;if(n.getAttribute("data-mce-bogus")==="all")(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n);else{const o=n.firstChild,r=n.lastChild;!o||o===r&&o.nodeName==="BR"?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},TO=(e,t)=>{m.from(e.getParent(t,"td,th")).map(v.fromDom).each(EN)},PO=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=Rf(e);L.each(s.select("*[data-mce-fragment]"),a=>{if(z(n[a.nodeName.toLowerCase()])&&wD(s,a)){for(let l=a.parentElement;z(l)&&l!==o&&!xD(s,a,l);l=l.parentElement)if(r.compare(l,a)){s.remove(a,!0);break}}})}},DO=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},BO=e=>{L.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},OO=e=>!!e.getAttribute("data-mce-fragment"),IO=(e,t)=>z(t)&&!e.schema.getVoidElements()[t.nodeName],LO=(e,t)=>{var n,s,o;let r;const a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);const l=xo(e.getBody(),t);if(l&&a.getContentEditable(l)==="false"){a.remove(t),i.select(l);return}let c=a.createRng();const f=t.previousSibling;if(P(f)){c.setStart(f,(s=(n=f.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);const p=t.nextSibling;P(p)&&(f.appendData(p.data),(o=p.parentNode)===null||o===void 0||o.removeChild(p))}else c.setStartBefore(t),c.setEndBefore(t);const u=p=>{let b=A.fromRangeStart(p);return b=Kn(e.getBody()).next(b),b==null?void 0:b.toRange()},d=a.getParent(t,a.isBlock);a.remove(t),d&&a.isEmpty(d)&&(Yo(v.fromDom(d)),c.setStart(d,0),c.setEnd(d,0),!If(d)&&!OO(d)&&(r=u(c))?(c=r,a.remove(d)):a.add(d,a.create("br",{"data-mce-bogus":"1"}))),i.setRng(c)},$O=e=>{const t=e.dom,n=Bf(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,If);AO(t,n,s)?Nf(e,n,v.fromDom(s)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset===1&&P(n.startContainer.childNodes[n.startOffset])?n.deleteContents():e.getDoc().execCommand("Delete",!1)},FO=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},MO=(e,t,n)=>{var s,o;const r=e.selection,a=e.dom,i=e.parser,l=n.merge,c=Bs({validate:!0},e.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,f);let u=r.getRng();const d=u.startContainer,p=e.getBody();d===p&&r.isCollapsed()&&a.isBlock(p.firstChild)&&IO(e,p.firstChild)&&a.isEmpty(p.firstChild)&&(u=a.createRng(),u.setStart(p.firstChild,0),u.setEnd(p.firstChild,0),r.setRng(u)),r.isCollapsed()||$O(e);const b=r.getNode(),g={context:b.nodeName.toLowerCase(),data:n.data,insert:!0},h=i.parse(t,g);if(n.paste===!0&&fO(e.schema,h)&&CO(a,b))return u=xO(c,a,r.getRng(),h),u&&r.setRng(u),t;n.paste===!0&&_O(a,h,b,e.getBody())&&((s=h.firstChild)===null||s===void 0||s.unwrap()),DO(h);let y=h.lastChild;if(y&&y.attr("id")==="mce_marker"){const C=y;for(y=y.prev;y;y=y.walk(!0))if(y.type===3||!a.isBlock(y.name)){y.parent&&e.schema.isValidChild(y.parent.name,"span")&&y.parent.insert(C,y,y.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(b),!g.invalid)t=c.serialize(h),RO(e,t,b);else{e.selection.setContent(f);let C=r.getNode(),E;const S=e.getBody();for(Gr(C)?C=E=S:E=C;E&&E!==S;)C=E,E=E.parentNode;t=C===S?S.innerHTML:a.getOuterHTML(C);const R=i.parse(t),$=FO(R),I=$.bind(sO).getOr(R);$.each(X=>X.replace(h));const N=h.children(),x=(o=h.parent)!==null&&o!==void 0?o:R;h.unwrap();const U=oe(N,X=>Jv(e.schema,X,x));Df(U,e.schema,I),Qv(i.getNodeFilters(),i.getAttributeFilters(),R),t=c.serialize(R),C===S?a.setHTML(S,t):a.setOuterHTML(C,t)}return PO(e,l),LO(e,a.get("mce_marker")),BO(e.getBody()),TO(a,r.getStart()),QN(e.schema,e.getBody(),r.getStart()),t},dl=e=>e instanceof Lt,UO=e=>{So(e)&&It(e.getBody()).each(t=>{const n=t.getNode(),s=us(n)?It(n).getOr(t):t;e.selection.setRng(s.toRange())})},Lf=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&UO(e)},zO=(e,t,n,s)=>{if(n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=Kt(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,ca(e),n)):n||(n=o),Lf(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=Bs({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=yi(v.fromDom(t))?n:L.trim(n);return Lf(e,o,s.no_selection),{content:o,html:o}}},HO=(e,t,n,s)=>{Qv(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=Bs({validate:!1},e.schema).serialize(n),r=yi(v.fromDom(t))?o:L.trim(o);return Lf(e,r,s.no_selection),{content:n,html:r}},VO=(e,t,n)=>m.from(e.getBody()).map(s=>dl(t)?HO(e,s,t,n):zO(e,s,t,n)).getOr({content:t,html:dl(n.content)?"":n.content}),WO=(e,t,n)=>ls(e,t,n).isSome(),jO=(e,t)=>Dx(e,t).isSome(),tC=e=>Ce(e)?e:ze,qO=(e,t,n)=>{let s=e.dom;const o=tC(n);for(;s.parentNode;){s=s.parentNode;const r=v.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},$f=(e,t,n)=>{const s=t(e),o=tC(n);return s.orThunk(()=>o(e)?m.none():qO(e,t,o))},Ff=Uu,nC=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(an(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},Mf=(e,t,n,s,o)=>{const r=e.dom.getRoot();if(t===r)return!1;const a=e.dom.getParent(t,i=>nC(e,i,n)?!0:i.parentNode===r||!!Xn(e,i,n,s,!0));return!!Xn(e,a,n,s,o)},ml=(e,t,n)=>lt(n)&&Ff(t,n.inline)||Yn(n)&&Ff(t,n.block)?!0:an(n)?H(t)&&e.is(t,n.selector):!1,sC=(e,t,n,s,o,r)=>{const a=n[s],i=s==="attributes";if(Ce(n.onmatch))return n.onmatch(t,n,s);if(a){if(zm(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):Xi(e,t,a[l]))return!0}else for(const l in a)if(le(a,l)){const c=i?e.getAttrib(t,l):Xi(e,t,l),f=Ds(a[l],r),u=Je(c)||$r(c);if(u&&Je(f))continue;if(o&&u&&!n.exact||(!o||n.exact)&&!Ff(c,zu(f,l)))return!1}}return!0},Xn=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&H(t))for(let i=0;i<r.length;i++){const l=r[i];if(ml(e.dom,t,l)&&sC(a,t,l,"attributes",o,s)&&sC(a,t,l,"styles",o,s)){const c=l.classes;if(c){for(let f=0;f<c.length;f++)if(!e.dom.hasClass(t,Ds(c[f],s)))return}return l}}},Uf=(e,t,n,s,o)=>{if(s)return Mf(e,s,t,n,o);if(s=e.selection.getNode(),Mf(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&Mf(e,r,t,n,o))},KO=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const l=t[i];!o[l]&&Xn(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},GO=(e,t)=>{const n=o=>ye(o,v.fromDom(e.getBody())),s=(o,r)=>Xn(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>$f(v.fromDom(o),r=>Vo(t,a=>s(r,a)),n)).getOrNull()},YO=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n){const o=e.selection.getStart(),r=Qi(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!an(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},XO=(e,t,n)=>Wt(n,(s,o)=>{const r=GT(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),gr=yt,QO=(e,t)=>e.importNode(t,!0),ZO=e=>{const t=[];let n=e;for(;n;){if(P(n)&&n.data!==gr||n.childNodes.length>1)return[];H(n)&&t.push(n),n=n.firstChild}return t},oC=e=>ZO(e).length>0,rC=e=>{if(e){const t=new it(e,e);for(let n=t.current();n;n=t.next())if(P(n))return n}return null},zf=e=>{const t=v.fromTag("span");return ys(t,{id:Au,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&at(t,v.fromText(gr)),t},JO=e=>{const t=rC(e);return t&&t.data.charAt(0)===gr&&t.deleteData(0,1),t},Hf=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(oC(t))wo(e,!1,v.fromDom(t),n);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,f=r.endOffset,u=JO(t);s.remove(t,!0),i===u&&l>0&&r.setStart(u,l-1),c===u&&f>0&&r.setEnd(u,f-1),a&&s.isEmpty(a)&&oo(v.fromDom(a)),o.setRng(r)}},Vf=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(t)Hf(e,t,n);else if(t=bo(e.getBody(),o.getStart()),!t)for(;t=s.get(Au);)Hf(e,t,!1)},eI=(e,t,n)=>{var s,o;const r=e.dom,a=r.getParent(n,G(Fu,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(yN(v.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},aC=(e,t)=>(e.appendChild(t),t),iC=(e,t)=>{var n;const s=Pr(e,(r,a)=>aC(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return aC(s,o.createTextNode(gr))},tI=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,l=oe(qt(a.get()),u=>u!==s&&!wt(u,"removeformat")),c=XO(e,n,l);if(oe(c,u=>!YT(e,u,s)).length>0){const u=n.cloneNode(!1);return i.add(t,u),a.remove(s,o,u,r),i.remove(u),m.some(u)}else return m.none()},nI=(e,t,n)=>{let s;const o=e.selection,r=e.formatter.get(t);if(!r)return;const a=o.getRng();let i=a.startOffset;const c=a.startContainer.nodeValue;s=bo(e.getBody(),o.getStart());const f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&f.test(c.charAt(i))&&f.test(c.charAt(i-1))){const u=o.getBookmark();a.collapse(!0);let d=Co(e.dom,a,r);d=ol(d),e.formatter.apply(t,n,d),o.moveToBookmark(u)}else{let u=s?rC(s):null;(!s||(u==null?void 0:u.data)!==gr)&&(s=QO(e.getDoc(),zf(!0).dom),u=s.firstChild,a.insertNode(s),i=1),e.formatter.apply(t,n,s),o.setCursorLocation(u,i)}},sI=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const l=r.getRng(),c=l.startContainer,f=l.startOffset;let u=c;P(c)&&(f!==c.data.length&&(a=!0),u=u.parentNode);const d=[];let p;for(;u;){if(Xn(e,u,t,n,s)){p=u;break}u.nextSibling&&(a=!0),d.push(u),u=u.parentNode}if(p)if(a){const b=r.getBookmark();l.collapse(!0);let g=Co(o,l,i,!0);g=ol(g),e.formatter.remove(t,n,g,s),r.moveToBookmark(b)}else{const b=bo(e.getBody(),p),g=zf(!1).dom;eI(e,g,b??p);const h=tI(e,g,p,t,n,s),y=iC(d.concat(h.toArray()),g);b&&Hf(e,b,!1),r.setCursorLocation(y,1),o.isEmpty(p)&&o.remove(p)}},oI=(e,t)=>{const n=e.selection,s=e.getBody();Vf(e,null,!1),(t===8||t===46)&&n.isCollapsed()&&n.getStart().innerHTML===gr&&Vf(e,bo(s,n.getStart())),(t===37||t===39)&&Vf(e,bo(s,n.getStart()))},rI=e=>{e.on("mouseup keydown",t=>{oI(e,t.keyCode)})},lC=e=>{const t=zf(!1),n=iC(e,t.dom);return{caretContainer:t,caretPosition:A(n,0)}},cC=(e,t)=>{const{caretContainer:n,caretPosition:s}=lC(t);return en(v.fromDom(e),n),Fe(v.fromDom(e)),s},aI=(e,t)=>{const{caretContainer:n,caretPosition:s}=lC(t);return e.selection.getRng().insertNode(n.dom),s},uC=(e,t)=>{const n=e.schema.getTextInlineElements();return le(n,Ie(t))&&!vn(t.dom)&&!no(t.dom)},fC=e=>vn(e.dom)&&oC(e.dom),Aa={},dC=xn(["pre"]),iI=(e,t)=>{Aa[e]||(Aa[e]=[]),Aa[e].push(t)},lI=(e,t)=>{le(Aa,e)&&B(Aa[e],n=>{n(t)})};iI("pre",e=>{const t=e.selection.getRng(),n=o=>r=>{const a=r.previousSibling;return dC(a)&&Te(o,a)},s=(o,r)=>{const a=v.fromDom(r),i=is(a).dom;Fe(a),eo(v.fromDom(o),[v.fromTag("br",i),v.fromTag("br",i),...Ct(a)])};if(!t.collapsed){const o=e.selection.getSelectedBlocks(),r=oe(oe(o,dC),n(o));B(r,a=>{s(a.previousSibling,a)})}});const mC=["fontWeight","fontStyle","color","fontSize","fontFamily"],cI=e=>Ye(e.styles)&&Xe(qt(e.styles),t=>Te(mC,t)),uI=e=>rt(e,t=>lt(t)&&t.inline==="span"&&cI(t)),gC=(e,t)=>{const n=e.get(t);return ot(n)?uI(n):m.none()},pC=(e,t)=>on(t,A.fromRangeStart(e)).isNone(),hC=(e,t)=>zt(t,A.fromRangeEnd(e)).exists(n=>!We(n.getNode())||zt(t,n).isSome())===!1,bC=e=>t=>sN(t)&&e.isEditable(t),fI=e=>{const t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return pC(n,t[0])&&hC(n,t[0])?t:[];{const s=Mt(t).filter(a=>pC(n,a)).toArray(),o=Ks(t).filter(a=>hC(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},dI=e=>oe(fI(e),bC(e.dom)),vC=e=>oe(e.getSelectedBlocks(),bC(e.dom)),Wf=L.each,jf=e=>H(e)&&!rn(e)&&!vn(e)&&!no(e),CC=(e,t)=>{for(let n=e;n;n=n[t]){if(P(n)&&Mn(n.data))return e;if(H(n)&&!rn(n))return n}return e},yC=(e,t,n)=>{const s=Rf(e),o=H(t)&&vo(t),r=H(n)&&vo(n);if(o&&r){const a=CC(t,"previousSibling"),i=CC(n,"nextSibling");if(s.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),L.each(L.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},EC=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){const r=(o=yC(e,tb(s),s))!==null&&o!==void 0?o:s;yC(e,r,tb(r,!0))}},mI=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";Wf(e.select(s,n),o=>{jf(o)&&vo(o)&&Wf(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},qf=(e,t,n)=>{Wf(e.childNodes,s=>{jf(s)&&(t(s)&&n(s),s.hasChildNodes()&&qf(s,t,n))})},gI=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},SC=(e,t)=>n=>!!(n&&Xi(e,n,t)),wC=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),gI(e,s)},No=Wn.generate([{keep:[]},{rename:["name"]},{removed:[]}]),pI=/^(src|href|style)$/,Kf=L.each,gl=Uu,hI=e=>/^(TR|TH|TD)$/.test(e.nodeName),kC=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),xC=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(H(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return P(s)&&n&&o>=s.data.length&&(s=new it(s,e.getBody()).next()||s),P(s)&&!n&&o===0&&(s=new it(s,e.getBody()).prev()||s),s},NC=(e,t)=>{const n=t?"firstChild":"lastChild",s=e[n];return hI(e)&&s?e.nodeName==="TR"&&s[n]||s:e},Gf=(e,t,n,s)=>{var o;const r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},_C=(e,t,n,s,o)=>{const r=v.fromDom(t),a=v.fromDom(e.create(s,o)),i=n?Cg(r):vg(r);return eo(a,i),n?(en(r,a),Rg(a,r)):(Ss(r,a),at(a,r)),a.dom},bI=(e,t)=>t.links&&e.nodeName==="A",AC=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=Kt(e);Yn(n)&&s===r.getRoot()&&(!n.list_block||!gl(t,n.list_block))&&B(jt(t.childNodes),i=>{ur(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=Gf(r,i,a),r.setAttribs(o,ca(e))):o=null}),!(ZT(n)&&!gl(n.inline,t))&&r.remove(t,!0)},RC=(e,t,n)=>Sn(e)?{name:t,value:null}:{name:e,value:Ds(t,n)},TC=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},PC=(e,t,n,s,o)=>{let r=!1;Kf(n.styles,(a,i)=>{const{name:l,value:c}=RC(i,a,s),f=zu(c,l);(n.remove_similar||hn(c)||!H(o)||gl(Xi(e,o,l),f))&&e.setStyle(t,l,""),r=!0}),r&&TC(e,t)},vI=(e,t,n)=>{t==="removeformat"?B(vC(e.selection),s=>{B(mC,o=>e.dom.setStyle(s,o,"")),TC(e.dom,s)}):gC(e.formatter,t).each(s=>{B(vC(e.selection),o=>PC(e.dom,o,s,n,null))})},DC=(e,t,n,s,o)=>{const r=e.dom,a=Rf(e),i=e.schema;if(lt(t)&&Ni(i,t.inline)&&ao(i,s)&&s.parentElement===e.getBody())return AC(e,s,t),No.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!ml(r,s,t)&&!bI(s,t))return No.keep();const l=s,c=t.preserve_attributes;if(lt(t)&&t.remove==="all"&&ot(c)){const f=oe(r.getAttribs(l),u=>Te(c,u.name.toLowerCase()));if(r.removeAllAttribs(l),B(f,u=>r.setAttrib(l,u.name,u.value)),f.length>0)return No.rename("span")}if(t.remove!=="all"){PC(r,l,t,n,o),Kf(t.attributes,(u,d)=>{const{name:p,value:b}=RC(d,u,n);if(t.remove_similar||hn(b)||!H(o)||gl(r.getAttrib(o,p),b)){if(p==="class"){const g=r.getAttrib(l,p);if(g){let h="";if(B(g.split(/\s+/),y=>{/mce\-\w+/.test(y)&&(h+=(h?" ":"")+y)}),h){r.setAttrib(l,p,h);return}}}if(pI.test(p)&&l.removeAttribute("data-mce-"+p),p==="style"&&xn(["li"])(l)&&r.getStyle(l,"list-style-type")==="none"){l.removeAttribute(p),r.setStyle(l,"list-style-type","none");return}p==="class"&&l.removeAttribute("className"),l.removeAttribute(p)}}),Kf(t.classes,u=>{u=Ds(u,n),(!H(o)||r.hasClass(o,u))&&r.removeClass(l,u)});const f=r.getAttribs(l);for(let u=0;u<f.length;u++){const d=f[u].nodeName;if(!a.isAttributeInternal(d))return No.keep()}}return t.remove!=="none"?(AC(e,l,t),No.removed()):No.keep()},Ra=(e,t,n,s,o)=>DC(e,t,n,s,o).fold(ze,r=>(e.dom.rename(s,r),!0),et),CI=(e,t,n,s,o)=>{let r;return t.parentNode&&B(Qi(e.dom,t.parentNode).reverse(),a=>{if(!r&&H(a)&&a.id!=="_start"&&a.id!=="_end"){const i=Xn(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},yI=(e,t,n,s)=>DC(e,t,n,s,s).fold(K(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),K(null)),EI=(e,t,n,s,o,r,a,i)=>{var l,c;let f,u;const d=e.dom;if(n){const p=n.parentNode;for(let b=s.parentNode;b&&b!==p;b=b.parentNode){let g=d.clone(b,!1);for(let h=0;h<t.length&&(g=yI(e,t[h],i,g),g!==null);h++);g&&(f&&g.appendChild(f),u||(u=g),f=g)}(!a.mixed||!d.isBlock(n))&&(s=(l=d.split(n,s))!==null&&l!==void 0?l:s),f&&u&&((c=o.parentNode)===null||c===void 0||c.insertBefore(f,o),u.appendChild(o),lt(a)&&EC(e,a,i,f))}return s},BC=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0],i=e.dom,l=e.selection,c=g=>{const h=CI(e,g,t,n,o);return EI(e,r,h,g,g,!0,a,n)},f=g=>rn(g)&&H(g)&&(g.id==="_start"||g.id==="_end"),u=g=>Xe(r,h=>Ra(e,h,n,g,g)),d=g=>{const h=jt(g.childNodes),C=u(g)||Xe(r,R=>ml(i,g,R)),E=g.parentNode;if(!C&&z(E)&&Vu(a)&&u(E),a.deep&&h.length)for(let R=0;R<h.length;R++)d(h[R]);B(["underline","line-through","overline"],R=>{H(g)&&e.dom.getStyle(g,"text-decoration")===R&&g.parentNode&&sb(i,g.parentNode)===R&&Ra(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:R}},void 0,g)})},p=g=>{const h=i.get(g?"_start":"_end");if(h){let y=h[g?"firstChild":"lastChild"];return f(y)&&(y=y[g?"firstChild":"lastChild"]),P(y)&&y.data.length===0&&(y=g?h.previousSibling||h.nextSibling:h.nextSibling||h.previousSibling),i.remove(h,!0),y}else return null},b=g=>{let h,y,C=Co(i,g,r,g.collapsed);if(a.split){if(C=ol(C),h=xC(e,C,!0),y=xC(e,C),h!==y){if(h=NC(h,!0),y=NC(y,!1),kC(i,h,y)){const S=m.from(h.firstChild).getOr(h);c(_C(i,S,!0,"span",{id:"_start","data-mce-type":"bookmark"})),p(!0);return}if(kC(i,y,h)){const S=m.from(y.lastChild).getOr(y);c(_C(i,S,!1,"span",{id:"_end","data-mce-type":"bookmark"})),p(!1);return}h=Gf(i,h,"span",{id:"_start","data-mce-type":"bookmark"}),y=Gf(i,y,"span",{id:"_end","data-mce-type":"bookmark"});const E=i.createRng();E.setStartAfter(h),E.setEndBefore(y),va(i,E,S=>{B(S,R=>{!rn(R)&&!rn(R.parentNode)&&c(R)})}),c(h),c(y),h=p(!0),y=p()}else h=y=c(h);C.startContainer=h.parentNode?h.parentNode:h,C.startOffset=i.nodeIndex(h),C.endContainer=y.parentNode?y.parentNode:y,C.endOffset=i.nodeIndex(y)+1}va(i,C,E=>{B(E,d)})};if(s){if(Yi(s)){const g=i.createRng();g.setStartBefore(s),g.setEndAfter(s),b(g)}else b(s);Cb(e,t,s,n);return}!l.isCollapsed()||!lt(a)||cr(e).length?(eb(e,()=>Lu(e,b),g=>lt(a)&&Uf(e,t,n,g)),e.nodeChanged()):sI(e,t,n,o),vI(e,t,n),Cb(e,t,s,n)},OC=L.each,SI=(e,t,n,s)=>{const o=r=>{if(H(r)&&H(r.parentNode)&&vo(r)){const a=sb(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(L.walk(s,o,"childNodes"),o(s))},wI=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){const o=SC(e,"fontSize");qf(s,r=>o(r)&&vo(r),wC(e,"backgroundColor",Ds(t.styles.backgroundColor,n)))}},kI=(e,t,n,s)=>{if(lt(t)&&(t.inline==="sub"||t.inline==="sup")){const o=SC(e,"fontSize");qf(s,a=>o(a)&&vo(a),wC(e,"fontSize",""));const r=oe(e.select(t.inline==="sup"?"sub":"sup",s),vo);e.remove(r,!0)}},xI=(e,t,n,s)=>{OC(t,o=>{lt(o)&&OC(e.dom.select(o.inline,s),r=>{jf(r)&&Ra(e,o,n,r,o.exact?r:null)}),mI(e.dom,o,s)})},NI=(e,t,n,s,o)=>{const r=o.parentNode;Xn(e,r,n,s)&&Ra(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>Xn(e,a,n,s)?(Ra(e,t,s,o),!0):!1)},pl=L.each,_I=(e,t,n,s)=>{if(rR(e)&&lt(t)&&n.parentNode){const o=gp(e.schema),r=jO(v.fromDom(n),a=>vn(a.dom));return Wo(o,s)&&Qe(v.fromDom(n.parentNode),!1)&&!r}else return!1},IC=(e,t,n,s)=>{if(pl(n.styles,(o,r)=>{e.setStyle(t,r,Ds(o,s))}),n.styles){const o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},LC=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(b,g=r)=>{Ce(g.onformat)&&g.onformat(b,g,n,s),IC(i,b,g,n),pl(g.attributes,(h,y)=>{i.setAttrib(b,y,Ds(h,n))}),pl(g.classes,h=>{const y=Ds(h,n);i.hasClass(b,y)||i.addClass(b,y)})},f=(b,g)=>{let h=!1;return pl(b,y=>an(y)?i.getContentEditable(g)==="false"&&!y.ceFalseOverride||z(y.collapsed)&&y.collapsed!==a?!0:i.is(g,y.selector)&&!vn(g)?(c(g,y),h=!0,!1):!0:!1),h},u=b=>{if(q(b)){const g=i.create(b);return c(g),g}else return null},d=(b,g,h)=>{const y=[];let C=!0;const E=r.inline||r.block,S=u(E),R=N=>XT(r)&&Xn(e,N,t,n),$=(N,x,U)=>{const X=QT(r)&&Fu(e.schema,N)&&ur(e,x,E);return U&&X},I=(N,x,U,X)=>{const J=N.nodeName.toLowerCase(),re=ur(e,E,J)&&ur(e,x,E),fe=!h&&P(N)&&Si(N.data),he=vn(N),Se=!lt(r)||!b.isBlock(N);return(U||X)&&re&&!fe&&!he&&Se};va(b,g,N=>{let x;const U=X=>{let J=!1,re=C,fe=!1;const he=X.parentNode,Se=he.nodeName.toLowerCase(),$e=b.getContentEditable(X);z($e)&&(re=C,C=$e==="true",J=!0,fe=nb(e,X));const pt=C&&!J;if(We(X)&&!_I(e,r,X,Se)){x=null,Yn(r)&&b.remove(X);return}if(R(X)){x=null;return}if($(X,Se,pt)){const Ze=b.rename(X,E);c(Ze),y.push(Ze),x=null;return}if(an(r)){let Ze=f(o,X);if(!Ze&&z(he)&&Vu(r)&&(Ze=f(o,he)),!lt(r)||Ze){x=null;return}}z(S)&&I(X,Se,pt,fe)?(x||(x=b.clone(S,!1),he.insertBefore(x,X),y.push(x)),fe&&J&&(C=re),x.appendChild(X)):(x=null,B(jt(X.childNodes),U),J&&(C=re),x=null)};B(N,U)}),r.links===!0&&B(y,N=>{const x=U=>{U.nodeName==="A"&&c(U,r),B(jt(U.childNodes),x)};x(N)}),B(y,N=>{const x=J=>{let re=0;return B(J.childNodes,fe=>{!qT(fe)&&!rn(fe)&&re++}),re},U=J=>rt(J.childNodes,$u).filter(fe=>b.getContentEditable(fe)!=="false"&&ml(b,fe,r)).map(fe=>{const he=b.clone(fe,!1);return c(he),b.replace(he,J,!0),b.remove(fe,!0),he}).getOr(J),X=x(N);if((y.length>1||!b.isBlock(N))&&X===0){b.remove(N,!0);return}(lt(r)||Yn(r)&&r.wrapper)&&(!r.exact&&X===1&&(N=U(N)),xI(e,o,n,N),NI(e,r,t,n,N),wI(b,r,n,N),SI(b,r,n,N),kI(b,r,n,N),EC(e,r,n,N))})},p=Yi(s)?s:l.getNode();if(i.getContentEditable(p)==="false"&&!nb(e,p)){s=p,f(o,s),vb(e,t,s,n);return}if(r){if(s)if(Yi(s)){if(!f(o,s)){const b=i.createRng();b.setStartBefore(s),b.setEndAfter(s),d(i,Co(i,b,o),!0)}}else d(i,s,!0);else!a||!lt(r)||cr(e).length?(l.setRng(Bf(l.getRng())),eb(e,()=>{Lu(e,(b,g)=>{const h=g?b:Co(i,b,o);d(i,h,!1)})},et),e.nodeChanged()):nI(e,t,n),gC(e.formatter,t).each(b=>{B(dI(e.selection),g=>IC(i,g,b,n))});lI(t,e)}vb(e,t,s,n)},$C=e=>le(e,"vars"),AI=(e,t)=>{e.set({}),t.on("NodeChange",n=>{zC(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=m.from(n.node).map(o=>Yi(o)?o:o.startContainer).bind(o=>H(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>FC(t));zC(t,s,e.get())})},FC=e=>e.selection.getStart(),MC=(e,t,n,s,o)=>$m(t,i=>{const l=e.formatter.matchNode(i,n,o??{},s);return!Pt(l)},i=>nC(e,i,n)?!0:s?!1:z(e.formatter.matchNode(i,n,o,!0))),UC=(e,t)=>{const n=t??FC(e);return oe(Qi(e.dom,n),s=>H(s)&&!no(s))},zC=(e,t,n)=>{const s=UC(e,t);Pe(n,(o,r)=>{const a=i=>{const l=MC(e,s,r,i.similar,$C(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const f=l.getOr(t);$C(i)?i.callback(c,{node:f,format:r,parents:s}):B(i.callbacks,u=>u(c,{node:f,format:r,parents:s}))}};B([o.withSimilar,o.withoutSimilar],a),B(o.withVars,a)})},RI=(e,t,n,s,o,r)=>{const a=t.get();B(n.split(","),i=>{const l=Oe(a,i).getOrThunk(()=>{const f={withSimilar:{state:ct(!1),similar:!0,callbacks:[]},withoutSimilar:{state:ct(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=f,f}),c=()=>{const f=UC(e);return MC(e,f,i,o,r).isSome()};if(Pt(r)){const f=o?l.withSimilar:l.withoutSimilar;f.callbacks.push(s),f.callbacks.length===1&&f.state.set(c())}else l.withVars.push({state:ct(c()),similar:o,vars:r,callback:s})}),t.set(a)},TI=(e,t,n)=>{const s=e.get();B(t.split(","),o=>Oe(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:oe(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:oe(r.withoutSimilar.callbacks,a=>a!==n)},withVars:oe(r.withVars,a=>a.callback!==n)}})),e.set(s)},PI=(e,t,n,s,o,r)=>(RI(e,t,n,s,o,r),{unbind:()=>TI(t,n,s)}),DI=(e,t,n,s)=>{const o=e.formatter.get(t);o&&(Uf(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?BC(e,t,n,s):LC(e,t,n,s))},HC=L.explode,VC=()=>{const e={};return{addFilter:(o,r)=>{B(HC(o),a=>{le(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>yc(e),removeFilter:(o,r)=>{B(HC(o),a=>{if(le(e,a))if(z(r)){const i=e[a],l=oe(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},BI=(e,t)=>{B(t,n=>{e.attr(n,null)})},OI=(e,t,n)=>{e.addNodeFilter("font",s=>{B(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&ai(l).each(c=>{r["font-size"]=n[c-1]}),o.name="span",o.attr("style",t.serialize(r)),BI(o,["color","face","size"])})})},II=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";B(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},LI=(e,t,n)=>{var s;const o=tu();t.convert_fonts_to_spans&&OI(e,o,L.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),II(e,n,o)},$I=(e,t,n)=>{t.inline_styles&&LI(e,t,n)},FI=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject(`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`)),MI=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},Yf=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=r?MI(s):decodeURIComponent(s);return m.some({type:o[1],data:a,base64Encoded:r})}else return m.none()},WC=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},UI=e=>new Promise((t,n)=>{Yf(e).bind(({type:s,data:o,base64Encoded:r})=>WC(s,o,r)).fold(()=>n("Invalid data URI"),t)}),zI=e=>bt(e,"blob:")?FI(e):bt(e,"data:")?UI(e):Promise.reject("Unknown URI format"),jC=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)});let HI=0;const VI=e=>"blobid"+HI++,qC=(e,t,n)=>Yf(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{const a=r?s:btoa(s);return n(a,o)}}),KC=(e,t,n)=>{const s=e.create(VI(),t,n);return e.add(s),s},GC=(e,t,n=!1)=>qC(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>WC(o,s).map(r=>KC(e,r,s)))),WI=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(bt(t,"blob:")){const s=e.getByUri(t);return z(s)?Promise.resolve(s):zI(t).then(o=>jC(o).then(r=>qC(r,!1,a=>m.some(KC(e,o,a))).getOrThunk(n)))}else return bt(t,"data:")?GC(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},jI=e=>z(e.attr("data-mce-bogus")),qI=e=>e.attr("src")===be.transparentSrc||z(e.attr("data-mce-placeholder")),KI=(e,t)=>{const{blob_cache:n}=t;if(n){const s=o=>{const r=o.attr("src");qI(o)||jI(o)||Je(r)||GC(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>B(o,s))}},GI=(e,t)=>{const n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(o,r,a)=>{const i=L.extend({},n.getBlockElements()),l=n.getNonEmptyElements(),c=n.getWhitespaceElements();i.body=1;const f=u=>u.name in i&&np(n,u);for(let u=0,d=o.length;u<d;u++){let p=o[u],b=p.parent;if(b&&i[b.name]&&p===b.lastChild){let g=p.prev;for(;g;){const h=g.name;if(h!=="span"||g.attr("data-mce-type")!=="bookmark"){h==="br"&&(p=null);break}g=g.prev}if(p&&(p.remove(),_a(n,l,c,b))){const h=n.getElementRule(b.name);h&&(h.removeEmpty?b.remove():h.paddEmpty&&Tf(a,f,b))}}else{let g=p;for(;b&&b.firstChild===g&&b.lastChild===g&&(g=b,!i[b.name]);)b=b.parent;if(g===b){const h=new Lt("#text",3);h.value=mt,p.replace(h)}}}}),e.addAttributeFilter("href",o=>{let r=o.length;const a=l=>l.split(" ").filter(f=>f.length>0).concat(["noopener"]).sort().join(" "),i=l=>{const c=l?L.trim(l):"";return/\b(noopener)\b/g.test(c)?c:a(c)};if(!t.allow_unsafe_link_target)for(;r--;){const l=o[r];l.name==="a"&&l.attr("target")==="_blank"&&l.attr("rel",i(l.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",o=>{let r=o.length,a,i,l,c;for(;r--;)if(c=o[r],c.name==="a"&&c.firstChild&&!c.attr("href"))for(l=c.parent,a=c.lastChild;a&&l;)i=a.prev,l.insert(a,c),a=i}),t.fix_list_elements&&e.addNodeFilter("ul,ol",o=>{let r=o.length,a,i;for(;r--;)if(a=o[r],i=a.parent,i&&(i.name==="ul"||i.name==="ol"))if(a.prev&&a.prev.name==="li")a.prev.append(a);else{const l=new Lt("li",1);l.attr("style","list-style-type: none"),a.wrap(l)}});const s=n.getValidClasses();t.validate&&s&&e.addAttributeFilter("class",o=>{var r;let a=o.length;for(;a--;){const i=o[a],l=(r=i.attr("class"))!==null&&r!==void 0?r:"",c=L.explode(l," ");let f="";for(let u=0;u<c.length;u++){const d=c[u];let p=!1,b=s["*"];b&&b[d]&&(p=!0),b=s[i.name],!p&&b&&b[d]&&(p=!0),p&&(f&&(f+=" "),f+=d)}f.length||(f=null),i.attr("class",f)}}),KI(e,t)};function _o(e){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o(e)}function Xf(e,t){return Xf=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},Xf(e,t)}function YI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hl(e,t,n){return YI()?hl=Reflect.construct:hl=function(o,r,a){var i=[null];i.push.apply(i,r);var l=Function.bind.apply(o,i),c=new l;return a&&Xf(c,a.prototype),c},hl.apply(null,arguments)}function Rn(e){return XI(e)||QI(e)||ZI(e)||JI()}function XI(e){if(Array.isArray(e))return Qf(e)}function QI(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZI(e,t){if(e){if(typeof e=="string")return Qf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qf(e,t)}}function Qf(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function JI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var eL=Object.hasOwnProperty,YC=Object.setPrototypeOf,tL=Object.isFrozen,nL=Object.getPrototypeOf,sL=Object.getOwnPropertyDescriptor,Ht=Object.freeze,Qn=Object.seal,oL=Object.create,XC=typeof Reflect<"u"&&Reflect,bl=XC.apply,Zf=XC.construct;bl||(bl=function(t,n,s){return t.apply(n,s)}),Ht||(Ht=function(t){return t}),Qn||(Qn=function(t){return t}),Zf||(Zf=function(t,n){return hl(t,Rn(n))});var rL=Tn(Array.prototype.forEach),aL=Tn(Array.prototype.pop),Ta=Tn(Array.prototype.push),vl=Tn(String.prototype.toLowerCase),iL=Tn(String.prototype.match),Fs=Tn(String.prototype.replace),lL=Tn(String.prototype.indexOf),cL=Tn(String.prototype.trim),Vt=Tn(RegExp.prototype.test),Jf=uL(TypeError);function Tn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return bl(e,t,s)}}function uL(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return Zf(e,n)}}function Ee(e,t){YC&&YC(e,null);for(var n=t.length;n--;){var s=t[n];if(typeof s=="string"){var o=vl(s);o!==s&&(tL(t)||(t[n]=o),s=o)}e[s]=!0}return e}function Ao(e){var t=oL(null),n;for(n in e)bl(eL,e,[n])&&(t[n]=e[n]);return t}function Cl(e,t){for(;e!==null;){var n=sL(e,t);if(n){if(n.get)return Tn(n.get);if(typeof n.value=="function")return Tn(n.value)}e=nL(e)}function s(o){return console.warn("fallback value for",o),null}return s}var QC=Ht(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ed=Ht(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),td=Ht(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fL=Ht(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nd=Ht(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),dL=Ht(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ZC=Ht(["#text"]),JC=Ht(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),sd=Ht(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ey=Ht(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),yl=Ht(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mL=Qn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gL=Qn(/<%[\w\W]*|[\w\W]*%>/gm),pL=Qn(/^data-[\-\w.\u00B7-\uFFFF]/),hL=Qn(/^aria-[\-\w]+$/),bL=Qn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vL=Qn(/^(?:\w+script|data):/i),CL=Qn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),yL=Qn(/^html$/i),EL=function(){return typeof window>"u"?null:window},SL=function(t,n){if(_o(t)!=="object"||typeof t.createPolicy!="function")return null;var s=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(s=n.currentScript.getAttribute(o));var r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML:function(i){return i}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function ty(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:EL(),t=function(_){return ty(_)};if(t.version="2.3.8",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,s=e.document,o=e.DocumentFragment,r=e.HTMLTemplateElement,a=e.Node,i=e.Element,l=e.NodeFilter,c=e.NamedNodeMap,f=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,u=e.HTMLFormElement,d=e.DOMParser,p=e.trustedTypes,b=i.prototype,g=Cl(b,"cloneNode"),h=Cl(b,"nextSibling"),y=Cl(b,"childNodes"),C=Cl(b,"parentNode");if(typeof r=="function"){var E=s.createElement("template");E.content&&E.content.ownerDocument&&(s=E.content.ownerDocument)}var S=SL(p,n),R=S?S.createHTML(""):"",$=s,I=$.implementation,N=$.createNodeIterator,x=$.createDocumentFragment,U=$.getElementsByTagName,X=n.importNode,J={};try{J=Ao(s).documentMode?s.documentMode:{}}catch{}var re={};t.isSupported=typeof C=="function"&&I&&typeof I.createHTMLDocument<"u"&&J!==9;var fe=mL,he=gL,Se=pL,$e=hL,pt=vL,Ze=CL,D=bL,j=null,me=Ee({},[].concat(Rn(QC),Rn(ed),Rn(td),Rn(nd),Rn(ZC))),F=null,Z=Ee({},[].concat(Rn(JC),Rn(sd),Rn(ey),Rn(yl))),ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),M=null,ue=null,ce=!0,tt=!0,Ae=!1,se=!1,pe=!1,He=!1,we=!1,Le=!1,Me=!1,Re=!1,Ve=!0,dn=!0,ht=!1,On={},Yt=null,Io=Ee({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Lo=null,In=Ee({},["audio","video","img","source","image","track"]),yn=null,qe=Ee({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),mn="http://www.w3.org/1998/Math/MathML",Ln="http://www.w3.org/2000/svg",gn="http://www.w3.org/1999/xhtml",pn=gn,ts=!1,St,bs=["application/xhtml+xml","text/html"],ns="text/html",En,zs=null,Ya=s.createElement("form"),Rm=function(_){return _ instanceof RegExp||_ instanceof Function},mc=function(_){zs&&zs===_||((!_||_o(_)!=="object")&&(_={}),_=Ao(_),j="ALLOWED_TAGS"in _?Ee({},_.ALLOWED_TAGS):me,F="ALLOWED_ATTR"in _?Ee({},_.ALLOWED_ATTR):Z,yn="ADD_URI_SAFE_ATTR"in _?Ee(Ao(qe),_.ADD_URI_SAFE_ATTR):qe,Lo="ADD_DATA_URI_TAGS"in _?Ee(Ao(In),_.ADD_DATA_URI_TAGS):In,Yt="FORBID_CONTENTS"in _?Ee({},_.FORBID_CONTENTS):Io,M="FORBID_TAGS"in _?Ee({},_.FORBID_TAGS):{},ue="FORBID_ATTR"in _?Ee({},_.FORBID_ATTR):{},On="USE_PROFILES"in _?_.USE_PROFILES:!1,ce=_.ALLOW_ARIA_ATTR!==!1,tt=_.ALLOW_DATA_ATTR!==!1,Ae=_.ALLOW_UNKNOWN_PROTOCOLS||!1,se=_.SAFE_FOR_TEMPLATES||!1,pe=_.WHOLE_DOCUMENT||!1,Le=_.RETURN_DOM||!1,Me=_.RETURN_DOM_FRAGMENT||!1,Re=_.RETURN_TRUSTED_TYPE||!1,we=_.FORCE_BODY||!1,Ve=_.SANITIZE_DOM!==!1,dn=_.KEEP_CONTENT!==!1,ht=_.IN_PLACE||!1,D=_.ALLOWED_URI_REGEXP||D,pn=_.NAMESPACE||gn,_.CUSTOM_ELEMENT_HANDLING&&Rm(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ee.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&Rm(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ee.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ee.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),St=bs.indexOf(_.PARSER_MEDIA_TYPE)===-1?St=ns:St=_.PARSER_MEDIA_TYPE,En=St==="application/xhtml+xml"?function(W){return W}:vl,se&&(tt=!1),Me&&(Le=!0),On&&(j=Ee({},Rn(ZC)),F=[],On.html===!0&&(Ee(j,QC),Ee(F,JC)),On.svg===!0&&(Ee(j,ed),Ee(F,sd),Ee(F,yl)),On.svgFilters===!0&&(Ee(j,td),Ee(F,sd),Ee(F,yl)),On.mathMl===!0&&(Ee(j,nd),Ee(F,ey),Ee(F,yl))),_.ADD_TAGS&&(j===me&&(j=Ao(j)),Ee(j,_.ADD_TAGS)),_.ADD_ATTR&&(F===Z&&(F=Ao(F)),Ee(F,_.ADD_ATTR)),_.ADD_URI_SAFE_ATTR&&Ee(yn,_.ADD_URI_SAFE_ATTR),_.FORBID_CONTENTS&&(Yt===Io&&(Yt=Ao(Yt)),Ee(Yt,_.FORBID_CONTENTS)),dn&&(j["#text"]=!0),pe&&Ee(j,["html","head","body"]),j.table&&(Ee(j,["tbody"]),delete M.tbody),Ht&&Ht(_),zs=_)},Tm=Ee({},["mi","mo","mn","ms","mtext"]),Pm=Ee({},["foreignobject","desc","title","annotation-xml"]),Yw=Ee({},["title","style","font","a","script"]),$n=Ee({},ed);Ee($n,td),Ee($n,fL);var Nr=Ee({},nd);Ee(Nr,dL);var w=function(_){var W=C(_);(!W||!W.tagName)&&(W={namespaceURI:gn,tagName:"template"});var ne=vl(_.tagName),Ue=vl(W.tagName);return _.namespaceURI===Ln?W.namespaceURI===gn?ne==="svg":W.namespaceURI===mn?ne==="svg"&&(Ue==="annotation-xml"||Tm[Ue]):!!$n[ne]:_.namespaceURI===mn?W.namespaceURI===gn?ne==="math":W.namespaceURI===Ln?ne==="math"&&Pm[Ue]:!!Nr[ne]:_.namespaceURI===gn?W.namespaceURI===Ln&&!Pm[Ue]||W.namespaceURI===mn&&!Tm[Ue]?!1:!Nr[ne]&&(Yw[ne]||!$n[ne]):!1},k=function(_){Ta(t.removed,{element:_});try{_.parentNode.removeChild(_)}catch{try{_.outerHTML=R}catch{_.remove()}}},O=function(_,W){try{Ta(t.removed,{attribute:W.getAttributeNode(_),from:W})}catch{Ta(t.removed,{attribute:null,from:W})}if(W.removeAttribute(_),_==="is"&&!F[_])if(Le||Me)try{k(W)}catch{}else try{W.setAttribute(_,"")}catch{}},T=function(_){var W,ne;if(we)_="<remove></remove>"+_;else{var Ue=iL(_,/^[\r\n\t ]+/);ne=Ue&&Ue[0]}St==="application/xhtml+xml"&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");var Xt=S?S.createHTML(_):_;if(pn===gn)try{W=new d().parseFromString(Xt,St)}catch{}if(!W||!W.documentElement){W=I.createDocument(pn,"template",null);try{W.documentElement.innerHTML=ts?"":Xt}catch{}}var Ft=W.body||W.documentElement;return _&&ne&&Ft.insertBefore(s.createTextNode(ne),Ft.childNodes[0]||null),pn===gn?U.call(W,pe?"html":"body")[0]:pe?W.documentElement:Ft},Q=function(_){return N.call(_.ownerDocument||_,_,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},ge=function(_){return _ instanceof u&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof f)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function")},xe=function(_){return _o(a)==="object"?_ instanceof a:_&&_o(_)==="object"&&typeof _.nodeType=="number"&&typeof _.nodeName=="string"},Ne=function(_,W,ne){re[_]&&rL(re[_],function(Ue){Ue.call(t,W,ne,zs)})},$o=function(_){var W;if(Ne("beforeSanitizeElements",_,null),ge(_)||Vt(/[\u0080-\uFFFF]/,_.nodeName))return k(_),!0;var ne=En(_.nodeName);if(Ne("uponSanitizeElement",_,{tagName:ne,allowedTags:j}),_.hasChildNodes()&&!xe(_.firstElementChild)&&(!xe(_.content)||!xe(_.content.firstElementChild))&&Vt(/<[/\w]/g,_.innerHTML)&&Vt(/<[/\w]/g,_.textContent)||ne==="select"&&Vt(/<template/i,_.innerHTML))return k(_),!0;if(!j[ne]||M[ne]){if(!M[ne]&&Xw(ne)&&(ee.tagNameCheck instanceof RegExp&&Vt(ee.tagNameCheck,ne)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(ne)))return!1;if(dn&&!Yt[ne]){var Ue=C(_)||_.parentNode,Xt=y(_)||_.childNodes;if(Xt&&Ue)for(var Ft=Xt.length,At=Ft-1;At>=0;--At)Ue.insertBefore(g(Xt[At],!0),h(_))}return k(_),!0}return _ instanceof i&&!w(_)||(ne==="noscript"||ne==="noembed")&&Vt(/<\/no(script|embed)/i,_.innerHTML)?(k(_),!0):(se&&_.nodeType===3&&(W=_.textContent,W=Fs(W,fe," "),W=Fs(W,he," "),_.textContent!==W&&(Ta(t.removed,{element:_.cloneNode()}),_.textContent=W)),Ne("afterSanitizeElements",_,null),!1)},Xa=function(_,W,ne){if(Ve&&(W==="id"||W==="name")&&(ne in s||ne in Ya))return!1;if(!(tt&&!ue[W]&&Vt(Se,W))){if(!(ce&&Vt($e,W))){if(!F[W]||ue[W]){if(!(Xw(_)&&(ee.tagNameCheck instanceof RegExp&&Vt(ee.tagNameCheck,_)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(_))&&(ee.attributeNameCheck instanceof RegExp&&Vt(ee.attributeNameCheck,W)||ee.attributeNameCheck instanceof Function&&ee.attributeNameCheck(W))||W==="is"&&ee.allowCustomizedBuiltInElements&&(ee.tagNameCheck instanceof RegExp&&Vt(ee.tagNameCheck,ne)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(ne))))return!1}else if(!yn[W]){if(!Vt(D,Fs(ne,Ze,""))){if(!((W==="src"||W==="xlink:href"||W==="href")&&_!=="script"&&lL(ne,"data:")===0&&Lo[_])){if(!(Ae&&!Vt(pt,Fs(ne,Ze,"")))){if(ne)return!1}}}}}}return!0},Xw=function(_){return _.indexOf("-")>0},Qw=function(_){var W,ne,Ue,Xt;Ne("beforeSanitizeAttributes",_,null);var Ft=_.attributes;if(Ft){var At={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F};for(Xt=Ft.length;Xt--;){W=Ft[Xt];var gc=W,Rt=gc.name,Zw=gc.namespaceURI;ne=Rt==="value"?W.value:cL(W.value),Ue=En(Rt);var D5=ne;if(At.attrName=Ue,At.attrValue=ne,At.keepAttr=!0,At.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",_,At),ne=At.attrValue,!At.forceKeepAttr){if(!At.keepAttr){O(Rt,_);continue}if(Vt(/\/>/i,ne)){O(Rt,_);continue}se&&(ne=Fs(ne,fe," "),ne=Fs(ne,he," "));var B5=En(_.nodeName);if(!Xa(B5,Ue,ne)){O(Rt,_);continue}if(ne!==D5)try{Zw?_.setAttributeNS(Zw,Rt,ne):_.setAttribute(Rt,ne)}catch{O(Rt,_)}}}Ne("afterSanitizeAttributes",_,null)}},P5=function ie(_){var W,ne=Q(_);for(Ne("beforeSanitizeShadowDOM",_,null);W=ne.nextNode();)Ne("uponSanitizeShadowNode",W,null),!$o(W)&&(W.content instanceof o&&ie(W.content),Qw(W));Ne("afterSanitizeShadowDOM",_,null)};return t.sanitize=function(ie,_){var W,ne,Ue,Xt,Ft;if(ts=!ie,ts&&(ie="<!-->"),typeof ie!="string"&&!xe(ie)){if(typeof ie.toString!="function")throw Jf("toString is not a function");if(ie=ie.toString(),typeof ie!="string")throw Jf("dirty is not a string, aborting")}if(!t.isSupported){if(_o(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof ie=="string")return e.toStaticHTML(ie);if(xe(ie))return e.toStaticHTML(ie.outerHTML)}return ie}if(He||mc(_),t.removed=[],typeof ie=="string"&&(ht=!1),ht){if(ie.nodeName){var At=En(ie.nodeName);if(!j[At]||M[At])throw Jf("root node is forbidden and cannot be sanitized in-place")}}else if(ie instanceof a)W=T("<!---->"),ne=W.ownerDocument.importNode(ie,!0),ne.nodeType===1&&ne.nodeName==="BODY"||ne.nodeName==="HTML"?W=ne:W.appendChild(ne);else{if(!Le&&!se&&!pe&&ie.indexOf("<")===-1)return S&&Re?S.createHTML(ie):ie;if(W=T(ie),!W)return Le?null:Re?R:""}W&&we&&k(W.firstChild);for(var gc=Q(ht?ie:W);Ue=gc.nextNode();)Ue.nodeType===3&&Ue===Xt||$o(Ue)||(Ue.content instanceof o&&P5(Ue.content),Qw(Ue),Xt=Ue);if(Xt=null,ht)return ie;if(Le){if(Me)for(Ft=x.call(W.ownerDocument);W.firstChild;)Ft.appendChild(W.firstChild);else Ft=W;return F.shadowroot&&(Ft=X.call(n,Ft,!0)),Ft}var Rt=pe?W.outerHTML:W.innerHTML;return pe&&j["!doctype"]&&W.ownerDocument&&W.ownerDocument.doctype&&W.ownerDocument.doctype.name&&Vt(yL,W.ownerDocument.doctype.name)&&(Rt="<!DOCTYPE "+W.ownerDocument.doctype.name+`>
`+Rt),se&&(Rt=Fs(Rt,fe," "),Rt=Fs(Rt,he," ")),S&&Re?S.createHTML(Rt):Rt},t.setConfig=function(ie){mc(ie),He=!0},t.clearConfig=function(){zs=null,He=!1},t.isValidAttribute=function(ie,_,W){zs||mc({});var ne=En(ie),Ue=En(_);return Xa(ne,Ue,W)},t.addHook=function(ie,_){typeof _=="function"&&(re[ie]=re[ie]||[],Ta(re[ie],_))},t.removeHook=function(ie){if(re[ie])return aL(re[ie])},t.removeHooks=function(ie){re[ie]&&(re[ie]=[])},t.removeAllHooks=function(){re={}},t}var wL=ty();const ny=L.each,kL=L.trim,xL=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],NL={ftp:21,http:80,https:443,mailto:25},_L=["img","video"],AL=(e,t)=>z(e)?!e:z(t)?!Te(_L,t):!0,RL=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},sy=(e,t,n)=>{const s=RL(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?AL(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class Pn{constructor(t,n={}){this.path="",this.directory="",t=kL(t),this.settings=n;const s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=s?s.path:new Pn(document.location.href).directory;if((s==null?void 0:s.protocol)==="")t="//mce_host"+o.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&ny(xL,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=Ns.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!sy(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new Pn(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){const s=new Pn(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?NL[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s=0;const o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];ny(r,u=>{u&&i.push(u)});const l=[];for(let u=a.length-1;u>=0;u--)if(!(a[u].length===0||a[u]===".")){if(a[u]===".."){s++;continue}if(s>0){s--;continue}l.push(a[u])}const c=i.length-s;let f;return c<=0?f=Br(l).join("/"):f=i.slice(0,c).join("/")+"/"+Br(l).join("/"),f.indexOf("/")!==0&&(f="/"+f),o&&f.lastIndexOf("/")!==f.length-1&&(f+=o),f}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const TL=L.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),od="data-mce-type";let oy=0;const ry=(e,t,n,s)=>{var o,r,a,i;const l=t.validate,c=n.getSpecialElements();e.nodeType===sg&&!t.allow_conditional_comments&&/^\[if/i.test((o=e.nodeValue)!==null&&o!==void 0?o:"")&&(e.nodeValue=" "+e.nodeValue);const f=(r=s==null?void 0:s.tagName)!==null&&r!==void 0?r:e.nodeName.toLowerCase();if(e.nodeType!==Mr||f==="body")return;const u=v.fromDom(e),d=li(u,od),p=Jt(u,"data-mce-bogus");if(!d&&q(p)){p==="all"?Fe(u):cs(u);return}const b=n.getElementRule(f);if(l&&!b){le(c,f)?Fe(u):cs(u);return}else z(s)&&(s.allowedTags[f]=!0);if(l&&b&&!d){if(B((a=b.attributesForced)!==null&&a!==void 0?a:[],g=>{dt(u,g.name,g.value==="{$uid}"?`mce_${oy++}`:g.value)}),B((i=b.attributesDefault)!==null&&i!==void 0?i:[],g=>{li(u,g.name)||dt(u,g.name,g.value==="{$uid}"?`mce_${oy++}`:g.value)}),b.attributesRequired&&!Xe(b.attributesRequired,g=>li(u,g))){cs(u);return}if(b.removeEmptyAttrs&&gx(u)){cs(u);return}b.outputName&&b.outputName!==f&&W_(u,b.outputName)}},ay=(e,t,n,s,o)=>!(s in TL&&sy(e,o,n))&&(!e.validate||t.isValid(n,s)||bt(s,"data-")||bt(s,"aria-")),iy=(e,t)=>e.hasAttribute(od)&&(t==="id"||t==="class"||t==="style"),ly=(e,t)=>e in t.getBoolAttrs(),PL=(e,t,n)=>{const{attributes:s}=e;for(let o=s.length-1;o>=0;o--){const r=s[o],a=r.name,i=r.value;!ay(t,n,e.tagName.toLowerCase(),a,i)&&!iy(e,a)?e.removeAttribute(a):ly(a,n)&&e.setAttribute(a,a)}},DL=(e,t)=>{const n=wL();return n.addHook("uponSanitizeElement",(s,o)=>{ry(s,e,t,o)}),n.addHook("uponSanitizeAttribute",(s,o)=>{const r=s.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=ay(e,t,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,ly(a,t)&&(o.attrValue=a),e.allow_svg_data_urls&&bt(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):iy(s,a)&&(o.forceKeepAttr=!0)}),n},BL=(e,t)=>{const s={...{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]}};return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},OL=(e,t)=>{if(e.sanitize){const n=DL(e,t);return(s,o)=>{n.sanitize(s,BL(e,o)),n.removed=[]}}else return(n,s)=>{const o=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let r;for(;r=o.nextNode();)ry(r,e,t),H(r)&&PL(r,e,t)}},cy=L.makeMap,uy=L.extend,fy=(e,t,n)=>{const s=e.name,o=s in n&&s!=="title"&&s!=="textarea",r=t.childNodes;for(let a=0,i=r.length;a<i;a++){const l=r[a],c=new Lt(l.nodeName.toLowerCase(),l.nodeType);if(H(l)){const f=l.attributes;for(let u=0,d=f.length;u<d;u++){const p=f[u];c.attr(p.name,p.value)}}else P(l)?(c.value=l.data,o&&(c.raw=!0)):(ws(l)||eN(l)||tN(l))&&(c.value=l.data);fy(c,l,n),e.append(c)}},IL=(e,t,n)=>{const s=[];for(let o=e,r=o;o;r=o,o=o.walk()){const a=o;B(t,i=>i(a)),Je(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){const r=s[o];B(n,a=>a(r))}},LL=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=uy(cy("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=gp(t),c=/[ \t\r\n]+/g,f=/^[ \t\r\n]+/,u=/[ \t\r\n]+$/,d=C=>{let E=C.parent;for(;z(E);){if(E.name in a)return!0;E=E.parent}return!1},p=C=>{let E=C;for(;z(E);){if(E.name in l)return _a(t,r,a,E);E=E.parent}return!1},b=C=>C.name in i&&!np(t,C),g=(C,E)=>{const S=E?C.prev:C.next;return z(S)||Je(C.parent)?!1:b(C.parent)&&(C.parent!==e||s.isRootContent===!0)};return[C=>{var E;if(C.type===3&&!d(C)){let S=(E=C.value)!==null&&E!==void 0?E:"";S=S.replace(c," "),(nO(C.prev,b)||g(C,!0))&&(S=S.replace(f,"")),S.length===0?C.remove():C.value=S}},C=>{var E;if(C.type===1){const S=t.getElementRule(C.name);if(o&&S){const R=_a(t,r,a,C);S.paddInEmptyBlock&&R&&p(C)?Tf(s,b,C):S.removeEmpty&&R?b(C)?C.remove():C.unwrap():S.paddEmpty&&(R||eO(C))&&Tf(s,b,C)}}else if(C.type===3&&!d(C)){let S=(E=C.value)!==null&&E!==void 0?E:"";(C.next&&b(C.next)||g(C,!1))&&(S=S.replace(u,"")),S.length===0?C.remove():C.value=S}}]},$L=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},pr=(e={},t=_s())=>{const n=VC(),s=VC(),o={validate:!0,root_name:"body",sanitize:!0,...e},r=new DOMParser,a=OL(o,t),i=(E,S,R="html")=>{const $=R==="xhtml"?"application/xhtml+xml":"text/html",I=le(t.getSpecialElements(),S.toLowerCase()),N=I?`<${S}>${E}</${S}>`:E,x=R==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${N}</body></html>`:`<body>${N}</body>`,U=r.parseFromString(x,$).body;return a(U,$),I?U.firstChild:U},l=n.addFilter,c=n.getFilters,f=n.removeFilter,u=s.addFilter,d=s.getFilters,p=s.removeFilter,b=(E,S)=>{Jv(t,E)&&S.push(E)},g=(E,S)=>{const R=q(S.attr(od)),$=S.type===1&&!le(E,S.name)&&!JN(t,S);return S.type===3||$&&!R},h=(E,S)=>{const R=uy(cy("script,style,head,html,body,title,meta,param"),t.getBlockElements()),$=/^[ \t\r\n]+/,I=/[ \t\r\n]+$/;let N=E.firstChild,x=null;const U=X=>{var J,re;X&&(N=X.firstChild,N&&N.type===3&&(N.value=(J=N.value)===null||J===void 0?void 0:J.replace($,"")),N=X.lastChild,N&&N.type===3&&(N.value=(re=N.value)===null||re===void 0?void 0:re.replace(I,"")))};if(t.isValidChild(E.name,S.toLowerCase())){for(;N;){const X=N.next;g(R,N)?(x||(x=new Lt(S,1),x.attr(o.forced_root_block_attrs),E.insert(x,N)),x.append(N)):(U(x),x=null),N=X}U(x)}},C={schema:t,addAttributeFilter:u,getAttributeFilters:d,removeAttributeFilter:p,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:f,parse:(E,S={})=>{var R;const $=o.validate,I=(R=S.context)!==null&&R!==void 0?R:o.root_name,N=i(E,I,S.format);Kc(t,N);const x=new Lt(I,11);fy(x,N,t.getSpecialElements()),N.innerHTML="";const[U,X]=LL(x,t,o,S),J=[],re=$?$e=>b($e,J):de,fe={nodes:{},attributes:{}},he=$e=>Yv(c(),d(),$e,fe);if(IL(x,[U,he],[X,re]),J.reverse(),$&&J.length>0)if(S.context){const{pass:$e,fail:pt}=Tr(J,Ze=>Ze.parent===x);Df(pt,t,x,he),S.invalid=$e.length>0}else Df(J,t,x,he);const Se=$L(o,S);return Se&&(x.name==="body"||S.isRootContent)&&h(x,Se),S.invalid||Xv(fe,S),x}};return GI(C,o),$I(C,o,t),C},FL=e=>dl(e)?Bs({validate:!1}).serialize(e):e,dy=(e,t,n)=>{const s=FL(e),o=t(s);if(o.isDefaultPrevented())return o;if(dl(e))if(o.content!==s){const r=pr({validate:!1,forced_root_block:!1,sanitize:n}).parse(o.content,{context:e.name});return{...o,content:r}}else return{...o,content:e};else return o},my=(e,t)=>{if(t.no_events)return Ot.value(t);{const n=S1(e,t);return n.isDefaultPrevented()?Ot.error(Eb(e,{content:"",...n}).content):Ot.value(n)}},gy=(e,t,n)=>n.no_events?t:dy(t,o=>Eb(e,{...n,content:o}),Eu(e)).content,rd=(e,t)=>{if(t.no_events)return Ot.value(t);{const n=dy(t.content,s=>E1(e,{...t,content:s}),Eu(e));return n.isDefaultPrevented()?(yb(e,n),Ot.error(void 0)):Ot.value(n)}},ad=(e,t,n)=>{n.no_events||yb(e,{...n,content:t})},id=(e,t,n)=>({element:e,width:t,rows:n}),py=(e,t)=>({element:e,cells:t}),ML=(e,t)=>({x:e,y:t}),hy=(e,t)=>rs(e,t).bind(ai).getOr(1),UL=(e,t,n,s,o)=>{const r=hy(o,"rowspan"),a=hy(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=py(Rp(s),[]));for(let c=t;c<t+a;c++){const f=i[l].cells;f[c]=l===n&&c===t?o:uo(o)}}},zL=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},HL=(e,t,n)=>{for(;zL(e,t,n);)t++;return t},by=e=>Wt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),vy=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(ye(o[r],t))return m.some(ML(r,s))}return m.none()},Cy=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(py(a[i].element,c))}return r},VL=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?Cy(e,s,o,r,a):Cy(e,s,a,r,o);return id(e.element,by(i),i)},WL=(e,t)=>{const n=uo(e.element),s=v.fromTag("tbody");return eo(s,t),at(n,s),n},jL=e=>ve(e.rows,t=>{const n=ve(t.cells,o=>{const r=Rp(o);return vt(r,"colspan"),vt(r,"rowspan"),r}),s=uo(t.element);return eo(s,n),s}),qL=e=>{const t=id(uo(e),0,[]);return B(kt(e,"tr"),(n,s)=>{B(kt(n,"td,th"),(o,r)=>{UL(t,HL(t,r,s),s,n,o)})}),id(t.element,by(t.rows),t.rows)},KL=e=>WL(e,jL(e)),GL=(e,t,n)=>vy(e,t).bind(s=>vy(e,n).map(o=>VL(e,s,o))),YL=e=>rt(e,t=>Ie(t)==="ul"||Ie(t)==="ol"),XL=(e,t)=>rt(e,n=>Ie(n)==="li"&&Ou(n,t)).fold(K([]),n=>YL(e).map(s=>{const o=v.fromTag(Ie(s)),r=Or(_g(s),(a,i)=>bt(i,"list-style"));return fi(o,r),[v.fromTag("li"),o]}).getOr([])),QL=(e,t)=>{const n=Wt(t,(s,o)=>(at(o,s),o),e);return t.length>0?Ku([n]):n},ZL=e=>Yr(e)?kn(e).filter(zc).fold(K([]),t=>[e,t]):zc(e)?[e]:[],JL=(e,t)=>{const n=v.fromDom(t.commonAncestorContainer),s=gs(n,e),o=oe(s,vN),r=XL(s,t),a=o.concat(r.length?r:ZL(n));return ve(a,uo)},yy=()=>Ku([]),e$=(e,t)=>QL(v.fromDom(t.cloneContents()),JL(e,t)),t$=(e,t)=>jr(t,"table",G(ye,e)),n$=(e,t)=>t$(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=qL(n);return GL(r,s,o).map(a=>Ku([KL(a)]))}).getOrThunk(yy),s$=(e,t)=>t.length>0&&t[0].collapsed?yy():e$(e,t[0]),o$=(e,t)=>{const n=Qh(t,e);return n.length>0?n$(e,n):s$(e,t)},El=(e,t)=>t>=0&&t<e.length&&lr(e.charAt(t)),Ey=e=>fs(e.innerText),r$=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),a$=e=>m.from(e.selection.getRng()).map(t=>{var n;const s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=r$(s),a=v.fromDom(t.cloneContents());rv(a),av(a);const i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),l=Ey(i),c=fs((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),El(c,0)||El(c,c.length-1)){const f=s.getOr(o),u=Ey(f),d=u.indexOf(l);if(d===-1)return l;{const p=El(u,d-1),b=El(u,d+l.length);return(p?" ":"")+l+(b?" ":"")}}else return l}).getOr(""),i$=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=af(e,Du(o)),a=t.contextual?o$(v.fromDom(e.getBody()),r).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},l$=(e,t)=>{if(t.format==="text")return a$(e);{const n=i$(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},c$=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),u$=(e,t,n={})=>{const s=c$(n,t);return my(e,s).fold(Dt,o=>{const r=l$(e,o);return gy(e,r,o)})},ld=0,Sy=1,wy=2,f$=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(f,u,d)=>({start:f,end:u,diag:d}),a=(f,u,d,p,b)=>{const g=l(f,u,d,p);if(g===null||g.start===u&&g.diag===u-p||g.end===f&&g.diag===f-d){let h=f,y=d;for(;h<u||y<p;)h<u&&y<p&&e[h]===t[y]?(b.push([ld,e[h]]),++h,++y):u-f>p-d?(b.push([wy,e[h]]),++h):(b.push([Sy,t[y]]),++y)}else{a(f,g.start,d,g.start-g.diag,b);for(let h=g.start;h<g.end;++h)b.push([ld,e[h]]);a(g.end,u,g.end-g.diag,p,b)}},i=(f,u,d,p)=>{let b=f;for(;b-u<p&&b<d&&e[b]===t[b-u];)++b;return r(f,b,u)},l=(f,u,d,p)=>{const b=u-f,g=p-d;if(b===0||g===0)return null;const h=b-g,y=g+b,C=(y%2===0?y:y+1)/2;s[1+C]=f,o[1+C]=u+1;let E,S,R,$,I;for(E=0;E<=C;++E){for(S=-E;S<=E;S+=2){for(R=S+C,S===-E||S!==E&&s[R-1]<s[R+1]?s[R]=s[R+1]:s[R]=s[R-1]+1,$=s[R],I=$-f+d-S;$<u&&I<p&&e[$]===t[I];)s[R]=++$,++I;if(h%2!==0&&h-E<=S&&S<=h+E&&o[R-h]<=s[R])return i(o[R-h],S+f-d,u,p)}for(S=h-E;S<=h+E;S+=2){for(R=S+C-h,S===h-E||S!==h+E&&o[R+1]<=o[R-1]?o[R]=o[R+1]-1:o[R]=o[R-1],$=o[R]-1,I=$-f+d-S;$>=f&&I>=d&&e[$]===t[I];)o[R]=$--,I--;if(h%2===0&&-E<=S&&S<=E&&o[R]<=s[R+h])return i(o[R],S+f-d,u,p)}}return null},c=[];return a(0,e.length,0,t.length,c),c},ky=e=>H(e)?e.outerHTML:P(e)?Ns.encodeRaw(e.data,!1):ws(e)?"<!--"+e.data+"-->":"",d$=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},m$=(e,t,n)=>{const s=d$(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},g$=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];e.removeChild(n)}},p$=(e,t)=>{let n=0;B(e,s=>{s[0]===ld?n++:s[0]===Sy?(m$(t,s[1],n),n++):s[0]===wy&&g$(t,n)})},h$=e=>oe(ve(jt(e.childNodes),ky),t=>t.length>0),b$=(e,t)=>{const n=ve(jt(t.childNodes),ky);return p$(f$(n,e),t),t},v$=Ys(()=>document.implementation.createHTMLDocument("undo")),C$=e=>e.indexOf("</iframe>")!==-1,y$=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),E$=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),Sl=e=>{const t=h$(e.getBody()),n=Fn(t,o=>{const r=ov(e.serializer,o);return r.length>0?[r]:[]}),s=n.join("");return C$(s)?y$(n):E$(s)},cd=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?b$(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:z(s)&&Wh(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},ud=e=>e.type==="fragmented"?e.fragments.join(""):e.content,xy=e=>{const t=v.fromTag("body",v$());return mi(t,ud(e)),B(kt(t,"*[data-mce-bogus]"),cs),Dg(t)},S$=(e,t)=>ud(e)===ud(t),w$=(e,t)=>xy(e)===xy(t),fd=(e,t)=>!e||!t?!1:S$(e,t)?!0:w$(e,t),dd=e=>e.get()===0,wl=(e,t,n)=>{dd(n)&&(e.typing=t)},Ny=(e,t)=>{e.typing&&(wl(e,!1,t),e.add())},k$=e=>{e.typing&&(e.typing=!1,e.add())},x$=(e,t,n)=>{dd(t)&&n.set(pu(e.selection))},N$=(e,t,n,s,o,r,a)=>{const i=Sl(e),l=L.extend(r||{},i);if(!dd(s)||e.removed)return null;const c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:l,lastLevel:c,originalEvent:a}).isDefaultPrevented()||c&&fd(c,l))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});const f=dR(e);if(f&&t.data.length>f){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}l.bookmark=pu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(l),n.set(t.data.length-1);const u={level:l,lastLevel:c,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",u),e.dispatch("change",u)):e.dispatch("AddUndo",u),l},_$=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},A$=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];cd(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},R$=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],cd(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},T$=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,wl(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],cd(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},P$=e=>{e.clear(),e.add()},D$=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!fd(Sl(e),t.data[0]),B$=(e,t)=>t.get()<e.data.length-1&&!e.typing,O$=(e,t,n)=>(Ny(e,t),e.beforeChange(),e.ignore(n),e.add()),I$=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},L$=(e,t)=>{const n=e.dom,s=z(t)?t:e.getBody();B(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=bR(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,l=Ch(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},_y=e=>({init:{bindEvents:de},undoManager:{beforeChange:(t,n)=>x$(e,t,n),add:(t,n,s,o,r,a)=>N$(e,t,n,s,o,r,a),undo:(t,n,s)=>T$(e,t,n,s),redo:(t,n)=>R$(e,t,n),clear:(t,n)=>_$(e,t,n),reset:t=>P$(t),hasUndo:(t,n)=>D$(e,t,n),hasRedo:(t,n)=>B$(t,n),transact:(t,n,s)=>O$(t,n,s),ignore:(t,n)=>I$(t,n),extra:(t,n,s,o)=>A$(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>Uf(e,t,n,s,o),matchAll:(t,n)=>KO(e,t,n),matchNode:(t,n,s,o)=>Xn(e,t,n,s,o),canApply:t=>YO(e,t),closest:t=>GO(e,t),apply:(t,n,s)=>LC(e,t,n,s),remove:(t,n,s,o)=>BC(e,t,n,s,o),toggle:(t,n,s)=>DI(e,t,n,s),formatChanged:(t,n,s,o,r)=>PI(e,t,n,s,o,r)},editor:{getContent:t=>ED(e,t),setContent:(t,n)=>VO(e,t,n),insertContent:(t,n)=>MO(e,t,n),addVisual:t=>L$(e,t)},selection:{getContent:(t,n)=>u$(e,t,n)},autocompleter:{addDecoration:t=>cD(e,t),removeDecoration:()=>fD(e,v.fromDom(e.getBody()))},raw:{getModel:()=>m.none()}}),$$=e=>{const t=c=>Ye(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,f,u)=>s.transact(u),ignore:(c,f)=>s.ignore(f),extra:(c,f,u,d)=>s.extra(u,d)},formatter:{match:(c,f,u,d)=>o.match(c,t(f),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,f,u)=>o.apply(c,t(f)),remove:(c,f,u,d)=>o.remove(c,t(f)),toggle:(c,f,u)=>o.toggle(c,t(f)),formatChanged:(c,f,u,d,p)=>o.formatChanged(f,u,d,p)},editor:{getContent:c=>r.getContent(c),setContent:(c,f)=>({content:r.setContent(c,f),html:""}),insertContent:(c,f)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,f)=>a.getContent(f)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(l.getRawModel())}}},F$=()=>{const e=K(null),t=K("");return{init:{bindEvents:de},undoManager:{beforeChange:de,add:e,undo:e,redo:e,clear:de,reset:de,hasUndo:ze,hasRedo:ze,transact:e,ignore:de,extra:de},formatter:{match:ze,matchAll:K([]),matchNode:K(void 0),canApply:ze,closest:t,apply:de,remove:de,toggle:de,formatChanged:K({unbind:de})},editor:{getContent:t,setContent:K({content:"",html:""}),insertContent:K(""),addVisual:de},selection:{getContent:t},autocompleter:{addDecoration:de,removeDecoration:de},raw:{getModel:K(m.none())}}},Zn=e=>le(e.plugins,"rtc"),M$=e=>Oe(e.plugins,"rtc").bind(t=>m.from(t.setup)),U$=e=>{const t=e;return M$(e).fold(()=>(t.rtcInstance=_y(e),m.none()),n=>(t.rtcInstance=F$(),m.some(()=>n().then(s=>(t.rtcInstance=$$(s),s.rtc.isRemote)))))},md=e=>e.rtcInstance?e.rtcInstance:_y(e),je=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},z$=(e,t,n)=>{je(e).undoManager.beforeChange(t,n)},H$=(e,t,n,s,o,r,a)=>je(e).undoManager.add(t,n,s,o,r,a),V$=(e,t,n,s)=>je(e).undoManager.undo(t,n,s),W$=(e,t,n)=>je(e).undoManager.redo(t,n),j$=(e,t,n)=>{je(e).undoManager.clear(t,n)},q$=(e,t)=>{je(e).undoManager.reset(t)},K$=(e,t,n)=>je(e).undoManager.hasUndo(t,n),G$=(e,t,n)=>je(e).undoManager.hasRedo(t,n),Y$=(e,t,n,s)=>je(e).undoManager.transact(t,n,s),X$=(e,t,n)=>{je(e).undoManager.ignore(t,n)},Q$=(e,t,n,s,o)=>{je(e).undoManager.extra(t,n,s,o)},Z$=(e,t,n,s,o)=>je(e).formatter.match(t,n,s,o),J$=(e,t,n)=>je(e).formatter.matchAll(t,n),eF=(e,t,n,s,o)=>je(e).formatter.matchNode(t,n,s,o),tF=(e,t)=>je(e).formatter.canApply(t),nF=(e,t)=>je(e).formatter.closest(t),sF=(e,t,n,s)=>{je(e).formatter.apply(t,n,s)},oF=(e,t,n,s,o)=>{je(e).formatter.remove(t,n,s,o)},rF=(e,t,n,s)=>{je(e).formatter.toggle(t,n,s)},aF=(e,t,n,s,o,r)=>je(e).formatter.formatChanged(t,n,s,o,r),iF=(e,t)=>md(e).editor.getContent(t),lF=(e,t,n)=>md(e).editor.setContent(t,n),cF=(e,t,n)=>md(e).editor.insertContent(t,n),uF=(e,t,n)=>je(e).selection.getContent(t,n),fF=(e,t)=>je(e).editor.addVisual(t),Ay=e=>je(e).init.bindEvents(),dF=(e,t)=>je(e).autocompleter.addDecoration(t),mF=e=>je(e).autocompleter.removeDecoration(),gF=(e,t={})=>{const n=t.format?t.format:"html";return uF(e,n,t)},Ry=e=>e.dom.length===0?(Fe(e),m.none()):m.some(e),pF=(e,t)=>e.filter(n=>Ca.isBookmarkNode(n.dom)).bind(t?Wr:Qs),hF=(e,t,n,s)=>{const o=e.dom,r=t.dom,a=s?o.length:r.length;s?(vf(o,r,!1,!s),n.setStart(r,a)):(vf(r,o,!1,!s),n.setEnd(r,a))},bF=(e,t)=>{kn(e).each(n=>{const s=e.dom;t&&ka(n,A(s,0))?ll(s,0):!t&&xa(n,A(s,s.length))&&bf(s,s.length)})},Ty=(e,t,n,s)=>{e.bind(o=>((s?bf:ll)(o.dom,s?o.dom.length:0),t.filter(Zt).map(a=>hF(o,a,n,s)))).orThunk(()=>pF(t,s).or(t).filter(Zt).map(r=>bF(r,s)))},vF=(e,t)=>{const n=m.from(t.firstChild).map(v.fromDom),s=m.from(t.lastChild).map(v.fromDom);e.deleteContents(),e.insertNode(t);const o=n.bind(Qs).filter(Zt).bind(Ry),r=s.bind(Wr).filter(Zt).bind(Ry);Ty(o,n,e,!0),Ty(r,s,e,!1),e.collapse(!1)},CF=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),yF=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return Bs({validate:!1},e.schema).serialize(r)}else return t.content},EF=(e,t,n={})=>{const s=CF(n,t);rd(e,s).each(o=>{const r=yF(e,o),a=e.selection.getRng();vF(a,a.createContextualFragment(r)),e.selection.setRng(a),Ea(e,a),ad(e,r,o)})},Py=(e,t,n)=>{if(le(e,t)){const s=oe(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var SF=(e,t)=>{let n,s;const o=(i,l)=>rt(l,c=>e.is(c,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{const l=i.element,c=r(l),f={};Pe(n,(u,d)=>{o(d,c).each(p=>{s[d]||(B(u,b=>{b(!0,{node:p,selector:d,parents:c})}),s[d]=u),f[d]=u})}),Pe(s,(u,d)=>{f[d]||(delete s[d],B(u,p=>{p(!1,{node:l,selector:d,parents:c})}))})})};return{selectorChangedWithUnbind:(i,l)=>(n||a(),n[i]||(n[i]=[]),n[i].push(l),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{Py(n,i,l),Py(s,i,l)}})}};const Dy=e=>!!(e&&e.ownerDocument)&&as(v.fromDom(e.ownerDocument),v.fromDom(e)),wF=e=>e?Dy(e.startContainer)&&Dy(e.endContainer):!1,By=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=SF(e,s),i=(D,j)=>{const me=e.createRng();z(D)&&z(j)?(me.setStart(D,j),me.setEnd(D,j),S(me),y(!1)):(Iu(e,me,s.getBody(),!0),S(me))},l=D=>gF(s,D),c=(D,j)=>EF(s,D,j),f=D=>Xb(s.getBody(),E(),D),u=D=>Qb(s.getBody(),E(),D),d=(D,j)=>pt.getBookmark(D,j),p=D=>pt.moveToBookmark(D),b=(D,j)=>(tD(e,D,j).each(S),D),g=()=>{const D=E(),j=C();return!D||D.item?!1:D.compareEndPoints?D.compareEndPoints("StartToEnd",D)===0:!j||D.collapsed},h=()=>{const D=E(),j=s.getBody().querySelectorAll('[data-mce-selected="1"]');return j.length>0?vs(j,me=>e.isEditable(me.parentElement)):D.startContainer===D.endContainer?e.isEditable(D.startContainer):e.isEditable(D.startContainer)&&e.isEditable(D.endContainer)},y=D=>{const j=E();j.collapse(!!D),S(j)},C=()=>t.getSelection?t.getSelection():t.document.selection,E=()=>{let D;const j=(F,Z,ee)=>{try{return Z.compareBoundaryPoints(F,ee)}catch{return-1}},me=t.document;if(z(s.bookmark)&&!So(s)){const F=ef(s);if(F.isSome())return F.map(Z=>af(s,[Z])[0]).getOr(me.createRange())}try{const F=C();F&&!pi(F.anchorNode)&&(F.rangeCount>0?D=F.getRangeAt(0):D=me.createRange(),D=af(s,[D])[0])}catch{}if(D||(D=me.createRange()),Gr(D.startContainer)&&D.collapsed){const F=e.getRoot();D.setStart(F,0),D.setEnd(F,0)}return o&&r&&(j(D.START_TO_START,D,o)===0&&j(D.END_TO_END,D,o)===0?D=r:(o=null,r=null)),D},S=(D,j)=>{if(!wF(D))return;const me=C();if(D=s.dispatch("SetSelectionRange",{range:D,forward:j}).range,me){r=D;try{me.removeAllRanges(),me.addRange(D)}catch{}j===!1&&me.extend&&(me.collapse(D.endContainer,D.endOffset),me.extend(D.startContainer,D.startOffset)),o=me.rangeCount>0?me.getRangeAt(0):null}if(!D.collapsed&&D.startContainer===D.endContainer&&(me!=null&&me.setBaseAndExtent)&&D.endOffset-D.startOffset<2&&D.startContainer.hasChildNodes()){const Z=D.startContainer.childNodes[D.startOffset];Z&&Z.nodeName==="IMG"&&(me.setBaseAndExtent(D.startContainer,D.startOffset,D.endContainer,D.endOffset),(me.anchorNode!==D.startContainer||me.focusNode!==D.endContainer)&&me.setBaseAndExtent(Z,0,Z,1))}s.dispatch("AfterSetSelectionRange",{range:D,forward:j})},R=D=>(c(e.getOuterHTML(D)),D),$=()=>JP(s.getBody(),E()),I=(D,j)=>eD(e,E(),D,j),N=()=>{const D=C(),j=D==null?void 0:D.anchorNode,me=D==null?void 0:D.focusNode;if(!D||!j||!me||pi(j)||pi(me))return!0;const F=e.createRng(),Z=e.createRng();try{F.setStart(j,D.anchorOffset),F.collapse(!0),Z.setStart(me,D.focusOffset),Z.collapse(!0)}catch{return!0}return F.compareBoundaryPoints(F.START_TO_START,Z)<=0},$e={dom:e,win:t,serializer:n,editor:s,expand:(D={type:"word"})=>S(Eo(e).expand(E(),D)),collapse:y,setCursorLocation:i,getContent:l,setContent:c,getBookmark:d,moveToBookmark:p,select:b,isCollapsed:g,isEditable:h,isForward:N,setNode:R,getNode:$,getSel:C,setRng:S,getRng:E,getStart:f,getEnd:u,getSelectedBlocks:I,normalize:()=>{const D=E(),j=C();if(!MT(j)&&Gi(s)){const me=nl(e,D);return me.each(F=>{S(F,N())}),me.getOr(D)}return D},selectorChanged:(D,j)=>(a(D,j),$e),selectorChangedWithUnbind:a,getScrollContainer:()=>{let D,j=e.getRoot();for(;j&&j.nodeName!=="BODY";){if(j.scrollHeight>j.clientHeight){D=j;break}j=j.parentNode}return D},scrollIntoView:(D,j)=>{z(D)?SP(s,D,j):Ea(s,E(),j)},placeCaretAt:(D,j)=>S(Rb(D,j,s.getDoc())),getBoundingClientRect:()=>{const D=E();return D.collapsed?A.fromRangeStart(D).getClientRects()[0]:D.getBoundingClientRect()},destroy:()=>{t=o=r=null,Ze.destroy()}},pt=Ca($e),Ze=kb($e,s);return $e.bookmarkManager=pt,$e.controlSelection=Ze,$e},kF=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let l=s.length;for(;l--;){const c=s[l];let f=c.attr(r);f!==void 0?(c.attr(o,f.length>0?f:null),c.attr(r,null)):(f=c.attr(o),o==="style"?f=n.serializeStyle(n.parseStyle(f),c.name):a&&(f=a.call(i,f,o,c.name)),c.attr(o,f.length>0?f:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(c=>{var f;return!Si((f=c.value)!==null&&f!==void 0?f:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("noscript",s=>{var o;let r=s.length;for(;r--;){const a=s[r].firstChild;a&&(a.value=Ns.decode((o=a.value)!==null&&o!==void 0?o:""))}}),e.addNodeFilter("script,style",(s,o)=>{var r;const a=l=>l.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let i=s.length;for(;i--;){const l=s[i],c=l.firstChild,f=(r=c==null?void 0:c.value)!==null&&r!==void 0?r:"";if(o==="script"){const u=l.attr("type");u&&l.attr("type",u==="mce-no/type"?null:u.replace(/^mce\-/,"")),t.element_format==="xhtml"&&c&&f.length>0&&(c.value=`// <![CDATA[
`+a(f)+`
// ]]>`)}else t.element_format==="xhtml"&&c&&f.length>0&&(c.value=`<!--
`+a(f)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o],a=r.value;t.preserve_cdata&&(a==null?void 0:a.indexOf("[CDATA["))===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(a==null?void 0:a.indexOf("mce:protected "))===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{B(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)})},xF=e=>{const t=s=>(s==null?void 0:s.name)==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},NF=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");L.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return u1(e,{...n,node:r}),s&&(o.doc=s),r},_F=(e,t)=>z(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,AF=(e,t,n)=>_F(e,n)?NF(e,t,n):t,RF=(e,t,n)=>{L.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},TF=(e,t,n)=>!t.no_events&&e?f1(e,{...t,content:n}).content:n,PF=(e,t,n)=>{const s=fs(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||yi(v.fromDom(t))?s:L.trim(s)},DF=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return xF(o),o},BF=(e,t,n)=>Bs(e,t).serialize(n),OF=(e,t,n,s,o)=>{const r=BF(t,n,s);return TF(e,o,r)},IF=(e,t)=>{const n=["data-mce-selected"],s=t&&t.dom?t.dom:_e.DOM,o=t&&t.schema?t.schema:_s(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs="remove_trailing_brs"in e?e.remove_trailing_brs:!0;const r=pr(e,o);kF(r,e,s);const a=(i,l={})=>{const c={format:"html",...l},f=AF(t,i,c),u=PF(s,f,c),d=DF(r,u,c);return c.format==="tree"?d:OF(t,e,o,d,c)};return{schema:o,addNodeFilter:r.addNodeFilter,addAttributeFilter:r.addAttributeFilter,serialize:a,addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:G(RF,r,n),getTempAttrs:K(n),getNodeFilters:r.getNodeFilters,getAttributeFilters:r.getAttributeFilters,removeNodeFilter:r.removeNodeFilter,removeAttributeFilter:r.removeAttributeFilter}},Oy=(e,t)=>{const n=IF(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},LF="html",$F=(e,t)=>({...e,format:t,get:!0,getInner:!0}),FF=(e,t={})=>{const n=t.format?t.format:LF,s=$F(t,n);return my(e,s).fold(Dt,o=>{const r=iF(e,o);return gy(e,r,o)})},MF="html",UF=(e,t)=>({format:MF,...e,set:!0,content:t}),gd=(e,t,n={})=>{const s=UF(n,t);return rd(e,s).map(o=>{const r=lF(e,o.content,o);return ad(e,r.html,o),r.content}).getOr(t)},zF="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),HF="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),VF="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),Iy=[{name:"template",replacedWith:"Advanced Template"}],Ly=(e,t)=>{const n=oe(t,s=>le(e,s));return qs(n)},WF=e=>{const t=Ly(e,zF),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),qs(t)},jF=e=>Ly(e,HF),$y=(e,t)=>{const n=L.makeMap(e.plugins," "),o=oe(t,r=>le(n,r));return qs(o)},qF=e=>$y(e,VF),KF=e=>$y(e,Iy.map(t=>t.name)),GF=(e,t)=>{const n=WF(e),s=qF(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",f=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+l+c+f)}},YF=e=>rt(Iy,t=>t.name===e).fold(()=>e,t=>`${e}, replaced by ${t.replacedWith}`),XF=(e,t)=>{const n=jF(e),s=KF(t),o=s.length>0,r=n.length>0;if(o||r){const a=`
- `,i=o?`

Plugins:${a}${s.map(YF).join(a)}`:"",l=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+l)}},QF=(e,t)=>{GF(e,t),XF(e,t)},kl=_e.DOM,ZF=e=>{kl.setStyle(e.id,"display",e.orgDisplay)},xl=e=>m.from(e).each(t=>t.destroy()),JF=e=>{const t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;const n=e.selection;if(n){const s=n.dom;t.selection=n.win=n.dom=s.doc=null}},eM=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),kl.unbind(t,"submit reset",e.formEventDelegate))},tM=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&z(o==null?void 0:o.nextSibling)&&kl.remove(o.nextSibling),d1(e),e.editorManager.remove(e),!e.inline&&s&&ZF(e),m1(e),kl.remove(e.getContainer()),xl(t),xl(n),e.destroy()}},nM=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),xl(n),xl(s)),eM(e),JF(e),e.destroyed=!0}},Nl=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>le(e,o)}})(),hr=Nt.ModelManager,Fy=(e,t)=>t.dom[e],My=(e,t)=>parseInt(Hn(t,e),10),sM=G(Fy,"clientWidth"),oM=G(Fy,"clientHeight"),rM=G(My,"margin-top"),aM=G(My,"margin-left"),iM=e=>e.dom.getBoundingClientRect(),lM=(e,t,n)=>{const s=sM(e),o=oM(e);return t>=0&&n>=0&&t<=s&&n<=o},cM=(e,t,n,s)=>{const o=iM(t),r=e?o.left+t.dom.clientLeft+aM(t):0,a=e?o.top+t.dom.clientTop+rM(t):0,i=n-r,l=s-a;return{x:i,y:l}},uM=(e,t,n)=>{const s=v.fromDom(e.getBody()),o=e.inline?s:kx(s),r=cM(e.inline,o,t,n);return lM(o,r.x,r.y)},fM=e=>m.from(e).map(v.fromDom),dM=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return fM(t).map(Go).getOr(!1)};var mM=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};const Uy=e=>{const t=[],n=()=>{const d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():mM()},s=()=>m.from(t[0]),o=(d,p)=>d.type===p.type&&d.text===p.text&&!d.progressBar&&!d.timeout&&!p.progressBar&&!p.timeout,r=()=>{B(t,d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{Dr(t,p=>p===d).each(p=>{t.splice(p,1)})},l=(d,p=!0)=>e.removed||!dM(e)?{}:(p&&e.dispatch("BeforeOpenNotification",{notification:d}),rt(t,b=>o(n().getArgs(b),d)).getOrThunk(()=>{e.editorManager.setActive(e);const b=n().open(d,()=>{i(b),r(),s().fold(()=>e.focus(),g=>Hb(v.fromDom(g.getEl())))});return a(b),r(),e.dispatch("OpenNotification",{notification:{...b}}),b})),c=()=>{s().each(d=>{n().close(d),i(d),r()})},f=K(t);return(d=>{d.on("SkinLoaded",()=>{const p=eR(d);p&&l({text:p,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{B(t.slice(),p=>{n().close(p)})})})(e),{open:l,close:c,getNotifications:f}},br=Nt.PluginManager,Ro=Nt.ThemeManager;var gM=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};const zy=e=>{let t=[];const n=()=>{const g=e.theme;return g&&g.getWindowManagerImpl?g.getWindowManagerImpl():gM()},s=(g,h)=>(...y)=>h?h.apply(g,y):void 0,o=g=>{e.dispatch("OpenWindow",{dialog:g})},r=g=>{e.dispatch("CloseWindow",{dialog:g})},a=g=>{t.push(g),o(g)},i=g=>{r(g),t=oe(t,h=>h!==g),t.length===0&&e.focus()},l=()=>m.from(t[t.length-1]),c=g=>{e.editorManager.setActive(e),Ju(e),e.ui.show();const h=g();return a(h),h},f=(g,h)=>c(()=>n().open(g,h,i)),u=g=>c(()=>n().openUrl(g,i)),d=(g,h,y)=>{const C=n();C.alert(g,s(y||C,h))},p=(g,h,y)=>{const C=n();C.confirm(g,s(y||C,h))},b=()=>{l().each(g=>{n().close(g),i(g)})};return e.on("remove",()=>{B(t,g=>{n().close(g)})}),{open:f,openUrl:u,alert:d,confirm:p,close:b}},Hy=(e,t)=>{e.notificationManager.open({type:"error",text:t})},_l=(e,t)=>{e._skinLoaded?Hy(e,t):e.on("SkinLoaded",()=>{Hy(e,t)})},pM=(e,t)=>{_l(e,_n.translate(["Failed to upload image: {0}",t]))},Pa=(e,t,n)=>{bb(e,t,{message:n}),console.error(n)},Da=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,hM=(e,t,n)=>{Pa(e,"PluginLoadError",Da("plugin",t,n))},bM=(e,t,n)=>{Pa(e,"IconsLoadError",Da("icons",t,n))},vM=(e,t,n)=>{Pa(e,"LanguageLoadError",Da("language",t,n))},CM=(e,t,n)=>{Pa(e,"ThemeLoadError",Da("theme",t,n))},yM=(e,t,n)=>{Pa(e,"ModelLoadError",Da("model",t,n))},EM=(e,t,n)=>{const s=_n.translate(["Failed to initialize plugin: {0}",t]);bb(e,"PluginLoadError",{message:s}),Al(s,n),_l(e,s)},Al=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},SM=e=>/^[a-z0-9\-]+$/i.test(e),wM=e=>Vy(e,GA(e)),kM=e=>Vy(e,gh(e)),Vy=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return ve(t,r=>SM(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},xM=e=>{e.contentCSS=e.contentCSS.concat(wM(e),kM(e))},NM=e=>e?jt(e.getElementsByTagName("img")):[],_M=(e,t)=>{const n={};return{findAll:(o,r=et)=>{const a=oe(NM(o),l=>{const c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===be.transparentSrc?!1:bt(c,"blob:")?!e.isUploaded(c)&&r(l):bt(c,"data:")?r(l):!1}),i=ve(a,l=>{const c=l.src;if(le(n,c))return n[c].then(f=>q(f)?f:{image:l,blobInfo:f.blobInfo});{const f=WI(t,c).then(u=>(delete n[c],{image:l,blobInfo:u})).catch(u=>(delete n[c],u));return n[c]=f,f}});return Promise.all(i)}}},Wy=()=>{let n={};const s=(d,p)=>({status:d,resultUri:p}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{const p=n[d];return p?p.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,p)=>{n[d]=s(2,p)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}};let AM=0;const RM=()=>{const e=()=>Math.round(Math.random()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},TM=e=>e+AM+++RM(),PM=()=>{let e=[];const t=u=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[u.toLowerCase()]||"dat",n=(u,d,p,b,g)=>{if(q(u))return s({id:u,name:b,filename:g,blob:d,base64:p});if(Ye(u))return s(u);throw new Error("Unknown input type")},s=u=>{if(!u.blob||!u.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const d=u.id||TM("blobid"),p=u.name||d,b=u.blob;return{id:K(d),name:K(p),filename:K(u.filename||p+"."+t(b.type)),blob:K(b),base64:K(u.base64),blobUri:K(u.blobUri||URL.createObjectURL(b)),uri:K(u.uri)}},o=u=>{a(u.id())||e.push(u)},r=u=>rt(e,u).getOrUndefined(),a=u=>r(d=>d.id()===u);return{create:n,add:o,get:a,getByUri:u=>r(d=>d.blobUri()===u),getByData:(u,d)=>r(p=>p.base64()===u&&p.blob().type===d),findFirst:r,removeByUri:u=>{e=oe(e,d=>d.blobUri()===u?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{B(e,u=>{URL.revokeObjectURL(u.blobUri())}),e=[]}}},DM=(e,t)=>{const n={},s=(g,h)=>g?g.replace(/\/$/,"")+"/"+h.replace(/^\//,""):h,o=(g,h)=>new Promise((y,C)=>{const E=new XMLHttpRequest;E.open("POST",t.url),E.withCredentials=t.credentials,E.upload.onprogress=R=>{h(R.loaded/R.total*100)},E.onerror=()=>{C("Image upload failed due to a XHR Transport error. Code: "+E.status)},E.onload=()=>{if(E.status<200||E.status>=300){C("HTTP Error: "+E.status);return}const R=JSON.parse(E.responseText);if(!R||!q(R.location)){C("Invalid JSON: "+E.responseText);return}y(s(t.basePath,R.location))};const S=new FormData;S.append("file",g.blob(),g.filename()),E.send(S)}),r=Ce(t.handler)?t.handler:o,a=()=>new Promise(g=>{g([])}),i=(g,h)=>({url:h,blobInfo:g,status:!0}),l=(g,h)=>({url:"",blobInfo:g,status:!1,error:h}),c=(g,h)=>{L.each(n[g],y=>{y(h)}),delete n[g]},f=(g,h,y)=>(e.markPending(g.blobUri()),new Promise(C=>{let E,S;try{const R=()=>{E&&(E.close(),S=de)},$=N=>{R(),e.markUploaded(g.blobUri(),N),c(g.blobUri(),i(g,N)),C(i(g,N))},I=N=>{R(),e.removeFailed(g.blobUri()),c(g.blobUri(),l(g,N)),C(l(g,N))};S=N=>{N<0||N>100||m.from(E).orThunk(()=>m.from(y).map(pc)).each(x=>{E=x,x.progressBar.value(N)})},h(g,S).then($,N=>{I(q(N)?{message:N}:N)})}catch(R){C(l(g,R))}})),u=g=>g===o,d=g=>{const h=g.blobUri();return new Promise(y=>{n[h]=n[h]||[],n[h].push(y)})},p=(g,h)=>(g=L.grep(g,y=>!e.isUploaded(y.blobUri())),Promise.all(L.map(g,y=>e.isPending(y.blobUri())?d(y):f(y,r,h))));return{upload:(g,h)=>!t.url&&u(r)?a():p(g,h)}},jy=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),qy=(e,t)=>DM(t,{url:zA(e),basePath:HA(e),credentials:VA(e),handler:WA(e)}),BM=e=>{const t=Wy(),n=qy(e,t);return{upload:(s,o=!0)=>n.upload(s,o?jy(e):void 0)}},OM=e=>{const t=PM();let n,s;const o=Wy(),r=[],a=E=>S=>e.selection?E(S):[],i=E=>E+(E.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(E,S,R)=>{let $=0;do $=E.indexOf(S,$),$!==-1&&(E=E.substring(0,$)+R+E.substr($+S.length),$+=R.length-S.length+1);while($!==-1);return E},c=(E,S,R)=>{const $=`src="${R}"${R===be.transparentSrc?' data-mce-placeholder="1"':""}`;return E=l(E,`src="${S}"`,$),E=l(E,'data-mce-src="'+S+'"','data-mce-src="'+R+'"'),E},f=(E,S)=>{B(e.undoManager.data,R=>{R.type==="fragmented"?R.fragments=ve(R.fragments,$=>c($,E,S)):R.content=c(R.content,E,S)})},u=(E,S)=>{const R=e.convertURL(S,"src");f(E.src,S),ys(v.fromDom(E),{src:uh(e)?i(S):S,"data-mce-src":R})},d=()=>(n||(n=qy(e,o)),h().then(a(E=>{const S=ve(E,R=>R.blobInfo);return n.upload(S,jy(e)).then(a(R=>{const $=[];let I=!1;const N=ve(R,(x,U)=>{const{blobInfo:X,image:J}=E[U];let re=!1;return x.status&&MA(e)?(x.url&&!wt(J.src,x.url)&&(I=!0),t.removeByUri(J.src),Zn(e)||u(J,x.url)):x.error&&(x.error.remove&&(f(J.src,be.transparentSrc),$.push(J),re=!0),pM(e,x.error.message)),{element:J,status:x.status,uploadUri:x.url,blobInfo:X,removed:re}});return $.length>0&&!Zn(e)?e.undoManager.transact(()=>{B($,x=>{e.dom.remove(x),t.removeByUri(x.src)})}):I&&e.undoManager.dispatchChange(),N}))}))),p=()=>ch(e)?d():Promise.resolve([]),b=E=>vs(r,S=>S(E)),g=E=>{r.push(E)},h=()=>(s||(s=_M(o,t)),s.findAll(e.getBody(),b).then(a(E=>{const S=oe(E,R=>q(R)?(_l(e,R),!1):!0);return Zn(e)||B(S,R=>{f(R.image.src,R.blobInfo.blobUri()),R.image.src=R.blobInfo.blobUri(),R.image.removeAttribute("data-mce-src")}),S}))),y=()=>{t.destroy(),o.destroy(),s=n=null},C=E=>E.replace(/src="(blob:[^"]+)"/g,(S,R)=>{const $=o.getResultUri(R);if($)return'src="'+$+'"';let I=t.getByUri(R);return I||(I=Wt(e.editorManager.get(),(N,x)=>N||x.editorUpload&&x.editorUpload.blobCache.getByUri(R),void 0)),I?'src="data:'+I.blob().type+";base64,"+I.base64()+'"':S});return e.on("SetContent",()=>{ch(e)?p():h()}),e.on("RawSaveContent",E=>{E.content=C(E.content)}),e.on("GetContent",E=>{E.source_view||E.format==="raw"||E.format==="tree"||(E.content=C(E.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",E=>{B(E,S=>{const R=S.attr("src");if(!R||t.getByUri(R))return;const $=o.getResultUri(R);$&&S.attr("src",$)})})}),{blobCache:t,addFilter:g,uploadImages:d,uploadImagesAuto:p,scanForImages:h,destroy:y}},IM=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>H(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{L.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return L.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},Ky={remove_similar:!0,inherit:!1},vr={selector:"td,th",...Ky},LM={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...vr},tablecellverticalalign:{styles:{"vertical-align":"%value"},...vr},tablecellbordercolor:{styles:{borderColor:"%value"},...vr},tablecellclass:{classes:["%value"],...vr},tableclass:{selector:"table",classes:["%value"],...Ky},tablecellborderstyle:{styles:{borderStyle:"%value"},...vr},tablecellborderwidth:{styles:{borderWidth:"%value"},...vr}},$M=K(LM),FM=e=>{const t={},n=a=>z(a)?t[a]:t,s=a=>le(t,a),o=(a,i)=>{a&&(q(a)?(ot(i)||(i=[i]),B(i,l=>{Pt(l.deep)&&(l.deep=!an(l)),Pt(l.split)&&(l.split=!an(l)||lt(l)),Pt(l.remove)&&an(l)&&!lt(l)&&(l.remove="none"),an(l)&&lt(l)&&(l.mixed=!0,l.block_expand=!0),q(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Pe(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(IM(e)),o($M()),o(sR(e)),{get:n,has:s,register:o,unregister:r}},Rl=L.each,un=_e.DOM,pd=e=>z(e)&&Ye(e),Gy=(e,t)=>{const n=t&&t.schema||_s({}),s=(l,c)=>{c.classes.length>0&&un.addClass(l,c.classes.join(" ")),un.setAttribs(l,c.attrs)},o=l=>{const c=q(l)?{name:l,classes:[],attrs:{}}:l,f=un.create(c.name);return s(f,c),f},r=(l,c)=>{const f=n.getElementRule(l.nodeName.toLowerCase()),u=f==null?void 0:f.parentsRequired;return u&&u.length?c&&Te(u,c)?c:u[0]:!1},a=(l,c,f)=>{let u;const d=c[0],p=pd(d)?d.name:void 0,b=r(l,p);if(b)p===b?(u=d,c=c.slice(1)):u=b;else if(d)u=d,c=c.slice(1);else if(!f)return l;const g=u?o(u):un.create("div");g.appendChild(l),f&&L.each(f,y=>{const C=o(y);g.insertBefore(C,l)});const h=pd(u)?u.siblings:void 0;return a(g,c,h)},i=un.create("div");if(e.length>0){const l=e[0],c=o(l),f=pd(l)?l.siblings:void 0;i.appendChild(a(c,e.slice(1),f))}return i},MM=e=>{e=L.trim(e);let t="div";const n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":L.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},UM=e=>q(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),L.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=L.map(t.split(/(?:~\+|~|\+)/),MM),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],zM=(e,t)=>{let n="",s=oR(e);if(s==="")return"";const o=d=>q(d)?d.replace(/%(\w+)/g,""):"",r=(d,p)=>un.getStyle(p??e.getBody(),d,!0);if(q(t)){const d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){const d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i;const l=UM(t.selector);l.length>0?(l[0].name||(l[0].name=a),a=t.selector,i=Gy(l,e)):i=Gy([a],e);const c=un.select(a,i)[0]||i.firstChild;Rl(t.styles,(d,p)=>{const b=o(d);b&&un.setStyle(c,p,b)}),Rl(t.attributes,(d,p)=>{const b=o(d);b&&un.setAttrib(c,p,b)}),Rl(t.classes,d=>{const p=o(d);un.hasClass(c,p)||un.addClass(c,p)}),e.dispatch("PreviewFormats"),un.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);const f=r("fontSize"),u=/px$/.test(f)?parseInt(f,10):0;return Rl(s.split(" "),d=>{let p=r(d,c);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(p)&&(p=r(d),Ki(p).toLowerCase()==="#ffffff"))&&!(d==="color"&&Ki(p).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(p)){if(u===0)return;p=parseFloat(p)/(/%$/.test(p)?100:1)*u+"px"}d==="border"&&p&&(n+="padding:0 2px;"),n+=d+":"+p+";"}}),e.dispatch("AfterPreviewFormats"),un.remove(i),n},HM=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},Yy=e=>{const t=FM(e),n=ct({});return HM(e),rI(e),Zn(e)||AI(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{sF(e,s,o,r)},remove:(s,o,r,a)=>{oF(e,s,o,r,a)},toggle:(s,o,r)=>{rF(e,s,o,r)},match:(s,o,r,a)=>Z$(e,s,o,r,a),closest:s=>nF(e,s),matchAll:(s,o)=>J$(e,s,o),matchNode:(s,o,r,a)=>eF(e,s,o,r,a),canApply:s=>tF(e,s),formatChanged:(s,o,r,a)=>aF(e,n,s,o,r,a),getCssText:G(zM,e)}},Xy=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},VM=(e,t,n)=>{const s=ct(!1),o=l=>{wl(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{const c=l.command;Xy(c)||(Ny(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{const c=l.command;Xy(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{const c=l.keyCode;l.isDefaultPrevented()||((c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&!fd(Sl(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged()))}),e.on("keydown",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}const f=l.ctrlKey&&!l.altKey||l.metaKey;(c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!f&&(t.beforeChange(),wl(t,!0,n),t.add({},l),s.set(!0))}),e.on("mousedown",l=>{t.typing&&o(l)});const r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},WM=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},Qy=e=>{const t=As(),n=ct(0),s=ct(0),o={data:[],typing:!1,beforeChange:()=>{z$(e,n,t)},add:(r,a)=>H$(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);const r=Sl(e);r.bookmark=pu(e.selection),e.dispatch("change",{level:r,lastLevel:ni(o.data,s.get()).getOrUndefined()})},undo:()=>V$(e,o,n,s),redo:()=>W$(e,s,o.data),clear:()=>{j$(e,o,s)},reset:()=>{q$(e,o)},hasUndo:()=>K$(e,o,s),hasRedo:()=>G$(e,o,s),transact:r=>Y$(e,o,n,r),ignore:r=>{X$(e,n,r)},extra:(r,a)=>{Q$(e,o,s,r,a)}};return Zn(e)||VM(e,o,n),WM(e),o},jM=[9,27,Y.HOME,Y.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Y.DOWN,Y.UP,Y.LEFT,Y.RIGHT].concat(be.browser.isFirefox()?[224]:[]),Zy="data-mce-placeholder",Jy=e=>e.type==="keydown"||e.type==="keyup",eE=e=>{const t=e.keyCode;return t===Y.BACKSPACE||t===Y.DELETE},qM=e=>{if(Jy(e)){const t=e.keyCode;return!eE(e)&&(Y.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||Te(jM,t))}else return!1},KM=e=>Jy(e)&&!(eE(e)||e.type==="keyup"&&e.keyCode===229),GM=(e,t,n)=>{if(Qe(v.fromDom(t),!1)){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},YM=e=>{var t;const n=e.dom,s=Kt(e),o=(t=JA(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(qM(a))return;const l=e.getBody(),c=KM(a)?!1:GM(n,l,s);(n.getAttrib(l,Zy)!==""!==c||i)&&(n.setAttrib(l,Zy,c?o:null),n.setAttrib(l,"aria-placeholder",c?o:null),y1(e,c),e.on(c?"keydown":"keyup",r),e.off(c?"keyup":"keydown",r))};Mn(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>ln.setEditorTimeout(e,()=>r(i)))})},XM=(e,t)=>({block:e,position:t}),QM=(e,t)=>({from:e,to:t}),hd=(e,t)=>{const n=v.fromDom(e),s=v.fromDom(t.container());return cl(n,s).map(o=>XM(o,t))},ZM=e=>!ye(e.from.block,e.to.block),tE=(e,t)=>Zs(t,o=>Xr(o)||Nn(o.dom),o=>ye(o,e)).filter(Ut).getOr(e),JM=(e,t)=>{const n=v.fromDom(e);return ye(tE(n,t.from.block),tE(n,t.to.block))},eU=e=>De(e.from.block.dom)===!1&&De(e.to.block.dom)===!1,tU=e=>{const t=n=>jg(n)||Gc(n.dom);return t(e.from.block)&&t(e.to.block)},nU=(e,t,n)=>We(n.position.getNode())&&!Qe(n.block)?ir(!1,n.block.dom).bind(s=>s.isEqual(n.position)?sn(t,e,s).bind(o=>hd(e,o)):m.some(n)).getOr(n):n,sU=(e,t,n)=>{const s=hd(e,A.fromRangeStart(n)),o=s.bind(r=>sn(t,e,r.position).bind(a=>hd(e,a).map(i=>nU(e,t,i))));return Bt(s,o,QM).filter(r=>ZM(r)&&JM(e,r)&&eU(r)&&tU(r))},oU=(e,t,n)=>n.collapsed?sU(e,t,n):m.none(),rU=e=>{const t=Ct(e);return Dr(t,tn).fold(K(t),n=>t.slice(0,n))},nE=e=>{const t=rU(e);return B(t,Fe),t},sE=(e,t)=>{const n=gs(t,e);return rt(n.reverse(),s=>Qe(s)).each(Fe)},aU=e=>oe(vg(e),t=>!Qe(t)).length===0,iU=(e,t,n,s)=>{if(Qe(n))return oo(n),It(n.dom);aU(s)&&Qe(t)&&en(s,v.fromTag("br"));const o=on(n.dom,A.before(s.dom));return B(nE(t),r=>{en(s,r)}),sE(e,t),o},lU=(e,t,n)=>{if(Qe(n)){if(Qe(t)){const r=Pr((a=>{const i=(l,c)=>Pc(l).fold(()=>c,f=>Ci(f)?i(f,c.concat(uo(f))):c);return i(a,[])})(n),(a,i)=>(Tg(a,i),i),Ei());Yo(t),at(t,r)}return Fe(n),It(t.dom)}const s=Gn(n.dom);return B(nE(t),o=>{at(n,o)}),sE(e,t),s},cU=(e,t)=>{const n=gs(t,e);return m.from(n[n.length-1])},uU=(e,t)=>as(t,e)?cU(t,e):m.none(),oE=(e,t)=>{ir(e,t.dom).bind(n=>m.from(n.getNode())).map(v.fromDom).filter(so).each(Fe)},rE=(e,t,n)=>(oE(!0,t),oE(!1,n),uU(t,n).fold(G(lU,e,t,n),G(iU,e,t,n))),aE=(e,t,n,s)=>t?rE(e,s,n):rE(e,n,s),bd=(e,t)=>{const n=v.fromDom(e.getBody());return oU(n.dom,t,e.selection.getRng()).map(o=>()=>{aE(n,t,o.from.block,o.to.block).each(r=>{e.selection.setRng(r.toRange())})})},fU=(e,t)=>{const n=t.getRng();return Bt(cl(e,v.fromDom(n.startContainer)),cl(e,v.fromDom(n.endContainer)),(s,o)=>ye(s,o)?m.none():m.some(()=>{n.deleteContents(),aE(e,!0,s,o).each(r=>{t.setRng(r.toRange())})})).getOr(m.none())},iE=(e,t)=>{const n=v.fromDom(t),s=G(ye,e);return ls(n,Xr,s).isSome()},dU=(e,t)=>iE(e,t.startContainer)||iE(e,t.endContainer),mU=(e,t)=>{const n=on(e.dom,A.fromRangeStart(t)).isNone(),s=zt(e.dom,A.fromRangeEnd(t)).isNone();return!dU(e,t)&&n&&s},gU=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),pU=e=>{const t=v.fromDom(e.getBody()),n=e.selection.getRng();return mU(t,n)?gU(e):fU(t,e.selection)},vd=(e,t)=>e.selection.isCollapsed()?m.none():pU(e),ps=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),hU=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},Ba=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(hU(t)),bU=(e,t,n)=>{const s=ku(1,e.getBody(),t),o=A.fromRangeStart(s),r=o.getNode();if(fa(r))return ps(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if(fa(a))return ps(1,e,a,!1,!1);const i=xo(e.dom.getRoot(),o.getNode());return fa(i)?ps(1,e,i,!1,n):m.none()},Cd=(e,t,n)=>t.collapsed?bU(e,t,n).getOr(t):t,vU=e=>Is(e)||Sa(e),CU=e=>Ls(e)||wa(e),yU=(e,t)=>{P(t)&&t.data.length===0&&e.remove(t)},lE=(e,t,n,s,o,r)=>{ps(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),yU(e.dom,n)},EU=(e,t)=>{const n=e.selection.getRng();if(!P(n.commonAncestorContainer))return m.none();const s=t?ut.Forwards:ut.Backwards,o=Kn(e.getBody()),r=G(xu,t?o.next:o.prev),a=t?vU:CU,i=ha(s,e.getBody(),n),l=r(i),c=l&&cn(t,l);if(!c||!Hi(i,c))return m.none();if(a(c))return m.some(()=>lE(e,n,i.getNode(),s,t,c));const f=r(c);return f&&a(f)&&Hi(c,f)?m.some(()=>lE(e,n,i.getNode(),s,t,f)):m.none()},yd=(e,t)=>EU(e,t),Ed=(e,t)=>{const n=e.getBody();return t?It(n).filter(Is):Gn(n).filter(Ls)},Sd=e=>{const t=e.selection.getRng();return!t.collapsed&&(Ed(e,!0).exists(n=>n.isEqual(A.fromRangeStart(t)))||Ed(e,!1).exists(n=>n.isEqual(A.fromRangeEnd(t))))},SU=e=>z(e)&&(Xr(v.fromDom(e))||Yr(v.fromDom(e))),Gt=Wn.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),wU=(e,t)=>{const n=t.getNode(!e),s=e?"after":"before";return H(n)&&n.getAttribute("data-mce-caret")===s},kU=(e,t,n,s)=>{const o=r=>Ci(v.fromDom(r))&&!jn(n,s,e);return Oh(!t,n).fold(()=>Oh(t,s).fold(ze,o),o)},cE=(e,t,n,s)=>{const o=s.getNode(!t);return cl(v.fromDom(e),v.fromDom(n.getNode())).map(r=>Qe(r)?Gt.remove(r.dom):Gt.moveToElement(o)).orThunk(()=>m.some(Gt.moveToElement(o)))},uE=(e,t,n)=>sn(t,e,n).bind(s=>SU(s.getNode())||kU(e,t,n,s)?m.none():t&&De(s.getNode())||!t&&De(s.getNode(!0))?cE(e,t,n,s):t&&Ls(n)||!t&&Is(n)?m.some(Gt.moveToPosition(s)):m.none()),xU=(e,t)=>Je(t)?m.none():e&&De(t.nextSibling)?m.some(Gt.moveToElement(t.nextSibling)):!e&&De(t.previousSibling)?m.some(Gt.moveToElement(t.previousSibling)):m.none(),NU=(e,t,n)=>n.fold(s=>m.some(Gt.remove(s)),s=>m.some(Gt.moveToElement(s)),s=>jn(t,s,e)?m.none():m.some(Gt.moveToPosition(s))),_U=(e,t,n)=>wU(t,n)?xU(t,n.getNode(!t)).orThunk(()=>uE(e,t,n)):uE(e,t,n).bind(s=>NU(e,n,s)),AU=(e,t,n)=>{const s=ku(t?1:-1,e,n),o=A.fromRangeStart(s),r=v.fromDom(e);return!t&&Ls(o)?m.some(Gt.remove(o.getNode(!0))):t&&Is(o)?m.some(Gt.remove(o.getNode())):!t&&Is(o)&&gf(r,o)?OD(r,o).map(a=>Gt.remove(a.getNode())):t&&Ls(o)&&mf(r,o)?ID(r,o).map(a=>Gt.remove(a.getNode())):_U(e,t,o)},RU=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),wo(e,t,v.fromDom(n)),!0),TU=(e,t)=>n=>{const s=t?A.before(n):A.after(n);return e.selection.setRng(s.toRange()),!0},PU=e=>t=>(e.selection.setRng(t.toRange()),!0),fE=(e,t)=>m.from(xo(e.getBody(),t)),DU=(e,t)=>{const n=e.selection.getNode();return fE(e,n).filter(De).fold(()=>AU(e.getBody(),t,e.selection.getRng()).map(s=>()=>s.fold(RU(e,t),TU(e,t),PU(e))),()=>m.some(de))},BU=e=>{B(kt(e,".mce-offscreen-selection"),Fe)},OU=(e,t)=>{const n=e.selection.getNode();return De(n)&&!bi(n)?fE(e,n.parentNode).filter(De).fold(()=>m.some(()=>{BU(v.fromDom(e.getBody())),wo(e,t,v.fromDom(e.selection.getNode())),yf(e)}),()=>m.some(de)):Sd(e)?m.some(()=>{Fv(e,e.selection.getRng(),v.fromDom(e.getBody()))}):m.none()},dE=e=>{const t=e.dom,n=e.selection,s=xo(e.getBody(),n.getNode());if(Nn(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(A.before(o).toRange())}return!0},wd=(e,t)=>e.selection.isCollapsed()?DU(e,t):OU(e,t),IU=(e,t)=>{const n=A.fromRangeStart(e.selection.getRng());return sn(t,e.getBody(),n).filter(s=>t?_D(s):AD(s)).bind(s=>wu(t?0:-1,s)).map(s=>()=>e.selection.select(s))},kd=(e,t)=>e.selection.isCollapsed()?IU(e,t):m.none(),Cr=P,mE=e=>Cr(e)&&e.data[0]===yt,gE=e=>Cr(e)&&e.data[e.data.length-1]===yt,pE=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(yt)},LU=e=>{var t;if(Cr(e.previousSibling))return gE(e.previousSibling)||e.previousSibling.appendData(yt),e.previousSibling;if(Cr(e))return mE(e)||e.insertData(0,yt),e;{const n=pE(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},$U=e=>{var t,n;if(Cr(e.nextSibling))return mE(e.nextSibling)||e.nextSibling.insertData(0,yt),e.nextSibling;if(Cr(e))return gE(e)||e.appendData(yt),e;{const s=pE(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},Tl=(e,t)=>e?LU(t):$U(t),FU=G(Tl,!0),MU=G(Tl,!1),hE=(e,t)=>P(e.container())?Tl(t,e.container()):Tl(t,e.getNode()),bE=(e,t)=>{const n=t.get();return n&&e.container()===n&&xs(n)},xd=(e,t)=>t.fold(n=>{po(e.get());const s=FU(n);return e.set(s),m.some(A(s,s.length-1))},n=>It(n).map(s=>{if(bE(s,e)){const o=e.get();return A(o,1)}else{po(e.get());const o=hE(s,!0);return e.set(o),A(o,1)}}),n=>Gn(n).map(s=>{if(bE(s,e)){const o=e.get();return A(o,o.length-1)}else{po(e.get());const o=hE(s,!1);return e.set(o),A(o,o.length-1)}}),n=>{po(e.get());const s=MU(n);return e.set(s),m.some(A(s,1))}),vE=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},_t=Wn.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),CE=(e,t)=>{const n=Ps(t,e);return n||e},UU=(e,t,n)=>{const s=Ov(n),o=CE(t,s.container());return $s(e,o,s).fold(()=>zt(o,s).bind(G($s,e,o)).map(r=>_t.before(r)),m.none)},zU=(e,t)=>bo(e,t)===null,yE=(e,t,n)=>$s(e,t,n).filter(G(zU,t)),HU=(e,t,n)=>{const s=Iv(n);return yE(e,t,s).bind(o=>on(o,s).isNone()?m.some(_t.start(o)):m.none())},VU=(e,t,n)=>{const s=Ov(n);return yE(e,t,s).bind(o=>zt(o,s).isNone()?m.some(_t.end(o)):m.none())},WU=(e,t,n)=>{const s=Iv(n),o=CE(t,s.container());return $s(e,o,s).fold(()=>on(o,s).bind(G($s,e,o)).map(r=>_t.after(r)),m.none)},EE=e=>!mB(Nd(e)),Jn=(e,t,n)=>vE([UU,HU,VU,WU],[e,t,n]).filter(EE),Nd=e=>e.fold(Dt,Dt,Dt,Dt),SE=e=>e.fold(K("before"),K("start"),K("end"),K("after")),Pl=e=>e.fold(_t.before,_t.before,_t.after,_t.after),_d=e=>e.fold(_t.start,_t.start,_t.end,_t.end),jU=(e,t)=>SE(e)===SE(t)&&Nd(e)===Nd(t),qU=(e,t,n,s,o,r)=>Bt($s(t,n,s),$s(t,n,o),(a,i)=>a!==i&&pB(n,a,i)?_t.after(e?a:i):r).getOr(r),KU=(e,t)=>e.fold(et,n=>!jU(n,t)),GU=(e,t,n,s,o)=>{const r=cn(e,o);return sn(e,n,r).map(G(cn,e)).fold(()=>s.map(Pl),l=>Jn(t,n,l).map(G(qU,e,t,n,r,l)).filter(G(KU,s))).filter(EE)},YU=(e,t)=>e?t.fold(js(m.some,_t.start),m.none,js(m.some,_t.after),m.none):t.fold(m.none,js(m.some,_t.before),m.none,js(m.some,_t.end)),XU=(e,t,n,s)=>{const o=cn(e,s),r=Jn(t,n,o);return Jn(t,n,o).bind(G(YU,e)).orThunk(()=>GU(e,t,n,r,s))},QU=e=>Ce(e.selection.getSel().modify),wE=(e,t,n)=>{const s=e?1:-1;return t.setRng(A(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},ZU=(e,t)=>{const n=t.selection.getRng(),s=e?A.fromRangeEnd(n):A.fromRangeStart(n);return QU(t)?e&&Hc(s)?wE(!0,t.selection,s):!e&&Vc(s)?wE(!1,t.selection,s):!1:!1};var es;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(es||(es={}));const Dl=(e,t)=>e===ut.Backwards?Br(t):t,JU=(e,t,n)=>e===ut.Forwards?t.next(n):t.prev(n),ez=(e,t,n,s)=>We(s.getNode(t===ut.Forwards))?es.Br:jn(n,s)===!1?es.Block:es.Wrap,kE=(e,t,n,s)=>{const o=Kn(n);let r=s;const a=[];for(;r;){const i=JU(t,o,r);if(!i)break;if(We(i.getNode(!1)))return t===ut.Forwards?{positions:Dl(t,a).concat([i]),breakType:es.Br,breakAt:m.some(i)}:{positions:Dl(t,a),breakType:es.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const l=ez(n,t,r,i);return{positions:Dl(t,a),breakType:l,breakAt:m.some(i)}}a.push(i),r=i}return{positions:Dl(t,a),breakType:es.Eol,breakAt:m.none()}},xE=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===ut.Backwards?r.concat(o):[o].concat(r)}).getOr([]),Ad=(e,t)=>Wt(e,(n,s)=>n.fold(()=>m.some(s),o=>Bt(Mt(o.getClientRects()),Mt(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),Bl=(e,t)=>Mt(t.getClientRects()).bind(n=>Ad(e,n.left)),Oa=G(kE,A.isAbove,-1),Ia=G(kE,A.isBelow,1),NE=G(xE,-1,Oa),_E=G(xE,1,Ia),tz=(e,t)=>Oa(e,t).breakAt.isNone(),nz=(e,t)=>Ia(e,t).breakAt.isNone(),sz=e=>It(e).map(t=>[t].concat(Ia(e,t).positions)).getOr([]),oz=e=>Gn(e).map(t=>Oa(e,t).positions.concat(t)).getOr([]),rz=(e,t)=>Bl(NE(e,t),t),az=(e,t)=>Bl(_E(e,t),t),iz=De,AE=(e,t)=>Math.abs(e.left-t),RE=(e,t)=>Math.abs(e.right-t),lz=e=>Wo(e,"node"),TE=(e,t)=>ri(e,(n,s)=>{const o=Math.min(AE(n,t),RE(n,t)),r=Math.min(AE(s,t),RE(s,t));return r===o&&lz(s)&&iz(s.node)||r<o?s:n}),cz=e=>{const t=n=>ve(n,s=>{const o=mo(s);return o.node=e,o});if(H(e))return t(e.getClientRects());if(P(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},PE=e=>Fn(e,cz);var La;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(La||(La={}));const uz=(e,t,n,s)=>{let o=s;for(;o=ma(o,e,Xg,t);)if(n(o))return},DE=(e,t,n,s,o,r)=>{let a=0;const i=[],l=u=>{let d=PE([u]);e===-1&&(d=d.reverse());for(let p=0;p<d.length;p++){const b=d[p];if(!n(b,c)){if(i.length>0&&t(b,Gs(i))&&a++,b.line=a,o(b))return!0;i.push(b)}}return!1},c=Gs(r.getClientRects());if(!c)return i;const f=r.getNode();return f&&(l(f),uz(e,s,l,f)),i},fz=(e,t)=>t.line>e,dz=(e,t)=>t.line===e,mz=G(DE,La.Up,ra,aa),gz=G(DE,La.Down,aa,ra),BE=e=>Gs(e.getClientRects()),pz=(e,t,n,s)=>{const o=Kn(t);let r,a,i,l;const c=[];let f=0;e===1?(r=o.next,a=aa,i=ra,l=A.after(s)):(r=o.prev,a=ra,i=aa,l=A.before(s));const u=BE(l);do{if(!l.isVisible())continue;const d=BE(l);if(i(d,u))continue;c.length>0&&a(d,Gs(c))&&f++;const p=mo(d);if(p.position=l,p.line=f,n(p))return c;c.push(p)}while(l=r(l));return c},OE=e=>t=>fz(e,t),Rd=e=>t=>dz(e,t),hs=(e,t)=>{e.selection.setRng(t),Ea(e,e.selection.getRng())},Td=(e,t,n)=>m.some(Cd(e,t,n)),IE=(e,t,n,s,o,r)=>{const a=t===ut.Forwards,i=Kn(e.getBody()),l=G(xu,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){const b=Oi(n);if(r(b))return ps(t,e,b,t===ut.Backwards,!1);if(Sd(e)){const g=n.cloneRange();return g.collapse(t===ut.Backwards),m.from(g)}}const f=ha(t,e.getBody(),n);if(c(f))return Ba(e,f.getNode(!a));let u=l(f);const d=Kg(n);if(u)u=cn(a,u);else return d?m.some(n):m.none();if(c(u))return ps(t,e,u.getNode(!a),a,!1);const p=l(u);return p&&c(p)&&Hi(u,p)?ps(t,e,p.getNode(!a),a,!1):d?Td(e,u.toRange(),!1):m.none()},LE=(e,t,n,s,o,r)=>{const a=ha(t,e.getBody(),n),i=Gs(a.getClientRects()),l=t===La.Down,c=e.getBody();if(!i)return m.none();if(Sd(e)){const h=l?A.fromRangeEnd(n):A.fromRangeStart(n);return(l?az:rz)(c,h).orThunk(()=>m.from(h)).map(C=>C.toRange())}const u=(l?gz:mz)(c,OE(1),a),d=oe(u,Rd(1)),p=i.left,b=TE(d,p);if(b&&r(b.node)){const h=Math.abs(p-b.left),y=Math.abs(p-b.right);return ps(t,e,b.node,h<y,!1)}let g;if(s(a)?g=a.getNode():o(a)?g=a.getNode(!0):g=Oi(n),g){const h=pz(t,c,OE(1),g);let y=TE(oe(h,Rd(1)),p);if(y||(y=Gs(oe(h,Rd(0))),y))return Td(e,y.position.toRange(),!1)}return d.length===0?Pd(e,l).filter(l?o:s).map(h=>Cd(e,h.toRange(),!1)):m.none()},Pd=(e,t)=>{const n=e.selection.getRng(),s=t?A.fromRangeEnd(n):A.fromRangeStart(n),o=cT(s.container(),e.getBody());if(t){const r=Ia(o,s);return Ks(r.positions)}else{const r=Oa(o,s);return Mt(r.positions)}},$E=(e,t,n)=>Pd(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),Ol=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},FE=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},ME=(e,t,n)=>xd(t,n).map(s=>(Ol(e,s),n)),hz=(e,t,n)=>{const s=A.fromRangeStart(e);if(e.collapsed)return s;{const o=A.fromRangeEnd(e);return n?on(t,o).getOr(o):zt(t,s).getOr(s)}},bz=(e,t,n)=>{const s=e.getBody(),o=hz(e.selection.getRng(),s,n),r=G(ko,e);return XU(n,r,s,o).bind(i=>ME(e,t,i))},vz=(e,t,n)=>{const s=ve(kt(v.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=oe(s,e),r=oe(n,e);B(ti(o,r),G(FE,!1)),B(ti(r,o),G(FE,!0))},Cz=(e,t)=>{const n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){const s=A.fromRangeStart(e.selection.getRng());A.isTextPosition(s)&&!hB(s)&&(Ol(e,QR(n,s)),t.set(null))}},yz=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=oe(s,e);B(o,r=>{const a=A.fromRangeStart(t.selection.getRng());Jn(e,t.getBody(),a).bind(i=>ME(t,n,i))})}},UE=(e,t,n)=>ua(e)?bz(e,t,n).isSome():!1,zE=(e,t,n)=>ua(t)?ZU(e,t):!1,Ez=e=>{const t=ct(null),n=G(ko,e);return e.on("NodeChange",s=>{ua(e)&&(vz(n,e.dom,s.parents),Cz(e,t),yz(n,e,t,s.parents))}),t},Sz=G(zE,!0),wz=G(zE,!1),Il=(e,t,n)=>{if(ua(e)){const s=Pd(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?A.fromRangeEnd(o):A.fromRangeStart(o)});return Jn(G(ko,e),e.getBody(),s).exists(o=>{const r=Pl(o);return xd(n,r).exists(a=>(Ol(e,a),!0))})}else return!1},kz=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},xz=e=>Bt(It(e),Gn(e),(t,n)=>{const s=cn(!0,t),o=cn(!1,n);return zt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),HE=(e,t)=>n=>xd(t,n).map(s=>()=>Ol(e,s)),VE=(e,t,n,s)=>{const o=e.getBody(),r=G(ko,e);e.undoManager.ignore(()=>{e.selection.setRng(kz(n,s)),Cf(e),Jn(r,o,A.fromRangeStart(e.selection.getRng())).map(_d).bind(HE(e,t)).each(Rr)}),e.nodeChanged()},Nz=(e,t)=>{const n=Ps(t,e);return n||e},_z=(e,t,n,s)=>{const o=Nz(e.getBody(),s.container()),r=G(ko,e),a=Jn(r,o,s);return a.bind(l=>n?l.fold(K(m.some(_d(l))),m.none,K(m.some(Pl(l))),m.none):l.fold(m.none,K(m.some(Pl(l))),m.none,K(m.some(_d(l))))).map(HE(e,t)).getOrThunk(()=>{const l=Wi(n,o,s),c=l.bind(f=>Jn(r,o,f));return Bt(a,c,()=>$s(r,o,s).bind(f=>xz(f)?m.some(()=>{wo(e,n,v.fromDom(f))}):m.none())).getOrThunk(()=>c.bind(()=>l.map(f=>()=>{n?VE(e,t,s,f):VE(e,t,f,s)})))})},Dd=(e,t,n)=>{if(e.selection.isCollapsed()&&ua(e)){const s=A.fromRangeStart(e.selection.getRng());return _z(e,t,n,s)}return m.none()},Az=e=>yg(e)>1,WE=(e,t)=>{const n=v.fromDom(e.getBody()),s=v.fromDom(e.selection.getStart()),o=gs(s,n);return Dr(o,t).fold(K(o),r=>o.slice(0,r))},Rz=e=>WE(e,t=>tn(t)||Az(t)),Tz=e=>WE(e,tn),jE=(e,t)=>{const n=G(uC,e);return Fn(t,s=>n(s)?[s.dom]:[])},qE=e=>{const t=Tz(e);return jE(e,t)},Pz=(e,t,n,s)=>{const o=jE(t,s);if(o.length===0)wo(t,e,n);else{const r=cC(n.dom,o);t.selection.setRng(r.toRange())}},Dz=(e,t)=>{const n=Rz(e);return Ks(n).bind(s=>{const o=A.fromRangeStart(e.selection.getRng());return EB(t,o,s.dom)&&!fC(s)?m.some(()=>Pz(t,e,s,n)):m.none()})},Bz=(e,t)=>{const n=t.parentElement;return We(t)&&!hn(n)&&e.dom.isEmpty(n)},Oz=e=>fC(v.fromDom(e)),KE=(e,t)=>{const n=e.selection.getStart(),s=Bz(e,n)||Oz(n)?cC(n,t):aI(e,t);e.selection.setRng(s.toRange())},Iz=(e,t)=>{const n=ti(t,qE(e));n.length>0&&KE(e,n)},GE=e=>P(e.startContainer),Lz=e=>e.startOffset===0&&GE(e),$z=(e,t)=>{const n=t.startContainer.parentElement;return!hn(n)&&uC(e,v.fromDom(n))},Fz=e=>{const t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!hn(t)&&!hn(n)&&t.isEqualNode(n)},Mz=e=>{const t=e.endContainer;return e.endOffset===(P(t)?t.length:t.childNodes.length)},Uz=e=>Fz(e)&&Mz(e),zz=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),Hz=e=>Uz(e)||zz(e),Vz=e=>{const t=e.selection.getRng();return Lz(t)&&$z(e,t)&&Hz(t)},Wz=e=>{if(Vz(e)){const t=qE(e);return m.some(()=>{Cf(e),Iz(e,t)})}else return m.none()},Bd=(e,t)=>e.selection.isCollapsed()?Dz(e,t):Wz(e),jz=e=>WO(e,t=>vn(t.dom),tn),qz=e=>jz(v.fromDom(e.selection.getStart())),Kz=e=>{const t=e.selection.getRng();return t.collapsed&&(GE(t)||e.dom.isEmpty(t.startContainer))&&!qz(e)},$a=e=>(Kz(e)&&KE(e,[]),!0),Od=(e,t,n)=>z(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),wo(e,t,v.fromDom(n))}):m.none(),Gz=(e,t)=>{const n=t?Sa:wa,s=t?ut.Forwards:ut.Backwards,o=ha(s,e.getBody(),e.selection.getRng());return n(o)?Od(e,t,o.getNode(!t)):m.from(cn(t,o)).filter(r=>n(r)&&Hi(o,r)).bind(r=>Od(e,t,r.getNode(!t)))},Yz=(e,t)=>{const n=e.selection.getNode();return Vn(n)?Od(e,t,n):m.none()},Id=(e,t)=>e.selection.isCollapsed()?Gz(e,t):Yz(e,t),Xz=e=>Zs(e,t=>Nn(t.dom)||De(t.dom)).exists(t=>Nn(t.dom)),Ld=e=>ai(e??"").getOr(0),YE=(e,t)=>{const n=e||pN(t)?"margin":"padding",s=Hn(t,"direction")==="rtl"?"-right":"-left";return n+s},Qz=(e,t,n,s,o,r)=>{const a=YE(n,v.fromDom(r)),i=Ld(e.getStyle(r,a));if(t==="outdent"){const l=Math.max(0,i-s);e.setStyle(r,a,l?l+o:"")}else{const l=i+s+o;e.setStyle(r,a,l)}},Zz=(e,t)=>vs(t,n=>{const s=YE(mh(e),n),o=di(n,s).map(Ld).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),XE=e=>{const t=ZE(e);return!e.mode.isReadOnly()&&(t.length>1||Zz(e,t))},QE=e=>zc(e)||Yr(e),Jz=e=>kn(e).exists(QE),ZE=e=>oe(Pg(e.selection.getSelectedBlocks()),t=>!QE(t)&&!Jz(t)&&Xz(t)),JE=(e,t)=>{var n,s;const{dom:o}=e,r=KA(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=Ld(r),l=mh(e);B(ZE(e),c=>{Qz(o,t,l,i,a,c.dom)})},e2=e=>JE(e,"indent"),e0=e=>JE(e,"outdent"),t0=e=>{if(e.selection.isCollapsed()&&XE(e)){const t=e.dom,n=e.selection.getRng(),s=A.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&df(v.fromDom(o),s))return m.some(()=>e0(e))}return m.none()},n0=(e,t,n)=>Vo([t0,wd,yd,(s,o)=>Dd(s,t,o),bd,Af,kd,Id,vd,Bd],s=>s(e,n)).filter(s=>e.selection.isEditable()),t2=(e,t)=>{n0(e,t,!1).fold(()=>{Cf(e),yf(e)},Rr)},n2=(e,t)=>{n0(e,t,!0).fold(()=>vB(e),Rr)},s2=(e,t)=>{e.addCommand("delete",()=>{t2(e,t)}),e.addCommand("forwardDelete",()=>{n2(e,t)})},s0=5,o2=400,o0=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),r2=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>s0||s>s0},a2=e=>{const t=As(),n=ct(!1),s=iu(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},o2);e.on("touchstart",o=>{o0(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),o0(o).each(r=>{t.on(a=>{r2(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},$d=(e,t)=>le(e,t.nodeName),i2=(e,t)=>P(t)?!0:H(t)?!$d(e.getBlockElements(),t)&&!rn(t)&&!ao(e,t):!1,l2=(e,t,n)=>Xe(hv(v.fromDom(n),v.fromDom(t)),s=>$d(e,s.dom)),c2=(e,t)=>{if(P(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data)&&(!t.nextSibling||$d(e,t.nextSibling)))return!0}return!1},r0=e=>e.dom.create(Kt(e),ca(e)),u2=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody();let i,l,c=!1;const f=Kt(e);if(!r||!H(r))return;const u=a.nodeName.toLowerCase();if(!s.isValidChild(u,f.toLowerCase())||l2(o,a,r))return;const d=n.getRng(),{startContainer:p,startOffset:b,endContainer:g,endOffset:h}=d,y=So(e);let C=a.firstChild;for(;C;)if(H(C)&&XN(s,C),i2(s,C)){if(c2(o,C)){l=C,C=C.nextSibling,t.remove(l);continue}i||(i=r0(e),a.insertBefore(i,C),c=!0),l=C,C=C.nextSibling,i.appendChild(l)}else i=null,C=C.nextSibling;c&&y&&(d.setStart(p,b),d.setEnd(g,h),n.setRng(d),e.nodeChanged())},a0=(e,t,n)=>{const s=v.fromDom(r0(e)),o=Ei();at(s,o),n(t,s);const r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},f2=e=>{e.on("NodeChange",G(u2,e))},i0=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,d2=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},m2=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],d2(e,o,yh(e)));n.content=o}},g2=e=>{const t="contenteditable",n=" "+L.trim($R(e))+" ",s=" "+L.trim(yh(e))+" ",o=i0(n),r=i0(s),a=FR(e);a.length>0&&e.on("BeforeSetContent",i=>{m2(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){const c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){const c=i[l];!o(c)&&!r(c)||(a.length>0&&c.attr("data-mce-content")?(c.name="#text",c.type=3,c.raw=!0,c.value=c.attr("data-mce-content")):c.attr(t,null))}})},p2=e=>qr(v.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),l0=(e,t)=>{t.hasAttribute("data-mce-caret")&&(Wc(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},h2=(e,t)=>{const n=p2(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),l0(e,n);return}qg(n)&&(l0(e,n),e.undoManager.add())}},b2=e=>{e.on("keyup compositionstart",G(h2,e))},c0=De,v2=(e,t,n)=>IE(t,e,n,Is,Ls,c0),C2=(e,t,n)=>LE(t,e,n,r=>Is(r)||gv(r),r=>Ls(r)||pv(r),c0),y2=e=>{const t=e.dom.create(Kt(e));return t.innerHTML='<br data-mce-bogus="1">',t},u0=(e,t,n)=>{const s=Kn(e.getBody()),o=G(xu,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(A.fromRangeStart(n))){const i=v.fromDom(y2(e));t===1?Ss(v.fromDom(r),i):en(v.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},E2=(e,t)=>{const n=t?ut.Forwards:ut.Backwards,s=e.selection.getRng();return v2(n,e,s).orThunk(()=>(u0(e,n,s),m.none()))},S2=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return C2(n,e,s).orThunk(()=>(u0(e,n,s),m.none()))},f0=(e,t)=>E2(e,t).exists(n=>(hs(e,n),!0)),d0=(e,t)=>S2(e,t).exists(n=>(hs(e,n),!0)),m0=(e,t)=>$E(e,t,t?Ls:Is),Ll=(e,t)=>Ed(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(hs(e,n),!0)),w2=e=>Te(["figcaption"],Ie(e)),k2=(e,t)=>{const n=G(ye,t);return Zs(v.fromDom(e.container()),tn,n).filter(w2)},x2=(e,t,n)=>t?nz(e.dom,n):tz(e.dom,n),N2=(e,t)=>{const n=v.fromDom(e.getBody()),s=A.fromRangeStart(e.selection.getRng());return k2(s,n).exists(()=>{if(x2(n,t,s)){const r=a0(e,n,t?at:Rg);return e.selection.setRng(r),!0}else return!1})},g0=(e,t)=>e.selection.isCollapsed()?N2(e,t):!1,p0={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},_2=e=>ve(e,t=>({...p0,...t})),A2=e=>ve(e,t=>({...p0,...t})),h0=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,R2=(e,t)=>Fn(_2(e),n=>h0(n,t)?[n]:[]),T2=(e,t)=>Fn(A2(e),n=>h0(n,t)?[n]:[]),ae=(e,...t)=>()=>e.apply(null,t),Fa=(e,t)=>rt(R2(e,t),n=>n.action()),b0=(e,t)=>Vo(T2(e,t),n=>n.action()),v0=(e,t)=>{const n=t?ut.Forwards:ut.Backwards,s=e.selection.getRng();return IE(e,n,s,Sa,wa,Vn).exists(o=>(hs(e,o),!0))},C0=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return LE(e,n,s,Sa,wa,Vn).exists(o=>(hs(e,o),!0))},y0=(e,t)=>$E(e,t,t?wa:Sa),E0=Wn.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Ma={...E0,none:e=>E0.none(e)},P2=(e,t)=>S0(e,t,et),S0=(e,t,n)=>Fn(Ct(e),s=>wn(s,t)?n(s)?[s]:[]:S0(s,t,n)),D2=(e,t,n=ze)=>{if(n(t))return m.none();if(Te(e,Ie(t)))return m.some(t);const s=o=>wn(o,"table")||n(o);return jr(t,e.join(","),s)},B2=(e,t)=>D2(["td","th"],e,t),O2=e=>P2(e,"th,td"),w0=(e,t)=>Js(e,"table",t),Fd=(e,t,n,s,o=et)=>{const r=s===1;if(!r&&n<=0)return Ma.first(e[0]);if(r&&n>=e.length-1)return Ma.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?Ma.middle(t,i):Fd(e,t,a,s,o)}},k0=(e,t)=>w0(e,t).bind(n=>{const s=O2(n);return Dr(s,r=>ye(e,r)).map(r=>({index:r,all:s}))}),I2=(e,t,n)=>k0(e,n).fold(()=>Ma.none(e),o=>Fd(o.all,e,o.index,1,t)),L2=(e,t,n)=>k0(e,n).fold(()=>Ma.none(),o=>Fd(o.all,e,o.index,-1,t)),$2=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),F2=(e,t)=>Fn(t,n=>{const s=$2(mo(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),M2=(e,t,n)=>Wt(e,(s,o)=>s.fold(()=>m.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),x0=(e,t,n,s,o)=>{const r=kt(v.fromDom(n),"td,th,caption").map(i=>i.dom),a=oe(F2(e,r),i=>t(i,o));return M2(a,s,o).map(i=>i.cell)},U2=e=>e.bottom,z2=e=>e.top,H2=(e,t)=>e.y<t,V2=(e,t)=>e.y>t,W2=G(x0,U2,H2),j2=G(x0,z2,V2),q2=(e,t)=>Mt(t.getClientRects()).bind(n=>W2(e,n.left,n.top)).bind(n=>Bl(oz(n),t)),K2=(e,t)=>Ks(t.getClientRects()).bind(n=>j2(e,n.left,n.top)).bind(n=>Bl(sz(n),t)),G2=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),Y2=e=>e.breakType===es.Wrap&&e.positions.length===0,X2=e=>e.breakType===es.Br&&e.positions.length===1,N0=(e,t,n)=>{const s=e(t,n);return Y2(s)||!We(n.getNode())&&X2(s)?!G2(e,t,s):s.breakAt.isNone()},Q2=G(N0,Oa),Z2=G(N0,Ia),J2=(e,t,n)=>{const s=A.fromRangeStart(t);return ir(!e,n).exists(o=>o.isEqual(s))},eH=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return Ah()&&J2(t,o,n)?(ps(r,e,n,!t,!1).each(a=>{hs(e,a)}),!0):!1},tH=(e,t,n)=>q2(t,n).orThunk(()=>Mt(n.getClientRects()).bind(s=>Ad(NE(e,A.before(t)),s.left))).getOr(A.before(t)),nH=(e,t,n)=>K2(t,n).orThunk(()=>Mt(n.getClientRects()).bind(s=>Ad(_E(e,A.after(t)),s.left))).getOr(A.after(t)),_0=(e,t)=>{const n=t.getNode(e);return us(n)?m.some(n):m.none()},sH=(e,t,n)=>{t.undoManager.transact(()=>{const s=e?Ss:en,o=a0(t,v.fromDom(n),s);hs(t,o)})},A0=(e,t,n)=>{const s=_0(!!t,n),o=t===!1;s.fold(()=>hs(e,n.toRange()),r=>ir(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>hs(e,n.toRange()),a=>sH(t,e,r)))},oH=(e,t,n,s)=>{const o=e.selection.getRng(),r=A.fromRangeStart(o),a=e.getBody();if(!t&&Q2(s,r)){const i=tH(a,n,r);return A0(e,t,i),!0}else if(t&&Z2(s,r)){const i=nH(a,n,r);return A0(e,t,i),!0}else return!1},R0=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),T0=(e,t)=>R0(e,t,eH),P0=(e,t)=>R0(e,t,oH),rH=e=>{const t=dr.exact(e,0,e,0);return J1(t)},D0=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>aD(o).map(r=>rH(r)),s=>(e.execCommand("mceTableInsertRowAfter"),B0(e,t,s))),B0=(e,t,n)=>D0(e,t,I2(n,ui)),aH=(e,t,n)=>D0(e,t,L2(n,ui)),O0=(e,t)=>{const n=["table","li","dl"],s=v.fromDom(e.getBody()),o=i=>{const l=Ie(i);return ye(i,s)||Te(n,l)},r=e.selection.getRng(),a=v.fromDom(t?r.endContainer:r.startContainer);return B2(a,o).map(i=>(w0(i,o).each(f=>{e.model.table.clearSelectedCells(f.dom)}),e.selection.collapse(!t),(t?B0:aH)(e,o,i).each(f=>{e.selection.setRng(f)}),!0)).getOr(!1)},iH=(e,t,n)=>{const s=be.os.isMacOS()||be.os.isiOS();Fa([{keyCode:Y.RIGHT,action:ae(f0,e,!0)},{keyCode:Y.LEFT,action:ae(f0,e,!1)},{keyCode:Y.UP,action:ae(d0,e,!1)},{keyCode:Y.DOWN,action:ae(d0,e,!0)},...s?[{keyCode:Y.UP,action:ae(Ll,e,!1),metaKey:!0,shiftKey:!0},{keyCode:Y.DOWN,action:ae(Ll,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:Y.RIGHT,action:ae(T0,e,!0)},{keyCode:Y.LEFT,action:ae(T0,e,!1)},{keyCode:Y.UP,action:ae(P0,e,!1)},{keyCode:Y.DOWN,action:ae(P0,e,!0)},{keyCode:Y.RIGHT,action:ae(v0,e,!0)},{keyCode:Y.LEFT,action:ae(v0,e,!1)},{keyCode:Y.UP,action:ae(C0,e,!1)},{keyCode:Y.DOWN,action:ae(C0,e,!0)},{keyCode:Y.RIGHT,action:ae(UE,e,t,!0)},{keyCode:Y.LEFT,action:ae(UE,e,t,!1)},{keyCode:Y.RIGHT,ctrlKey:!s,altKey:s,action:ae(Sz,e,t)},{keyCode:Y.LEFT,ctrlKey:!s,altKey:s,action:ae(wz,e,t)},{keyCode:Y.UP,action:ae(g0,e,!1)},{keyCode:Y.DOWN,action:ae(g0,e,!0)}],n).each(o=>{n.preventDefault()})},lH=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||iH(e,t,n)})},Dn=(e,t)=>({container:e,offset:t}),$l=_e.DOM,Fl=e=>t=>e===t?-1:0,cH=e=>t=>e.isBlock(t)||Te(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",Md=(e,t,n)=>{if(P(e)&&t>=0)return m.some(Dn(e,t));{const s=fo($l);return m.from(s.backwards(e,t,Fl(e),n)).map(o=>Dn(o.container,o.container.data.length))}},uH=(e,t,n)=>{if(P(e)&&t>=e.length)return m.some(Dn(e,t));{const s=fo($l);return m.from(s.forwards(e,t,Fl(e),n)).map(o=>Dn(o.container,0))}},Ud=(e,t,n)=>{if(!P(e))return m.none();const s=e.data;if(t>=0&&t<=s.length)return m.some(Dn(e,t));{const o=fo($l);return m.from(o.backwards(e,t,Fl(e),n)).bind(r=>{const a=r.container.data;return Ud(r.container,t+a.length,n)})}},I0=(e,t,n)=>{if(!P(e))return m.none();const s=e.data;if(t<=s.length)return m.some(Dn(e,t));{const o=fo($l);return m.from(o.forwards(e,t,Fl(e),n)).bind(r=>I0(r.container,t-s.length,n))}},zd=(e,t,n,s,o)=>{const r=fo(e,cH(e));return m.from(r.backwards(t,n,s,o))},fH=e=>e.collapsed&&P(e.startContainer),L0=e=>fs(e.toString().replace(/\u00A0/g," ")),$0=e=>e!==""&&`  \f
\r	\v`.indexOf(e)!==-1,Hd=(e,t)=>e.substring(t.length),dH=(e,t,n)=>{let s;const o=n.charAt(0);for(s=t-1;s>=0;s--){const r=e.charAt(s);if($0(r))return m.none();if(o===r&&wt(e,n,s,t))break}return m.some(s)},mH=(e,t,n,s=0)=>{if(!fH(t))return m.none();const o={text:"",offset:0},r=(i,l,c)=>(o.text=c+o.text,o.offset+=l,dH(o.text,o.offset,n).getOr(l)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return zd(e,t.startContainer,t.startOffset,r,a).bind(i=>{const l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return m.none();const c=L0(l);return c.lastIndexOf(n)!==0||Hd(c,n).length<s?m.none():m.some({text:Hd(c,n),range:l,trigger:n})})},F0=(e,t,n,s=0)=>uD(v.fromDom(t.startContainer)).fold(()=>mH(e,t,n,s),o=>{const r=e.createRng();r.selectNode(o.dom);const a=L0(r);return m.some({range:r,text:Hd(a,n),trigger:n})}),gH=e=>e.nodeType===ag,pH=e=>e.nodeType===Mr,M0=e=>{if(gH(e))return Dn(e,e.data.length);{const t=e.childNodes;return t.length>0?M0(t[t.length-1]):Dn(e,t.length)}},U0=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?U0(n[t],0):n.length>0&&pH(e)&&n.length===t?M0(n[n.length-1]):Dn(e,t)},hH=(e,t)=>{var n;const s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return zd(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{const r=o.container.data.charAt(o.offset-1);return!$0(r)}).isSome()},bH=e=>t=>{const n=U0(t.startContainer,t.startOffset);return!hH(e,n)},vH=(e,t,n)=>Vo(n.triggers,s=>F0(e,t,s)),CH=(e,t)=>{const n=t(),s=e.selection.getRng();return vH(e.dom,s,n).bind(o=>z0(e,t,o))},z0=(e,t,n,s={})=>{var o;const r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",l=oe(r.lookupByTrigger(n.trigger),f=>n.text.length>=f.minChars&&f.matches.getOrThunk(()=>bH(e.dom))(n.range,i,n.text));if(l.length===0)return m.none();const c=Promise.all(ve(l,f=>f.fetch(n.text,f.maxResults,s).then(d=>({matchText:n.text,items:d,columns:f.columns,onAction:f.onAction,highlightOn:f.highlightOn}))));return m.some({lookupData:c,context:n})};var Bn;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(Bn||(Bn={}));const Vd=(e,t,n)=>e.stype===Bn.Error?t(e.serror):n(e.svalue),yH=e=>{const t=[],n=[];return B(e,s=>{Vd(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},EH=(e,t)=>e.stype===Bn.Error?{stype:Bn.Error,serror:t(e.serror)}:e,SH=(e,t)=>e.stype===Bn.Value?{stype:Bn.Value,svalue:t(e.svalue)}:e,wH=(e,t)=>e.stype===Bn.Value?t(e.svalue):e,kH=(e,t)=>e.stype===Bn.Error?t(e.serror):e,H0=e=>({stype:Bn.Value,svalue:e}),V0=e=>({stype:Bn.Error,serror:e}),gt={fromResult:e=>e.fold(V0,H0),toResult:e=>Vd(e,Ot.error,Ot.value),svalue:H0,partition:yH,serror:V0,bind:wH,bindError:kH,map:SH,mapError:EH,fold:Vd},Wd=e=>Ye(e)&&qt(e).length>100?" removed due to size":JSON.stringify(e,null,2),xH=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:K("... (only showing first ten failures)")}]):e;return ve(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},Ml=(e,t)=>gt.serror([{path:e,getErrorInfo:t}]),NH=(e,t,n)=>Ml(e,()=>'Could not find valid *required* value for "'+t+'" in '+Wd(n)),_H=(e,t)=>Ml(e,()=>'Choice schema did not contain choice key: "'+t+'"'),AH=(e,t,n)=>Ml(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+Wd(t)),RH=(e,t)=>Ml(e,K(t)),TH=(e,t,n,s)=>Oe(n,s).fold(()=>AH(e,n,s),r=>r.extract(e.concat(["branch: "+s]),t)),PH=(e,t)=>({extract:(o,r)=>Oe(r,e).fold(()=>_H(o,e),i=>TH(o,r,t,i)),toString:()=>"chooseOn("+e+"). Possible values: "+qt(t)}),DH=(e,t)=>t,BH=(e,t)=>Ja(e)&&Ja(t)?Ul(e,t):t,W0=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)le(o,r)&&(n[r]=e(n[r],o[r]))}return n},Ul=W0(BH),OH=W0(DH),j0=()=>({tag:"required",process:{}}),IH=e=>({tag:"defaultedThunk",process:e}),q0=e=>IH(K(e)),LH=()=>({tag:"option",process:{}}),$H=(e,t)=>e.length>0?gt.svalue(Ul(t,OH.apply(void 0,e))):gt.svalue(t),K0=e=>js(gt.serror,Fm)(e),FH={consolidateObj:(e,t)=>{const n=gt.partition(e);return n.errors.length>0?K0(n.errors):$H(n.values,t)},consolidateArr:e=>{const t=gt.partition(e);return t.errors.length>0?K0(t.errors):gt.svalue(t.values)}},MH=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),UH=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),G0=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},jd=e=>{const t=(s,o)=>gt.bindError(e(o),r=>RH(s,r)),n=K("val");return{extract:t,toString:n}},zH=jd(gt.svalue),HH=(e,t,n,s)=>Oe(t,n).fold(()=>NH(e,n,t),s),Y0=(e,t,n,s)=>{const o=Oe(e,t).getOrThunk(()=>n(e));return s(o)},VH=(e,t,n)=>n(Oe(e,t)),WH=(e,t,n,s)=>{const o=Oe(e,t).map(r=>r===!0?n(e):r);return s(o)},jH=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>gt.svalue(m.none()),l=>{const c=o.extract(t.concat([s]),l);return gt.map(c,m.some)});switch(e.tag){case"required":return HH(t,n,s,r);case"defaultedThunk":return Y0(n,s,e.process,r);case"option":return VH(n,s,a);case"defaultedOptionThunk":return WH(n,s,e.process,a);case"mergeWithThunk":return Y0(n,s,K({}),i=>{const l=Ul(e.process(n),i);return r(l)})}},qH=(e,t,n)=>{const s={},o=[];for(const r of n)G0(r,(a,i,l,c)=>{const f=jH(l,e,t,a,c);gt.fold(f,u=>{o.push(...u)},u=>{s[i]=u})},(a,i)=>{s[a]=i(t)});return o.length>0?gt.serror(o):gt.svalue(s)},qd=e=>({extract:(s,o)=>qH(s,o,e),toString:()=>`obj{
`+ve(e,o=>G0(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),X0=e=>({extract:(s,o)=>{const r=ve(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return FH.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),KH=e=>jd(t=>e(t).fold(gt.serror,gt.svalue)),GH=(e,t,n)=>{const s=t.extract([e],n);return gt.mapError(s,o=>({input:n,errors:o}))},YH=(e,t,n)=>gt.toResult(GH(e,t,n)),XH=e=>`Errors: 
`+xH(e.errors).join(`
`)+`

Input object: `+Wd(e.input),Q0=(e,t)=>PH(e,si(t,qd)),QH=K(zH),zl=(e,t)=>jd(n=>{const s=typeof n;return e(n)?gt.svalue(n):gt.serror(`Expected type: ${t} but got: ${s}`)}),ZH=zl(Sn,"number"),Hl=zl(q,"string"),JH=zl(Ws,"boolean"),Kd=zl(Ce,"function"),Ua=MH,Z0=UH,eV=e=>KH(t=>Te(e,t)?Ot.value(t):Ot.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),J0=(e,t)=>Ua(e,e,j0(),t),eS=e=>J0(e,Hl),tS=e=>J0(e,Kd),tV=(e,t)=>Ua(e,e,j0(),X0(t)),Gd=(e,t)=>Ua(e,e,LH(),t),Vl=e=>Gd(e,Hl),nV=e=>Gd(e,Kd),sV=(e,t)=>Ua(e,e,q0(t),QH()),yr=(e,t,n)=>Ua(e,e,q0(t),n),nS=(e,t)=>yr(e,t,ZH),oV=(e,t)=>yr(e,t,Hl),sS=(e,t,n)=>yr(e,t,eV(n)),Yd=(e,t)=>yr(e,t,JH),Xd=(e,t)=>yr(e,t,Kd),rV=(e,t,n)=>yr(e,t,X0(n)),aV=eS("type"),iV=tS("fetch"),Qd=tS("onAction"),lV=Xd("onSetup",()=>de),cV=Vl("text"),uV=Vl("icon"),fV=Vl("tooltip"),dV=Vl("label"),mV=Yd("active",!1),gV=Yd("enabled",!0),oS=Yd("primary",!1),pV=e=>sV("columns",e),za=e=>oV("type",e),hV=qd([aV,eS("trigger"),nS("minChars",1),pV(1),nS("maxResults",10),nV("matches"),iV,Qd,rV("highlightOn",[],Hl)]),bV=e=>YH("Autocompleter",hV,{trigger:e.ch,...e}),Zd=[gV,fV,uV,cV,lV],rS=[mV].concat(Zd),vV=[Xd("predicate",ze),sS("scope","node",["node","editor"]),sS("position","selection",["node","selection","line"])],CV=Zd.concat([za("contextformbutton"),oS,Qd,Z0("original",Dt)]),yV=rS.concat([za("contextformbutton"),oS,Qd,Z0("original",Dt)]),EV=Zd.concat([za("contextformbutton")]),SV=rS.concat([za("contextformtogglebutton")]),wV=Q0("type",{contextformbutton:CV,contextformtogglebutton:yV});qd([za("contextform"),Xd("initValue",K("")),dV,tV("commands",wV),Gd("launch",Q0("type",{contextformbutton:EV,contextformtogglebutton:SV}))].concat(vV));const kV=e=>{const t=e.ui.registry.getAll().popups,n=si(t,a=>bV(a).fold(i=>{throw new Error(XH(i))},Dt)),s=Um(Cc(n,a=>a.trigger)),o=yc(n);return{dataset:n,triggers:s,lookupByTrigger:a=>oe(o,i=>i.trigger===a)}},xV=(e,t)=>{const n=iu(t.load,50);e.on("keypress compositionend",s=>{s.which!==27&&n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27&&t.cancelIfNecessary()}),e.on("remove",n.cancel)},NV=e=>{const t=As(),n=ct(!1),s=t.isSet,o=()=>{s()&&(mF(e),x1(e),n.set(!1),t.clear())},r=c=>{s()||(dF(e,c.range),t.set({trigger:c.trigger,matchLength:c.text.length}))},a=Ys(()=>kV(e)),i=c=>t.get().map(f=>F0(e.dom,e.selection.getRng(),f.trigger).bind(u=>z0(e,a,u,c))).getOrThunk(()=>CH(e,a)),l=c=>{i(c).fold(o,f=>{r(f.context),f.lookupData.then(u=>{t.get().map(d=>{const p=f.context;d.trigger===p.trigger&&(p.text.length-d.matchLength>=10?o():(t.set({...d,matchLength:p.text.length}),n.get()?k1(e,{lookupData:u}):(n.set(!0),w1(e,{lookupData:u}))))})})})};e.addCommand("mceAutocompleterReload",(c,f)=>{const u=Ye(f)?f.fetchOptions:{};l(u)}),e.addCommand("mceAutocompleterClose",o),xV(e,{cancelIfNecessary:o,load:l})},aS=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:de,inputType:n},a=pp(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},Jd=aS("input"),em=aS("beforeinput"),_V=(e,t,n)=>{const s=n.keyCode===Y.BACKSPACE?"deleteContentBackward":"deleteContentForward";b0([{keyCode:Y.BACKSPACE,action:ae(t0,e)},{keyCode:Y.BACKSPACE,action:ae(wd,e,!1)},{keyCode:Y.DELETE,action:ae(wd,e,!0)},{keyCode:Y.BACKSPACE,action:ae(yd,e,!1)},{keyCode:Y.DELETE,action:ae(yd,e,!0)},{keyCode:Y.BACKSPACE,action:ae(Dd,e,t,!1)},{keyCode:Y.DELETE,action:ae(Dd,e,t,!0)},{keyCode:Y.BACKSPACE,action:ae(Af,e,!1)},{keyCode:Y.DELETE,action:ae(Af,e,!0)},{keyCode:Y.BACKSPACE,action:ae(kd,e,!1)},{keyCode:Y.DELETE,action:ae(kd,e,!0)},{keyCode:Y.BACKSPACE,action:ae(Id,e,!1)},{keyCode:Y.DELETE,action:ae(Id,e,!0)},{keyCode:Y.BACKSPACE,action:ae(vd,e,!1)},{keyCode:Y.DELETE,action:ae(vd,e,!0)},{keyCode:Y.BACKSPACE,action:ae(bd,e,!1)},{keyCode:Y.DELETE,action:ae(bd,e,!0)},{keyCode:Y.BACKSPACE,action:ae(Bd,e,!1)},{keyCode:Y.DELETE,action:ae(Bd,e,!0)}],n).filter(o=>e.selection.isEditable()).each(o=>{n.preventDefault(),em(e,s).isDefaultPrevented()||(o(),Jd(e,s))})},AV=(e,t,n)=>{const s=Cs(),o=s.os,r=s.browser,a=o.isMacOS()?[{keyCode:Y.BACKSPACE,altKey:!0,action:ae($a,e)},{keyCode:Y.DELETE,altKey:!0,action:ae($a,e)}]:[{keyCode:Y.BACKSPACE,ctrlKey:!0,action:ae($a,e)},{keyCode:Y.DELETE,ctrlKey:!0,action:ae($a,e)}];o.isMacOS()&&n&&a.push({keyCode:r.isFirefox()?224:91,action:ae($a,e)}),Fa([{keyCode:Y.BACKSPACE,action:ae(dE,e)},{keyCode:Y.DELETE,action:ae(dE,e)},...a],t)},RV=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===Y.BACKSPACE,s.isDefaultPrevented()||_V(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||AV(e,s,n),n=!1})},TV=e=>{for(;e;){if(H(e)||P(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},Ha=(e,t)=>{const n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const r=TV(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(mt),t.firstChild)}const o=n.createRng();if(t.normalize(),t.hasChildNodes()){const r=new it(t,t);let a=t,i;for(;i=r.current();){if(P(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else We(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),Ea(e,o)},Wl=(e,t)=>{const n=e.getRoot();let s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";)e.getContentEditable(o)==="true"&&(s=o),o=o.parentNode;return o!==n?s:n},tm=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),PV=e=>tm(e).fold(K(""),t=>t.nodeName.toUpperCase()),DV=e=>tm(e).filter(t=>Yr(v.fromDom(t))).isSome(),BV=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,OV=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},iS=(e,t)=>{const n=e==null?void 0:e.parentNode;return z(n)&&n.nodeName===t},lS=e=>z(e)&&/^(OL|UL|LI)$/.test(e.nodeName),IV=e=>z(e)&&/^(LI|DT|DD)$/.test(e.nodeName),LV=e=>lS(e)&&lS(e.parentNode),jl=e=>{const t=e.parentNode;return IV(t)?t:e},ql=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!H(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},$V=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;LV(n)&&(o="LI");let l=t(o);if(ql(n,s,!0)&&ql(n,s,!1))if(iS(n,"LI")){const c=jl(n);r.insertAfter(l,c),OV(n)?r.remove(c):r.remove(n)}else r.replace(l,n);else if(ql(n,s,!0))iS(n,"LI")?(r.insertAfter(l,jl(n)),l.appendChild(r.doc.createTextNode(" ")),l.appendChild(n)):i.insertBefore(l,n),r.remove(s);else if(ql(n,s,!1))r.insertAfter(l,jl(n)),r.remove(s);else{n=jl(n);const c=a.cloneRange();c.setStartAfter(s),c.setEndAfter(n);const f=c.extractContents();o==="LI"&&BV(f,"LI")?(l=f.firstChild,r.insertAfter(f,n)):(r.insertAfter(f,n),r.insertAfter(l,n)),r.remove(s)}Ha(e,l)},FV=e=>{B(Fg(v.fromDom(e),Zt),t=>{const n=t.dom;n.nodeValue=fs(n.data)})},MV=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},UV=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),nm=e=>{e.innerHTML='<br data-mce-bogus="1">'},sm=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,om=(e,t)=>z(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",zV=(e,t,n)=>{var s;const o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;H(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||UV(e,r))&&e.remove(r)},rm=(e,t,n)=>P(t)?e?n===1&&t.data.charAt(n-1)===yt?0:n:n===t.data.length-1&&t.data.charAt(n)===yt?t.data.length:n:n,HV=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,rm(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,rm(!1,e.endContainer,e.endOffset)),t},VV=e=>{let t=e;do P(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},WV=(e,t,n)=>{const s=e.dom;m.from(n.style).map(s.parseStyle).each(l=>{const f={..._g(v.fromDom(t)),...l};s.setStyles(t,f)});const o=m.from(n.class).map(l=>l.split(/\s+/)),r=m.from(t.className).map(l=>oe(l.split(/\s+/),c=>c!==""));Bt(o,r,(l,c)=>{const f=oe(c,d=>!Te(l,d)),u=[...l,...f];s.setAttrib(t,"class",u.join(" "))});const a=["style","class"],i=Or(n,(l,c)=>!Te(a,c));s.setAttribs(t,i)},Va=(e,t)=>{if(Kt(e).toLowerCase()===t.tagName.toLowerCase()){const s=ca(e);WV(e,t,s)}},jV=(e,t,n,s,o)=>{var r,a;const i=e.dom,l=(r=Wl(i,s))!==null&&r!==void 0?r:i.getRoot();let c=i.getParent(s,i.isBlock);if(!c||!om(i,c)){if(c=c||l,!c.hasChildNodes()){const p=i.create(t);return Va(e,p),c.appendChild(p),n.setStart(p,0),n.setEnd(p,0),p}let f=s;for(;f&&f.parentNode!==c;)f=f.parentNode;let u;for(;f&&!i.isBlock(f);)u=f,f=f.previousSibling;const d=(a=u==null?void 0:u.parentElement)===null||a===void 0?void 0:a.nodeName;if(u&&d&&e.schema.isValidChild(d,t.toLowerCase())){const p=u.parentNode,b=i.create(t);for(Va(e,b),p.insertBefore(b,u),f=u;f&&!i.isBlock(f);){const g=f.nextSibling;b.appendChild(f),f=g}n.setStart(s,o),n.setEnd(s,o)}}return s},qV=(e,t)=>{t.normalize();const n=t.lastChild;(!n||H(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},KV=(e,t)=>{const n=FA(e);return Je(t)?!1:q(n)?Te(L.explode(n),t.nodeName.toLowerCase()):n},cS={insert:(e,t)=>{let n,s,o,r,a=!1;const i=e.dom,l=e.schema,c=l.getNonEmptyElements(),f=e.selection.getRng(),u=Kt(e),d=$=>{let I=n;const N=l.getTextInlineElements();let x;$||o==="TABLE"||o==="HR"?x=i.create($||u):x=C.cloneNode(!1);let U=x;if($A(e)===!1)i.setAttrib(x,"style",null),i.setAttrib(x,"class",null);else do if(N[I.nodeName]){if(vn(I)||rn(I))continue;const X=I.cloneNode(!1);i.setAttrib(X,"id",""),x.hasChildNodes()?(X.appendChild(x.firstChild),x.appendChild(X)):(U=X,x.appendChild(X))}while((I=I.parentNode)&&I!==y);return Va(e,x),nm(U),x},p=$=>{const I=rm($,n,s);if(P(n)&&($?I>0:I<n.data.length))return!1;if(n.parentNode===C&&a&&!$||$&&H(n)&&n===C.firstChild)return!0;if(sm(n,"TABLE")||sm(n,"HR"))return a&&!$||!a&&$;const N=new it(n,C);P(n)&&($&&I===0?N.prev():!$&&I===n.data.length&&N.next());let x;for(;x=N.current();){if(H(x)){if(!x.getAttribute("data-mce-bogus")){const U=x.nodeName.toLowerCase();if(c[U]&&U!=="br")return!1}}else if(P(x)&&!ro(x.data))return!1;$?N.prev():N.next()}return!0},b=()=>{let $;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&E!=="HGROUP"?$=d(u):$=d(),KV(e,r)&&om(i,r)&&i.isEmpty(C)?$=i.split(r,C):i.insertAfter($,C),Ha(e,$),$};nl(i,f).each($=>{f.setStart($.startContainer,$.startOffset),f.setEnd($.endContainer,$.endOffset)}),n=f.startContainer,s=f.startOffset;const g=!!(t&&t.shiftKey),h=!!(t&&t.ctrlKey);H(n)&&n.hasChildNodes()&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&P(n)?s=n.data.length:s=0);const y=Wl(i,n);if(!y||MV(e,n))return;g||(n=jV(e,u,f,n,s));let C=i.getParent(n,i.isBlock)||i.getRoot();r=z(C==null?void 0:C.parentNode)?i.getParent(C.parentNode,i.isBlock):null,o=C?C.nodeName.toUpperCase():"";const E=r?r.nodeName.toUpperCase():"";if(E==="LI"&&!h){const $=r;C=$,r=$.parentNode,o=E}if(/^(LI|DT|DD)$/.test(o)&&H(r)&&i.isEmpty(C)){$V(e,d,r,C,u);return}if(C===e.getBody()||!om(i,C))return;const S=C.parentNode;let R;if(Jo(C))R=Wc(C),i.isEmpty(C)&&nm(C),Va(e,R),Ha(e,R);else if(p(!1))R=b();else if(p(!0)&&S)R=S.insertBefore(d(),C),Ha(e,sm(C,"HR")?R:C);else{const $=HV(f).cloneRange();$.setEndAfter(C);const I=$.extractContents();FV(I),VV(I),R=I.firstChild,i.insertAfter(I,C),zV(i,c,R),qV(i,C),i.isEmpty(C)&&nm(C),R.normalize(),i.isEmpty(R)?(i.remove(R),b()):(Va(e,R),Ha(e,R))}i.setAttrib(R,"id",""),e.dispatch("NewBlock",{newBlock:R})},fakeEventName:"insertParagraph"},GV=(e,t,n)=>{const s=new it(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||P(o)&&o.length>0)return!0;return!1},uS=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),Ea(e,s)},YV=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a=!1;nl(s,o).each(p=>{o.setStart(p.startContainer,p.startOffset),o.setEnd(p.endContainer,p.endOffset)});let i=o.startOffset,l=o.startContainer;if(H(l)&&l.hasChildNodes()){const p=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,p&&P(l)?i=l.data.length:i=0}let c=s.getParent(l,s.isBlock);const f=c&&c.parentNode?s.getParent(c.parentNode,s.isBlock):null,u=f?f.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);u==="LI"&&!d&&(c=f),P(l)&&i>=l.data.length&&(GV(e.schema,l,c||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),du(s,o,r),uS(e,r,a),e.undoManager.add()},XV=(e,t)=>{const n=v.fromTag("br");en(v.fromDom(t),n),e.undoManager.add()},QV=(e,t)=>{JV(e.getBody(),t)||Ss(v.fromDom(t),v.fromTag("br"));const n=v.fromTag("br");Ss(v.fromDom(t),n),uS(e,n.dom,!1),e.undoManager.add()},ZV=e=>We(e.getNode()),JV=(e,t)=>ZV(A.after(t))?!0:zt(e,A.after(t)).map(n=>We(n.getNode())).getOr(!1),fS=e=>e&&e.nodeName==="A"&&"href"in e,e3=e=>e.fold(ze,fS,fS,ze),t3=e=>{const t=G(ko,e),n=A.fromRangeStart(e.selection.getRng());return Jn(t,e.getBody(),n).filter(e3)},n3=(e,t)=>{t.fold(de,G(XV,e),G(QV,e),de)},dS={insert:(e,t)=>{const n=t3(e);n.isSome()?n.each(G(n3,e)):YV(e,t)},fakeEventName:"insertLineBreak"},mS=(e,t)=>tm(e).filter(n=>t.length>0&&wn(v.fromDom(n),t)).isSome(),s3=e=>mS(e,IA(e)),o3=e=>mS(e,LA(e)),fn=Wn.generate([{br:[]},{block:[]},{none:[]}]),r3=(e,t)=>o3(e),gS=e=>(t,n)=>DV(t)===e,pS=(e,t)=>(n,s)=>PV(n)===e.toUpperCase()===t,a3=e=>{const t=Wl(e.dom,e.selection.getStart());return Je(t)},Wa=e=>pS("pre",e),i3=()=>pS("summary",!0),Kl=e=>(t,n)=>BA(t)===e,l3=(e,t)=>s3(e),Gl=(e,t)=>t,c3=e=>{const t=Kt(e),n=Wl(e.dom,e.selection.getStart());return z(n)&&e.schema.isValidChild(n.nodeName,t)},Cn=(e,t)=>(n,s)=>Wt(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),u3=(e,t)=>vE([Cn([r3],fn.none()),Cn([Wa(!0),a3],fn.none()),Cn([i3()],fn.br()),Cn([Wa(!0),Kl(!1),Gl],fn.br()),Cn([Wa(!0),Kl(!1)],fn.block()),Cn([Wa(!0),Kl(!0),Gl],fn.block()),Cn([Wa(!0),Kl(!0)],fn.br()),Cn([gS(!0),Gl],fn.br()),Cn([gS(!0)],fn.block()),Cn([l3],fn.br()),Cn([Gl],fn.br()),Cn([c3],fn.block())],[e,!!(t&&t.shiftKey)]).getOr(fn.none()),Yl=(e,t,n)=>{t.selection.isCollapsed()||bB(t),!(z(n)&&em(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),z(n)&&Jd(t,e.fakeEventName))},hS=(e,t)=>{const n=()=>Yl(dS,e,t),s=()=>Yl(cS,e,t),o=u3(e,t);switch(OA(e)){case"linebreak":o.fold(n,n,de);break;case"block":o.fold(s,s,de);break;case"invert":o.fold(s,n,de);break;default:o.fold(n,s,de);break}},f3=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),k$(e.undoManager),e.undoManager.transact(()=>{hS(e,t)}))},d3=e=>{e.on("keydown",t=>{t.keyCode===Y.ENTER&&f3(e,t)})},m3=(e,t,n)=>{const s=be.os.isMacOS()||be.os.isiOS();Fa([{keyCode:Y.END,action:ae(m0,e,!0)},{keyCode:Y.HOME,action:ae(m0,e,!1)},...s?[]:[{keyCode:Y.HOME,action:ae(Ll,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:Y.END,action:ae(Ll,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:Y.END,action:ae(y0,e,!0)},{keyCode:Y.HOME,action:ae(y0,e,!1)},{keyCode:Y.END,action:ae(Il,e,!0,t)},{keyCode:Y.HOME,action:ae(Il,e,!1,t)}],n).each(o=>{n.preventDefault()})},g3=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||m3(e,t,n)})},p3=e=>{e.on("input",t=>{t.isComposing||YD(e)})},h3=Cs(),b3=(e,t,n)=>{Fa([{keyCode:Y.PAGE_UP,action:ae(Il,e,!1,t)},{keyCode:Y.PAGE_DOWN,action:ae(Il,e,!0,t)}],n)},bS=e=>e.stopImmediatePropagation(),vS=e=>e.keyCode===Y.PAGE_UP||e.keyCode===Y.PAGE_DOWN,CS=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",bS,!0):!n&&e.get()&&t.off("NodeChange",bS),e.set(n)},v3=(e,t)=>{if(h3.os.isMacOS())return;const n=ct(!1);e.on("keydown",s=>{vS(s)&&CS(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||b3(e,t,s),vS(s)&&n.get()&&(CS(n,e,!1),e.nodeChanged())})},yS=(e,t)=>{const n=t.container(),s=t.offset();return P(n)?(n.insertData(s,e),m.some(A(n,s+e.length))):zi(t).map(o=>{const r=v.fromText(e);return t.isAtEnd()?Ss(o,r):en(o,r),A(r.dom,e.length)})},C3=G(yS,mt),y3=G(yS," "),E3=e=>t=>t.fold(n=>on(e.dom,A.before(n)),n=>It(n),n=>Gn(n),n=>zt(e.dom,A.after(n))),S3=(e,t)=>n=>VD(e,n)?C3(t):y3(t),w3=e=>t=>(e.selection.setRng(t.toRange()),e.nodeChanged(),!0),k3=e=>{const t=A.fromRangeStart(e.selection.getRng()),n=v.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=G(ko,e),o=A.fromRangeStart(e.selection.getRng());return Jn(s,e.getBody(),o).bind(E3(n)).map(r=>()=>S3(n,t)(r).each(w3(e)))}else return m.none()},x3=(e,t)=>{b0([{keyCode:Y.SPACEBAR,action:ae(k3,e)}],t).each(n=>{t.preventDefault(),em(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),Jd(e,"insertText",{data:" "}))})},N3=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||x3(e,t)})},_3=e=>jR(e)?[{keyCode:Y.TAB,action:ae(O0,e,!0)},{keyCode:Y.TAB,shiftKey:!0,action:ae(O0,e,!1)}]:[],A3=(e,t)=>{Fa([..._3(e)],t).each(n=>{t.preventDefault()})},R3=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||A3(e,t)})},T3=e=>{if(e.addShortcut("Meta+P","","mcePrint"),NV(e),Zn(e))return ct(null);{const t=Ez(e);return b2(e),lH(e,t),RV(e,t),d3(e),N3(e),p3(e),R3(e),g3(e,t),v3(e,t),t}};class P3{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!Gu(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);o&&Gi(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&Gi(t)&&(t.selection.getNode().nodeName==="IMG"?ln.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor.selection;let s;if(this.editor.initialized&&n&&!mR(this.editor)&&!this.editor.mode.isReadOnly()){const o=this.editor.getBody();s=n.getStart(!0)||o,(s.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(s,o))&&(s=o);const r=[];this.editor.dom.getParent(s,a=>a===o?!0:(r.push(a),!1)),this.editor.dispatch("NodeChange",{...t,element:s,parents:r})}}isSameElementPath(t){let n;const s=this.editor,o=Br(s.dom.getParents(t,et,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const ES="x-tinymce/html",Xl=K(ES),am="<!-- "+ES+" -->",D3=e=>am+e,B3=e=>e.replace(am,""),SS=e=>e.indexOf(am)!==-1,O3=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),I3=(e,t)=>{let n="<"+e;const s=Cc(t,(o,r)=>r+'="'+Ns.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},L3=(e,t,n)=>{const s=e.split(/\n\n/),o=I3(t,n),r="</"+t+">",a=ve(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:ve(a,i).join("")},wS="%MCEPASTEBIN%",$3=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},wS);be.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},F3=(e,t)=>{const n=e.dom;if(im(e)){let s;const o=t.get();for(;s=im(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},im=e=>e.dom.get("mcepastebin"),M3=e=>z(e)&&e.id==="mcepastebin",U3=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=oe(e.getBody().childNodes,M3);B(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},kS=e=>e===wS,z3=e=>{const t=ct(null);return{create:()=>$3(e,t),remove:()=>F3(e,t),getEl:()=>im(e),getHtml:()=>U3(e),getLastRng:t.get}},xS=(e,t)=>(L.each(t,n=>{ft(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),H3=e=>{const t=_s(),n=pr({},t);let s="";const o=t.getVoidElements(),r=L.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{const c=l.name,f=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())){let u=l.firstChild;if(u)do i(u);while(u=u.next)}a[c]&&f.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=xS(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},NS=e=>(e=xS(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":mt],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),V3=e=>{let t=0;return()=>e+t++},W3=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return L.hasOwn(n,t)?"image/"+n[t]:"image/"+t},j3=(e,t)=>{const n=pr({sanitize:Eu(e)},e.schema);n.addNodeFilter("meta",o=>{L.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Bs({validate:!0},e.schema).serialize(s)},_S=(e,t)=>({content:e,cancelled:t}),q3=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=_1(e,s,n);return _S(o.node.innerHTML,o.isDefaultPrevented())},K3=(e,t,n)=>{const s=N1(e,t,n),o=j3(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?q3(e,o,n):_S(o,s.isDefaultPrevented())},G3=(e,t,n)=>K3(e,t,n),lm=(e,t)=>(e.insertContent(t,{merge:TR(e),paste:!0}),!0),cm=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),Y3=(e,t)=>cm(t)&&Xe(Eh(e),n=>Km(t.toLowerCase(),`.${n.toLowerCase()}`)),X3=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),Q3=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),Z3=(e,t,n)=>!e.selection.isCollapsed()&&cm(t)?Q3(e,t,n):!1,J3=(e,t,n)=>Y3(e,t)?X3(e,t,n):!1,eW=(e,t)=>{L.each([Z3,J3,lm],n=>!n(e,t,lm))},tW=(e,t,n)=>{n||!PR(e)?lm(e,t):eW(e,t)},nW=V3("mceclip"),AS=(e,t,n,s)=>{const o=G3(e,t,n);o.cancelled||tW(e,o.content,s)},Ql=(e,t,n)=>{const s=n||SS(t);AS(e,B3(t),s,!1)},um=(e,t)=>{const n=e.dom.encode(t).replace(/\r\n/g,`
`),s=Zg(n,BR(e)),o=L3(s,Kt(e),ca(e));AS(e,o,!1,!0)},RS=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},Ms=(e,t)=>t in e&&e[t].length>0,TS=e=>Ms(e,"text/html")||Ms(e,"text/plain"),sW=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return z(n)?e.dom.encode(n[1]):void 0},oW=(e,t,n,s)=>{const o=nW(),r=uh(e)&&z(n.name),a=r?sW(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},rW=(e,t)=>{Yf(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l??oW(e,i,a,r);Ql(e,`<img src="${c.blobUri()}">`,!1)})},aW=e=>e.type==="paste",iW=e=>Promise.all(ve(e,t=>jC(t).then(n=>({file:t,uri:n})))),lW=e=>{const t=Eh(e);return n=>bt(n.type,"image/")&&Xe(t,s=>W3(s)===n.type)},cW=(e,t)=>{const n=t.items?Fn(jt(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?jt(t.files):[];return oe(n.length>0?n:s,lW(e))},PS=(e,t,n)=>{const s=aW(t)?t.clipboardData:t.dataTransfer;if(Mi(e)&&s){const o=cW(e,s);if(o.length>0)return t.preventDefault(),iW(o).then(r=>{n&&e.selection.setRng(n),B(r,a=>{rW(e,a)})}),!0}return!1},uW=e=>{var t,n;return be.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},fW=e=>Y.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,fm=(e,t,n,s)=>{let o=NS(n);const r=Ms(t,Xl())||SS(n),a=!r&&O3(o),i=cm(o);(kS(o)||!o.length||a&&!i)&&(s=!0),(s||i)&&(Ms(t,"text/plain")&&a?o=t["text/plain"]:o=H3(o)),!kS(o)&&(s?um(e,o):Ql(e,o,r))},dW=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{fW(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||uW(r))return;const a=n.get()==="text"||s;s=!1;const i=RS(r.clipboardData);!TS(i)&&PS(e,r,o())||(Ms(i,"text/html")?(r.preventDefault(),fm(e,i,i["text/html"],a)):Ms(i,"text/plain")&&Ms(i,"text/uri-list")?(r.preventDefault(),fm(e,i,i["text/plain"],a)):(t.create(),ln.setEditorTimeout(e,()=>{const l=t.getHtml();t.remove(),fm(e,i,l,a)},0)))})},mW=e=>{const t=o=>bt(o,"webkit-fake-url"),n=o=>bt(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!Mi(e)&&s(a))for(const i of o){const l=i.attr("src");q(l)&&!i.attr("data-mce-object")&&l!==be.transparentSrc&&(t(l)||!OR(e)&&n(l))&&i.remove()}})},gW=(e,t,n)=>{dW(e,t,n),mW(e)},pW=(e,t)=>{t.get()==="text"?(t.set("html"),Sb(e,!1)):(t.set("text"),Sb(e,!0)),e.focus()},hW=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{pW(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&Ql(e,s.html,s.internal),s.text&&um(e,s.text)})},bW=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Xl(),t),!0}catch{return!1}else return!1},DS=(e,t,n,s)=>{bW(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},BS=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const l=s.createRng();l.selectNodeContents(a),o.setRng(l),ln.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},OS=e=>({html:D3(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),vW=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),IS=e=>!e.selection.isCollapsed()||vW(e),CW=e=>t=>{!t.isDefaultPrevented()&&IS(e)&&DS(t,OS(e),BS(e),()=>{if(be.browser.isChromium()||be.browser.isFirefox()){const n=e.selection.getRng();ln.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},yW=e=>t=>{!t.isDefaultPrevented()&&IS(e)&&DS(t,OS(e),BS(e),de)},EW=e=>{e.on("cut",CW(e)),e.on("copy",yW(e))},LS=(e,t)=>{var n,s;return Eo.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},SW=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},$S=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},wW=e=>Xe(e.files,t=>/^image\//.test(t.type)),kW=(e,t,n,s)=>{const o=e.getParent(n,r=>ao(t,r));if(o&&le(s,"text/html")){const r=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!hn(r.querySelector(o.nodeName.toLowerCase()))}else return!1},xW=(e,t)=>{xR(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),Mi(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&wW(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;const s=LS(e,n);if(Je(s))return;const o=RS(n.dataTransfer),r=Ms(o,Xl());if((!TS(o)||SW(o))&&PS(e,n,s))return;const a=o[Xl()],i=a||o["text/html"]||o["text/plain"],l=kW(e.dom,e.schema,s.startContainer,o);t.get()&&!l||i&&(n.preventDefault(),ln.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{a&&e.execCommand("Delete"),$S(e,s);const c=NS(i);o["text/html"]?Ql(e,c,r):um(e,c)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{Mi(e)&&!t.get()&&(n.preventDefault(),$S(e,LS(e,n))),n.type==="dragend"&&t.set(!1)})},NW=e=>{const t=o=>r=>{o(e,r)},n=NR(e);Ce(n)&&e.on("PastePreProcess",t(n));const s=_R(e);Ce(s)&&e.on("PastePostProcess",t(s))},_W=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},AW=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,FS=e=>L.trim(e).replace(AW,Ki).toLowerCase(),RW=(e,t,n)=>{const s=AR(e);if(n||s==="all"||!RR(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,f)=>{const u=r.parseStyle(r.decode(c)),d={};for(let b=0;b<o.length;b++){const g=u[o[b]];let h=g,y=r.getStyle(a,o[b],!0);/color/.test(o[b])&&(h=FS(h),y=FS(y)),y!==h&&(d[o[b]]=g)}const p=r.serializeStyle(d,"span");return p?l+' style="'+p+'"'+f:l+f})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},TW=e=>{(be.browser.isChromium()||be.browser.isSafari())&&_W(e,RW)},PW=e=>{const t=ct(!1),n=ct(DR(e)?"text":"html"),s=z3(e);TW(e),hW(e,n),NW(e),e.on("PreInit",()=>{EW(e),xW(e,t),gW(e,s,n)})},DW=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},BW=e=>{e.parser.addNodeFilter("details",t=>{B(t,n=>{n.attr("data-mce-open",n.attr("open")),n.attr("open","open")})}),e.serializer.addNodeFilter("details",t=>{B(t,n=>{const s=n.attr("data-mce-open");n.attr("open",q(s)?s:null),n.attr("data-mce-open",null)})})},OW=e=>{DW(e),BW(e)},IW=We,MS=P,LW=e=>De(e.dom),$W=e=>Nn(e.dom),US=e=>t=>ye(v.fromDom(e),t),FW=(e,t)=>Zs(v.fromDom(e),n=>$W(n)||tn(n),US(t)).getOr(v.fromDom(t)).dom,zS=(e,t)=>Zs(v.fromDom(e),LW,US(t)),HS=(e,t,n)=>{const s=new it(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!IW(a);a=o())bn(a)&&(r=a);return r},MW=(e,t)=>{const s=A.fromRangeStart(e).getNode(),o=FW(s,t),r=HS(s,o,!1),a=HS(s,o,!0),i=document.createRange();return zS(r,o).fold(()=>{MS(r)?i.setStart(r,0):i.setStartBefore(r)},l=>i.setStartBefore(l.dom)),zS(a,o).fold(()=>{MS(a)?i.setEnd(a,a.data.length):i.setEndAfter(a)},l=>i.setEndAfter(l.dom)),i},UW=e=>{const t=MW(e.selection.getRng(),e.getBody());e.selection.setRng(Bf(t))},zW=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),UW(e))})};var Er;(function(e){e.Before="before",e.After="after"})(Er||(Er={}));const HW=(e,t)=>Math.abs(e.left-t),VW=(e,t)=>Math.abs(e.right-t),WW=(e,t)=>e>=t.top&&e<=t.bottom,jW=(e,t)=>e.top<t.bottom&&e.bottom>t.top,qW=(e,t)=>{const n=G_(e,t)/Math.min(e.height,t.height);return jW(e,t)&&n>.5},KW=(e,t)=>{const n=oe(e,s=>WW(t,s));return K_(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=Tr(e,a=>qW(a,s));return[o,r]})},GW=(e,t)=>({node:e.node,position:HW(e,t)<VW(e,t)?Er.Before:Er.After}),YW=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),dm=(e,t,n)=>{const s=f=>bn(f.node)?m.some(f):H(f.node)?dm(jt(f.node.childNodes),t,n):m.none(),o=(f,u)=>{if(f.length>=2){const d=s(f[0]).getOr(f[0]),p=s(f[1]).getOr(f[1]);if(Math.abs(u(d,t,n)-u(p,t,n))<2){if(P(d.node))return m.some(d);if(P(p.node))return m.some(p)}}return m.none()},r=(f,u)=>{const d=qs(f,(p,b)=>u(p,t,n)-u(b,t,n));return o(d,u).orThunk(()=>Vo(d,s))},[a,i]=KW(PE(e),n),{pass:l,fail:c}=Tr(i,f=>f.top<n);return r(a,YW).orThunk(()=>r(c,Bp)).orThunk(()=>r(l,Bp))},XW=(e,t,n,s)=>{const o=(r,a)=>{const i=c=>H(c)&&c.classList.contains("mce-drag-container"),l=oe(r.dom.childNodes,ei(i));return a.fold(()=>dm(l,n,s),c=>{const f=oe(l,u=>u!==c.dom);return dm(f,n,s)}).orThunk(()=>(ye(r,e)?m.none():Tc(r)).bind(f=>o(f,m.some(r))))};return o(t,m.none())},QW=(e,t,n)=>{const s=v.fromDom(e),o=is(s),a=v.fromPoint(o,t,n).filter(i=>as(s,i)).getOr(s);return XW(s,a,t,n)},VS=(e,t,n)=>QW(e,t,n).filter(s=>da(s.node)).map(s=>GW(s,t)),WS=e=>{var t,n;const s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},ZW=e=>e.inline?WS(e.getBody()):{left:0,top:0},JW=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},ej=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},tj=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=WS(e.getContentAreaContainer()),s=ej(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},nj=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),sj=(e,t)=>nj(ZW(e),JW(e),tj(e,t)),oj=(e,t,n)=>({...t,dataTransfer:null,type:e,...n}),rj=(e,t)=>{const n=Om("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,srcElement:null,target:null,timeStamp:0,type:e,composedPath:n,initEvent:n,preventDefault:de,stopImmediatePropagation:de,stopPropagation:de,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:n,initMouseEvent:n,getModifierState:n,dataTransfer:null,...t}},jS=e=>({target:e,srcElement:e}),aj=e=>t=>rj(e,jS(t)),mm=e=>(t,n)=>oj(e,t,jS(n)),ij=mm("dragstart"),lj=mm("drop"),cj=aj("dragend"),qS=mm("dragend"),KS=32,uj=100,Zl=8,Jl=16,GS=De,fj=Z_(GS,Nn),dj=(e,t,n)=>GS(n)&&n!==t&&e.isEditable(n.parentElement),mj=(e,t,n)=>Je(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),gj=e=>{const t=e.cloneNode(!0);return t.removeAttribute("data-mce-selected"),t},pj=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},hj=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},ec=(e,t)=>n=>()=>{const s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},YS=ec("left",-32),XS=ec("left",KS),QS=ec("top",-32),ZS=ec("top",KS),bj=(e,t,n,s,o,r,a,i,l,c,f,u)=>{let d=0,p=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(p=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-p+"px";const b=l.clientHeight,g=l.clientWidth,h=a+l.getBoundingClientRect().top,y=i+l.getBoundingClientRect().left;f.on(C=>{C.intervalId.clear(),C.dragging&&u&&(a+Zl>=b?C.intervalId.set(ZS(c)):a-Zl<=0?C.intervalId.set(QS(c)):i+Zl>=g?C.intervalId.set(XS(c)):i-Zl<=0?C.intervalId.set(YS(c)):h+Jl>=window.innerHeight?C.intervalId.set(ZS(window)):h-Jl<=0?C.intervalId.set(QS(window)):y+Jl>=window.innerWidth?C.intervalId.set(XS(window)):y-Jl<=0&&C.intervalId.set(YS(window)))})},JS=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},vj=(e,t)=>{const n=e.getParent(t.parentNode,e.isBlock);JS(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&oo(v.fromDom(n))},Cj=e=>e.button===0,yj=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),Ej=(e,t)=>n=>{if(Cj(n)){const s=rt(t.dom.getParents(n.target),fj).getOr(null);if(z(s)&&dj(t.dom,t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:pj(t,s,s.offsetWidth,s.offsetHeight),intervalId:L_(uj)})}}},Sj=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),VS(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{const o=e._selectionOverrides.showCaret(1,s.node,s.position===Er.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},wj=(e,t)=>{const n=Bi((o,r)=>Sj(t,o,r),0);t.on("remove",n.cancel);const s=e;return o=>e.on(r=>{const a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){if(t.dispatch("dragstart",ij(o,r.element)).isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){const i=o.currentTarget===t.getDoc().documentElement,l=yj(r,sj(t,o));hj(r.ghost,t.getBody()),bj(r.ghost,l,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},kj=e=>{const t=e.getSel();if(z(t)){const s=t.getRangeAt(0).startContainer;return P(s)?s.parentNode:s}else return null},xj=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if(mj(t,kj(t.selection),s.element)){const r=gj(s.element),a=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();t.dispatch("drop",lj(n,a)).isDefaultPrevented()||t.undoManager.transact(()=>{vj(t.dom,s.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()})}t.dispatch("dragend",qS(n,t.getBody()))}}),tw(e)},ew=(e,t,n)=>{e.on(s=>{if(s.intervalId.clear(),s.dragging){const o=n.fold(()=>cj(s.element),r=>qS(r,s.element));t.dispatch("dragend",o)}}),tw(e)},Nj=(e,t)=>n=>ew(e,t,m.some(n)),tw=e=>{e.on(t=>{t.intervalId.clear(),JS(t.ghost)}),e.clear()},_j=e=>{const t=As(),n=_e.DOM,s=document,o=Ej(t,e),r=wj(t,e),a=xj(t,e),i=Nj(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===Y.ESC&&ew(t,e,m.none())})},Aj=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(Te(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&_l(e,"Dropped file type is not supported"))}},n=o=>{rl(e,o.target)&&t(o)},s=()=>{const o=_e.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];B(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{B(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{ln.setEditorTimeout(e,s,0)})},Rj=e=>{_j(e),pR(e)&&Aj(e)},Tj=e=>{const t=Bi(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=Cd(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},Pj=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if(Vn(n)){const s=xo(e.getBody(),n),o=De(s)?s:n;e.selection.getNode()!==o&&Ba(e,o).each(r=>e.selection.setRng(r))}})})},ja=De,nw=(e,t)=>xo(e.getBody(),t),Dj=e=>{const t=e.selection,n=e.dom,s=e.getBody(),o=sT(e,s,n.isBlock,()=>So(e)),r="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=I=>z(I)&&n.hasClass(I,"mce-offscreen-selection"),c=I=>I!==s&&(ja(I)||Vn(I))&&n.isChildOf(I,s)&&n.isEditable(I.parentNode),f=I=>{I&&t.setRng(I)},u=(I,N,x,U=!0)=>e.dispatch("ShowCaret",{target:N,direction:I,before:x}).isDefaultPrevented()?null:(U&&t.scrollIntoView(N,I===-1),o.show(x,N)),d=I=>{I.hasAttribute("data-mce-caret")&&(Wc(I),t.scrollIntoView(I))},p=()=>{e.on("click",N=>{n.isEditable(N.target)||(N.preventDefault(),e.focus())}),e.on("blur NewBlock",S),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",N=>{const x=N.target,U=nw(e,x);ja(U)?(N.preventDefault(),Ba(e,U).each(E)):c(x)&&Ba(e,x).each(E)},!0),e.on("mousedown",N=>{const x=N.target;if(x!==s&&x.nodeName!=="HTML"&&!n.isChildOf(x,s)||!uM(e,N.clientX,N.clientY))return;S(),$();const U=nw(e,x);ja(U)?(N.preventDefault(),Ba(e,U).each(E)):VS(s,N.clientX,N.clientY).each(X=>{N.preventDefault();const J=u(1,X.node,X.position===Er.Before,!1);f(J),H(U)?U.focus():e.getBody().focus()})}),e.on("keypress",N=>{Y.modifierPressed(N)||ja(t.getNode())&&N.preventDefault()}),e.on("GetSelectionRange",N=>{let x=N.range;if(i){if(!i.parentNode){i=null;return}x=x.cloneRange(),x.selectNode(i),N.range=x}}),e.on("SetSelectionRange",N=>{N.range=h(N.range);const x=E(N.range,N.forward);x&&(N.range=x)});const I=N=>H(N)&&N.id==="mcepastebin";e.on("AfterSetSelectionRange",N=>{const x=N.range,U=x.startContainer.parentElement;!g(x)&&!I(U)&&$(),l(U)||S()}),Rj(e),Tj(e),Pj(e)},b=I=>nn(I)||wi(I)||ki(I),g=I=>b(I.startContainer)||b(I.endContainer),h=I=>{const N=e.schema.getVoidElements(),x=n.createRng(),U=I.startContainer,X=I.startOffset,J=I.endContainer,re=I.endOffset;return le(N,U.nodeName.toLowerCase())?X===0?x.setStartBefore(U):x.setStartAfter(U):x.setStart(U,X),le(N,J.nodeName.toLowerCase())?re===0?x.setEndBefore(J):x.setEndAfter(J):x.setEnd(J,re),x},y=(I,N)=>{const x=v.fromDom(e.getBody()),U=e.getDoc(),X=qr(x,"#"+r).getOrThunk(()=>{const fe=v.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',U);return dt(fe,"id",r),at(x,fe),fe}),J=n.createRng();Yo(X),eo(X,[v.fromText(mt,U),v.fromDom(N),v.fromText(mt,U)]),J.setStart(X.dom.firstChild,1),J.setEnd(X.dom.lastChild,0),fi(X,{top:n.getPos(I,e.getBody()).y+"px"}),Hb(X);const re=t.getSel();return re&&(re.removeAllRanges(),re.addRange(J)),J},C=I=>{const N=I.cloneNode(!0),x=e.dispatch("ObjectSelected",{target:I,targetClone:N});if(x.isDefaultPrevented())return null;const U=y(I,x.targetClone),X=v.fromDom(I);return B(kt(v.fromDom(e.getBody()),`*[${a}]`),J=>{ye(X,J)||vt(J,a)}),n.getAttrib(I,a)||I.setAttribute(a,"1"),i=I,$(),U},E=(I,N)=>{if(!I)return null;if(I.collapsed){if(!g(I)){const J=N?1:-1,re=ha(J,s,I),fe=re.getNode(!N);if(z(fe)){if(da(fe))return u(J,fe,N?!re.isAtEnd():!1,!1);if(xs(fe)&&De(fe.nextSibling)){const Se=n.createRng();return Se.setStart(fe,0),Se.setEnd(fe,0),Se}}const he=re.getNode(N);if(z(he)){if(da(he))return u(J,he,N?!1:!re.isAtEnd(),!1);if(xs(he)&&De(he.previousSibling)){const Se=n.createRng();return Se.setStart(he,1),Se.setEnd(he,1),Se}}}return null}let x=I.startContainer,U=I.startOffset;const X=I.endOffset;if(P(x)&&U===0&&ja(x.parentNode)&&(x=x.parentNode,U=n.nodeIndex(x),x=x.parentNode),!H(x))return null;if(X===U+1&&x===I.endContainer){const J=x.childNodes[U];if(c(J))return C(J)}return null},S=()=>{i&&i.removeAttribute(a),qr(v.fromDom(e.getBody()),"#"+r).each(Fe),i=null},R=()=>{o.destroy(),i=null},$=()=>{o.hide()};return Zn(e)||p(),{showCaret:u,showBlockCaretContainer:d,hideFakeCaret:$,destroy:R}},Bj=(e,t)=>{let n=t;for(let s=e.previousSibling;P(s);s=s.previousSibling)n+=s.data.length;return n},sw=(e,t,n,s,o)=>{if(P(n)&&(s<0||s>n.data.length))return[];const r=o&&P(n)?[Bj(n,s)]:[s];let a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},gm=(e,t,n,s,o,r,a=!1)=>{const i=sw(e,t,n,s,a),l=sw(e,t,o,r,a);return{start:i,end:l}},ow=(e,t)=>{const n=t.slice(),s=n.pop();return Sn(s)?Wt(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>P(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},rw=(e,t)=>ow(e,t.start).bind(({node:n,offset:s})=>ow(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),Oj=(e,t,n,s=!1)=>gm(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),Sr=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t),Sr(e,s,n)}},tc=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(P(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),P(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),Sr(e,o,n),o!==r&&Sr(e,r,n))},pm=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),aw=(e,t,n)=>{const s=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:nh(s).concat(e.blockPatterns),inlinePatterns:sh(s).concat(e.inlinePatterns)}},iw=(e,t,n,s)=>{const o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},Ij=e=>/^\s[^\s]/.test(e),lw=(e,t,n)=>{uH(t,0,t).each(o=>{const r=o.container;I0(r,n.start.length,t).each(l=>{const c=e.createRng();c.setStart(r,0),c.setEnd(l.container,l.offset),tc(e,c,f=>f===t)});const a=v.fromDom(r),i=vi(a);Ij(i)&&rN(a,i.slice(1))})},Lj=(e,t)=>{const n=e.dom,s=t.pattern,o=rw(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),r=(a,i)=>{const l=i.get(a);return ot(l)&&Mt(l).exists(c=>le(c,"block"))};return pm(e,o).each(a=>{s.type==="block-format"?r(s.format,e.formatter)&&e.undoManager.transact(()=>{lw(e.dom,a,s),e.formatter.apply(s.format)}):s.type==="block-command"&&e.undoManager.transact(()=>{lw(e.dom,a,s),e.execCommand(s.cmd,!1,s.value)})}),!0},$j=e=>qs(e,(t,n)=>n.start.length-t.start.length),Fj=(e,t)=>{const n=$j(e),s=t.replace(mt," ");return rt(n,o=>t.indexOf(o.start)===0||s.indexOf(o.start)===0)},Mj=(e,t,n,s)=>{var o;const r=e.dom,a=Kt(e);if(!r.is(t,a))return[];const i=(o=t.textContent)!==null&&o!==void 0?o:"";return Fj(n.blockPatterns,i).map(l=>L.trim(i).length===l.start.length?[]:[{pattern:l,range:gm(r,r.getRoot(),t,0,t,0,s)}]).getOr([])},Uj=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();B(t,s=>Lj(e,s)),e.selection.moveToBookmark(n)},cw=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),nc=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},uw=(e,t,n)=>{const s=rw(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),l=i.parentNode,c=a.parentNode;return{prefix:t,end:c.insertBefore(cw(e,t+"-end"),a),start:l.insertBefore(cw(e,t+"-start"),i)}},fw=(e,t,n)=>{Sr(e,e.get(t.prefix+"-end"),n),Sr(e,e.get(t.prefix+"-start"),n)},hm=e=>e.start.length===0,zj=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},dw=(e,t,n,s)=>{const o=t.start;return zd(e,s.container,s.offset,zj(o),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+o.length){const u=e.createRng();return u.setStart(a.container,a.offset-o.length),u.setEnd(a.container,a.offset),m.some(u)}else{const u=a.offset-o.length;return Ud(a.container,u,n).map(d=>{const p=e.createRng();return p.setStart(d.container,d.offset),p.setEnd(a.container,a.offset),p}).filter(d=>d.toString()===o).orThunk(()=>dw(e,t,n,Dn(a.container,0)))}})},Hj=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return Md(n,s,o).bind(a=>dw(e,t,o,a).bind(l=>{var c;if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return m.none();if(a.offset===0&&((c=l.endContainer.textContent)===null||c===void 0?void 0:c.length)===l.endOffset)return m.none()}return m.some(l)}))},Vj=(e,t,n,s)=>{const o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return Ud(i,l-n.pattern.end.length,t).bind(c=>{const f=gm(o,r,c.container,c.offset,i,l,s);if(hm(a))return m.some({matches:[{pattern:a,startRng:f,endRng:f}],position:c});{const u=sc(e,n.remainingPatterns,c.container,c.offset,t,s),d=u.getOr({matches:[],position:c}),p=d.position;return Hj(o,a,p.container,p.offset,t,u.isNone()).map(g=>{const h=Oj(o,r,g,s);return{matches:d.matches.concat([{pattern:a,startRng:h,endRng:f}]),position:Dn(g.startContainer,g.startOffset)}})}})},sc=(e,t,n,s,o,r)=>{const a=e.dom;return Md(n,s,a.getRoot()).bind(i=>{const l=iw(a,o,n,s);for(let c=0;c<t.length;c++){const f=t[c];if(!Km(l,f.end))continue;const u=t.slice();u.splice(c,1);const d=Vj(e,o,{pattern:f,remainingPatterns:u,position:i},r);if(d.isNone()&&s>0)return sc(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},mw=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?B(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},Wj=(e,t,n,s)=>{const o=nc(e.dom,n);tc(e.dom,o,s),mw(e,t,o)},jj=(e,t,n,s,o)=>{const r=e.dom,a=nc(r,s),i=nc(r,n);tc(r,i,o),tc(r,a,o);const l={prefix:n.prefix,start:n.end,end:s.start},c=nc(r,l);mw(e,t,c)},qj=(e,t)=>{const n=_p("mce_textpattern"),s=Pr(t,(o,r)=>{const a=uw(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return Pr(s,(o,r)=>{const a=s.length-o.length-1,i=hm(r.pattern)?r.endMarker:uw(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},Kj=e=>qs(e,(t,n)=>n.end.length-t.end.length),Gj=(e,t)=>{const n=vs(e,s=>Xe(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},gw=(e,t,n,s,o,r)=>{const a=sc(e,o.inlinePatterns,n,s,t,r).fold(()=>[],l=>l.matches),i=sc(e,Kj(o.inlinePatterns),n,s,t,r).fold(()=>[],l=>l.matches);return Gj(a,i)},pw=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=qj(n,t);B(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;hm(r.pattern)?Wj(e,r.pattern,r.endMarker,i):jj(e,r.pattern,r.startMarker,r.endMarker,i),fw(n,r.endMarker,i),fw(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},Yj=(e,t)=>{const n=e.selection.getRng();return pm(e,n).map(s=>{var o;const r=Math.max(0,n.startOffset),a=aw(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=gw(e,s,n.startContainer,r,a,!0),l=Mj(e,s,a,!0);return l.length>0||i.length>0?(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{e.insertContent(Qo),pw(e,i),Uj(e,l);const c=e.selection.getRng(),f=Md(c.startContainer,c.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),f.each(u=>{const d=u.container;d.data.charAt(u.offset-1)===Qo&&(d.deleteData(u.offset-1,1),Sr(e.dom,d.parentNode,p=>p===e.dom.getRoot()))})}),!0):!1}).getOr(!1)},Xj=(e,t)=>{const n=e.selection.getRng();pm(e,n).map(s=>{const o=Math.max(0,n.startOffset-1),r=iw(e.dom,s,n.startContainer,o),a=aw(t,s,r),i=gw(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{pw(e,i)})})},hw=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},Qj=(e,t)=>hw(e,t,(n,s)=>n===s.keyCode&&!Y.modifierPressed(s)),Zj=(e,t)=>hw(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),Jj=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>wA(IR(e),LR(e)),o=()=>zR(e);e.on("keydown",a=>{if(a.keyCode===13&&!Y.modifierPressed(a)&&e.selection.isCollapsed()){const i=s();(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&Yj(e,i)&&a.preventDefault()}},!0);const r=()=>{if(e.selection.isCollapsed()){const a=s();(a.inlinePatterns.length>0||o())&&Xj(e,a)}};e.on("keyup",a=>{Qj(n,a)&&r()}),e.on("keypress",a=>{Zj(t,a)&&ln.setEditorTimeout(e,r)})},e8=e=>{Jj(e)},t8=e=>{const t=L.each,n=Y.BACKSPACE,s=Y.DELETE,o=e.dom,r=e.selection,a=e.parser,i=be.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),f=be.deviceType.isiPhone()||be.deviceType.isiPad(),u=be.os.isMacOS()||be.os.isiOS(),d=(F,Z)=>{try{e.getDoc().execCommand(F,!1,String(Z))}catch{}},p=F=>F.isDefaultPrevented(),b=()=>{const F=ee=>{const M=o.create("body"),ue=ee.cloneContents();return M.appendChild(ue),r.serializer.serialize(M,{format:"html"})},Z=ee=>{const M=F(ee),ue=o.createRng();ue.selectNode(e.getBody());const ce=F(ue);return M===ce};e.on("keydown",ee=>{const M=ee.keyCode;if(!p(ee)&&(M===s||M===n)&&e.selection.isEditable()){const ue=e.selection.isCollapsed(),ce=e.getBody();if(ue&&!o.isEmpty(ce)||!ue&&!Z(e.selection.getRng()))return;ee.preventDefault(),e.setContent(""),ce.firstChild&&o.isBlock(ce.firstChild)?e.selection.setCursorLocation(ce.firstChild,0):e.selection.setCursorLocation(ce,0),e.nodeChanged()}})},g=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",F=>{let Z;if(F.target===e.getDoc().documentElement)if(Z=r.getRng(),e.getBody().focus(),F.type==="mousedown"){if(nn(Z.startContainer))return;r.placeCaretAt(F.clientX,F.clientY)}else r.setRng(Z)})},y=()=>{e.on("keydown",F=>{if(!p(F)&&F.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const Z=r.getNode(),ee=Z.previousSibling;if(Z.nodeName==="HR"){o.remove(Z),F.preventDefault();return}ee&&ee.nodeName&&ee.nodeName.toLowerCase()==="hr"&&(o.remove(ee),F.preventDefault())}}})},C=()=>{Range.prototype.getClientRects||e.on("mousedown",F=>{if(!p(F)&&F.target.nodeName==="HTML"){const Z=e.getBody();Z.blur(),ln.setEditorTimeout(e,()=>{Z.focus()})}})},E=()=>{const F=Ch(e);e.on("click",Z=>{const ee=Z.target;/^(IMG|HR)$/.test(ee.nodeName)&&o.isEditable(ee.parentNode)&&(Z.preventDefault(),e.selection.select(ee),e.nodeChanged()),ee.nodeName==="A"&&o.hasClass(ee,F)&&ee.childNodes.length===0&&o.isEditable(ee.parentNode)&&(Z.preventDefault(),r.select(ee))})},S=()=>{const F=()=>{const ee=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const M=r.getStart();M!==e.getBody()&&(o.setAttrib(M,"style",null),t(ee,ue=>{M.setAttributeNode(ue.cloneNode(!0))}))}},Z=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",ee=>{let M;return!p(ee)&&(ee.keyCode===8||ee.keyCode===46)&&Z()?(M=F(),e.getDoc().execCommand("delete",!1),M(),ee.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",ee=>{if(!p(ee)&&Z()){const M=F();ln.setEditorTimeout(e,()=>{M()})}})},R=()=>{e.on("keydown",F=>{if(!p(F)&&F.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const Z=r.getNode().previousSibling;if(Z&&Z.nodeName&&Z.nodeName.toLowerCase()==="table")return F.preventDefault(),!1}return!0})},$=()=>{e.on("keydown",F=>{if(p(F)||F.keyCode!==Y.BACKSPACE)return;let Z=r.getRng();const ee=Z.startContainer,M=Z.startOffset,ue=o.getRoot();let ce=ee;if(!(!Z.collapsed||M!==0)){for(;ce.parentNode&&ce.parentNode.firstChild===ce&&ce.parentNode!==ue;)ce=ce.parentNode;ce.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,ce),Z=o.createRng(),Z.setStart(ee,0),Z.setEnd(ee,0),r.setRng(Z))}})},I=()=>{const F=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),ph(e)||d("enableObjectResizing",!1)};bh(e)||e.on("BeforeExecCommand mousedown",F)},N=()=>{const F=()=>{t(o.select("a:not([data-mce-block])"),Z=>{var ee;let M=Z.parentNode;const ue=o.getRoot();if((M==null?void 0:M.lastChild)===Z){for(;M&&!o.isBlock(M);){if(((ee=M.parentNode)===null||ee===void 0?void 0:ee.lastChild)!==M||M===ue)return;M=M.parentNode}o.add(M,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",Z=>{(Z.type==="setcontent"||Z.command==="mceInsertLink")&&F()})},x=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",Kt(e))})},U=F=>{const Z=F.getBody(),ee=F.selection.getRng();return ee.startContainer===ee.endContainer&&ee.startContainer===Z&&ee.startOffset===0&&ee.endOffset===Z.childNodes.length},X=()=>{e.on("keyup focusin mouseup",F=>{!Y.modifierPressed(F)&&!U(e)&&r.normalize()},!0)},J=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},re=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},fe=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",F=>{let Z;F.target.nodeName==="HTML"&&(Z=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(Z),e.selection.normalize(),e.nodeChanged())}))},he=()=>{u&&e.on("keydown",F=>{Y.metaKeyPressed(F)&&!F.shiftKey&&(F.keyCode===37||F.keyCode===39)&&(F.preventDefault(),e.selection.getSel().modify("move",F.keyCode===37?"backward":"forward","lineboundary"))})},Se=()=>{e.on("click",F=>{let Z=F.target;do if(Z.tagName==="A"){F.preventDefault();return}while(Z=Z.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},$e=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",F=>{F.preventDefault()})})},pt=()=>{a.addNodeFilter("br",F=>{let Z=F.length;for(;Z--;)F[Z].attr("class")==="Apple-interchange-newline"&&F[Z].remove()})},Ze=de,D=()=>{if(!l||e.removed)return!1;const F=e.selection.getSel();return!F||!F.rangeCount||F.rangeCount===0},j=()=>{c&&(h(),E(),$e(),g(),f&&(re(),fe(),Se())),l&&(C(),I(),J(),he())},me=()=>{$(),b(),be.windowsPhone||X(),c&&(h(),E(),x(),$e(),R(),pt(),f?(re(),fe(),Se()):g()),l&&(y(),C(),S(),I(),N(),J(),he(),R())};return Zn(e)?j():me(),{refreshContentEditable:Ze,isHidden:D}},bm=_e.DOM,n8=(e,t)=>{const n=v.fromDom(e.getBody()),s=Oc(Es(n)),o=v.fromTag("style");dt(o,"type","text/css"),at(o,v.fromText(t)),at(s,o),e.on("remove",()=>{Fe(o)})},s8=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,vm=e=>Or(e,t=>Pt(t)===!1),bw=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return vm({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),remove_trailing_brs:t("remove_trailing_brs"),inline_styles:t("inline_styles"),root_name:s8(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},vw=e=>{const t=e.options.get;return vm({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},o8=e=>{const t=e.options.get;return{...bw(e),...vw(e),...vm({url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},r8=e=>{const t=pr(bw(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{const o=e.dom,r="data-mce-"+s;let a=n.length;for(;a--;){const i=n[a];let l=i.attr(s);if(l&&!i.attr(r)){if(l.indexOf("data:")===0||l.indexOf("blob:")===0)continue;s==="style"?(l=o.serializeStyle(o.parseStyle(l),i.name),l.length||(l=null),i.attr(r,l),i.attr(s,l)):s==="tabindex"?(i.attr(r,l),i.attr(s,null)):i.attr(r,e.convertURL(l,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),MR(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){const r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new Lt("br",1))}}),t},a8=e=>{const t=SR(e);t&&ln.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},i8=e=>{const t=e.dom.getRoot();!e.inline&&(!Gi(e)||e.selection.getStart(!0)===t)&&It(t).each(n=>{const s=n.getNode(),o=us(s)?It(s).getOr(n):n;e.selection.setRng(o.toRange())})},l8=e=>{e.bindPendingEventDelegates(),e.initialized=!0,C1(e),e.focus(!0),i8(e),e.nodeChanged({initial:!0});const t=yR(e);Ce(t)&&t.call(e,e),a8(e)},Cw=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,c8=(e,t,n)=>{const s=[Cw(e).loadAll(t)];return e.inline?s:s.concat([e.ui.styleSheetLoader.loadAll(n)])},yw=e=>{const t=Cw(e),n=gh(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";L.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(c8(e,s,n)).then(r).catch(r),i=YA(e);return i&&n8(e,i),a},u8=e=>{const t=e.getDoc(),n=e.getBody();b1(e),wR(e)||(t.body.spellcheck=!1,bm.setAttrib(n,"spellcheck","false")),e.quirks=t8(e),v1(e);const s=XA(e);s!==void 0&&(n.dir=s);const o=kR(e);o&&e.on("BeforeSetContent",r=>{L.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},f8=e=>{Zn(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Cm=e=>{e.removed!==!0&&(f8(e),l8(e))},Ew=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(bm.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=bh(e),e.readonly||(e.inline&&bm.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=OM(e),e.schema=_s(vw(e)),e.dom=_e(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:jA(e),referrerPolicy:vu(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=r8(e),e.serializer=Oy(o8(e),e),e.selection=By(e.dom,e.getWin(),e.serializer,e),e.annotator=pb(e),e.formatter=Yy(e),e.undoManager=Qy(e),e._nodeChangeDispatcher=new P3(e),e._selectionOverrides=Dj(e),a2(e),OW(e),g2(e),Zn(e)||(zW(e),e8(e));const o=T3(e);s2(e,o),f2(e),YM(e),PW(e);const r=U$(e);u8(e),r.fold(()=>{yw(e).then(()=>Cm(e))},a=>{e.setProgressState(!0),yw(e).then(()=>{a().then(i=>{e.setProgressState(!1),Cm(e),Ay(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Cm(e),Ay(e)})})})},d8=et,m8=(e,t,n)=>qx(e,t,d8,n),ym=_e.DOM,g8=(e,t,n,s)=>{const o=v.fromTag("iframe");return s.each(r=>dt(o,"tabindex",r)),ys(o,n),ys(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),Ko(o,"tox-edit-area__iframe"),o},p8=e=>{let t=TA(e)+"<html><head>";ih(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=PA(e),s=DA(e),o=e.translate(vR(e));return lh(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+lh(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},h8=(e,t)=>{const n=e.translate("Rich Text Area"),s=rs(v.fromDom(e.getElement()),"tabindex").bind(ai),o=g8(e.id,n,RA(e),s).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=p8(e),ym.add(t.iframeContainer,o)},b8=e=>{const t=e.iframeElement,n=m8(v.fromDom(t),"load",()=>{n.unbind(),e.contentDocument=t.contentDocument,Ew(e)});if(be.browser.isFirefox()){const s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close()}else t.srcdoc=e.iframeHTML},v8=(e,t)=>{h8(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=ym.isHidden(t.editorContainer)),e.getElement().style.display="none",ym.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,b8(e)},Sw=_e.DOM,C8=(e,t,n)=>{const s=br.get(n),o=br.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=L.trim(n),s&&L.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,Ce(r.init)&&(r.init(e,o),t.push(n))}catch(r){EM(e,n,r)}}},y8=e=>e.replace(/^\-/,""),E8=e=>{const t=[];B(Fi(e),n=>{C8(e,t,y8(n))})},S8=e=>{const t=L.trim(fh(e)),n=e.ui.registry.getAll().icons,s={...Nl.get("default").icons,...Nl.get(t).icons};Pe(s,(o,r)=>{le(n,r)||e.ui.registry.addIcon(r,o)})},w8=e=>{const t=or(e);if(q(t)){const n=Ro.get(t);e.theme=n(e,Ro.urls[t])||{},Ce(e.theme.init)&&e.theme.init(e,Ro.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},k8=e=>{const t=Cu(e),n=hr.get(t);e.model=n(e,hr.urls[t])},x8=e=>{const t=e.theme.renderUI;return t?t():kw(e)},N8=e=>{const t=e.getElement(),s=or(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},ww=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),_8=e=>{const t=Sw.create("div");return Sw.insertAfter(t,e),ww(t,t)},kw=e=>{const t=e.getElement();return e.inline?ww(null):_8(t)},A8=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,q(or(e))?x8(e):Ce(or(e))?N8(e):kw(e)},R8=(e,t)=>{const n={show:m.from(t.show).getOr(de),hide:m.from(t.hide).getOr(de),isEnabled:m.from(t.isEnabled).getOr(et),setEnabled:s=>{e.mode.isReadOnly()||m.from(t.setEnabled).each(o=>o(s))}};e.ui={...e.ui,...n}},T8=async e=>{e.dispatch("ScriptsLoaded"),S8(e),w8(e),k8(e),E8(e);const t=await A8(e);R8(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,xM(e),e.inline?Ew(e):v8(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},To=_e.DOM,xw=e=>e.charAt(0)==="-",P8=(e,t)=>{const n=dh(t),s=qA(t);if(!_n.hasCode(n)&&n!=="en"){const o=Mn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{vM(t,o,n)})}},D8=(e,t)=>{const n=or(e);if(q(n)&&!xw(n)&&!le(Ro.urls,n)){const s=tR(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;Ro.load(n,o).catch(()=>{CM(e,o,n)})}},B8=(e,t)=>{const n=Cu(e);if(n!=="plugin"&&!le(hr.urls,n)){const s=nR(e),o=q(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;hr.load(n,o).catch(()=>{yM(e,o,n)})}},O8=e=>m.from(UA(e)).filter(Mn).map(t=>({url:t,name:m.none()})),Nw=(e,t,n)=>m.from(t).filter(s=>Mn(s)&&!Nl.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),I8=(e,t,n)=>{const s=Nw(t,"default",n),o=O8(t).orThunk(()=>Nw(t,fh(t),""));B(tx([s,o]),r=>{e.add(r.url).catch(()=>{bM(t,r.url,r.name.getOrUndefined())})})},L8=(e,t)=>{const n=(s,o)=>{br.load(s,o).catch(()=>{hM(e,o,s)})};Pe(gR(e),(s,o)=>{n(o,s),e.options.set("plugins",Fi(e).concat(o))}),B(Fi(e),s=>{s=L.trim(s),s&&!br.urls[s]&&!xw(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},$8=e=>{const t=or(e);return!q(t)||z(Ro.get(t))},F8=e=>{const t=Cu(e);return z(hr.get(t))},M8=(e,t)=>{const n=ds.ScriptLoader,s=()=>{!e.removed&&$8(e)&&F8(e)&&T8(e)};D8(e,t),B8(e,t),P8(n,e),I8(n,e,t),L8(e,t),n.loadQueue().then(s,s)},U8=(e,t)=>ap.forElement(e,{contentCssCors:vh(t),referrerPolicy:vu(t)}),z8=e=>{const t=e.id;_n.setCode(dh(e));const n=()=>{To.unbind(window,"ready",n),e.render()};if(!lo.Event.domLoaded){To.bind(window,"ready",n);return}if(!e.getElement())return;const s=v.fromDom(e.getElement()),o=cg(s);e.on("remove",()=>{Lm(s.dom.attributes,a=>vt(s,a.name)),ys(s,o)}),e.ui.styleSheetLoader=U8(s,e),yu(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||To.getParent(t,"form");r&&(e.formElement=r,lR(e)&&!Fc(e.getElement())&&(To.insertAfter(To.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},To.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),cR(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=zy(e),e.notificationManager=Uy(e),WR(e)&&e.on("GetContent",a=>{a.save&&(a.content=To.encode(a.content))}),uR(e)&&e.on("submit",()=>{e.initialized&&e.save()}),fR(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),M8(e,e.suffix)},H8=(e,t)=>({sections:K(e),options:K(t)}),_w=Cs().deviceType,Aw=_w.isPhone(),V8=_w.isTablet(),qa=e=>{if(Je(e))return[];{const t=ot(e)?e:e.split(/[ ,]/),n=ve(t,jo);return oe(n,Mn)}},W8=(e,t)=>{const n=mk(t,(s,o)=>Te(e,o));return H8(n.t,n.f)},j8=(e,t,n={})=>{const s=e.sections(),o=Oe(s,t).getOr({});return L.extend({},n,o)},Em=(e,t)=>le(e.sections(),t),q8=(e,t)=>Em(e,t)?e.sections()[t]:{},K8=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Oe(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),G8=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?L.extend({},e.external_plugins,s):s},Y8=(e,t)=>[...qa(e),...qa(t)],X8=(e,t,n,s)=>e&&Em(t,"mobile")?s:n,Q8=(e,t,n,s)=>{const o=qa(n.forced_plugins),r=qa(s.plugins),a=q8(t,"mobile"),i=a.plugins?qa(a.plugins):r,l=X8(e,t,r,i),c=Y8(o,l);return L.extend(s,{forced_plugins:o,plugins:c})},Z8=(e,t)=>e&&Em(t,"mobile"),J8=(e,t,n,s,o)=>{var r;const a=e?{mobile:K8((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=W8(["mobile"],Ul(a,o)),l=L.extend(n,s,i.options(),Z8(e,i)?j8(i,"mobile"):{},{external_plugins:G8(s,i.options())});return Q8(e,i,s,l)},e6=(e,t)=>J8(Aw||V8,Aw,t,e,t),t6=(e,t)=>fF(e,t),n6=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{B("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},s6=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Xe(o,r=>z(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},o6=e=>{n6(e),s6(e)},r6=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(be.os.isMacOS()||be.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}}})},a6=(e,t,n)=>{const s=v.fromDom(e.getRoot());return ka(s,A.fromRangeStart(t))?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),xa(s,A.fromRangeEnd(t))?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},i6=e=>{if(typeof e!="string"){const t=L.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},l6=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?a6(s,n.getRng(),t):t},oc=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:s}=i6(t);rd(e,{...s,content:l6(e,n),format:"html",set:!1,selection:!0}).each(o=>{const r=cF(e,o.content,s);ad(e,r,o),e.addVisual()})}},c6=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{oc(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{oc(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{oc(e,s)},mceInsertContent:(t,n,s)=>{oc(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent("")}})},u6={"font-size":"size","font-family":"face"},f6=_c("font"),d6=(e,t,n)=>{const s=r=>di(r,e).orThunk(()=>f6(r)?Oe(u6,e).bind(a=>rs(r,a)):m.none()),o=r=>ye(v.fromDom(t),r);return $f(v.fromDom(n),r=>s(r),o)},m6=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),g6=(e,t)=>m.from(_e.DOM.getStyle(t,e,!0)),Rw=e=>(t,n)=>m.from(n).map(v.fromDom).filter(Ut).bind(s=>d6(e,t,s.dom).or(g6(e,s.dom))).getOr(""),p6=Rw("font-size"),h6=js(m6,Rw("font-family")),b6=e=>It(e.getBody()).bind(t=>{const n=t.container();return m.from(P(n)?n.parentNode:n)}),v6=e=>m.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),C6=(e,t)=>v6(e).orThunk(G(b6,e)).map(v.fromDom).filter(Ut).bind(t),Sm=(e,t)=>C6(e,Bm(m.some,t)),Tw=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=HR(e),o=VR(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},y6=e=>{const t=e.split(/\s*,\s*/);return ve(t,n=>n.indexOf(" ")!==-1&&!(bt(n,'"')||bt(n,"'"))?`'${n}'`:n).join(",")},E6=(e,t)=>{const n=Tw(e,t);e.formatter.toggle("fontname",{value:y6(n)}),e.nodeChanged()},S6=e=>Sm(e,t=>h6(e.getBody(),t.dom)).getOr(""),w6=(e,t)=>{e.formatter.toggle("fontsize",{value:Tw(e,t)}),e.nodeChanged()},k6=e=>Sm(e,t=>p6(e.getBody(),t.dom)).getOr(""),x6=e=>Sm(e,t=>{const n=v.fromDom(e.getBody()),s=$f(t,r=>di(r,"line-height"),G(ye,n)),o=()=>{const r=parseFloat(Hn(t,"line-height")),a=parseFloat(Hn(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),N6=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},_6=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{E6(e,o)},FontSize:(n,s,o)=>{w6(e,o)},LineHeight:(n,s,o)=>{N6(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(q(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},A6=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>S6(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>k6(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>x6(e))},R6=e=>{_6(e),A6(e)},T6=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},P6=e=>{e.editorCommands.addCommands({Indent:()=>{e2(e)},Outdent:()=>{e0(e)}}),e.editorCommands.addCommands({Outdent:()=>XE(e)},"state")},D6=e=>{const t=(n,s,o)=>{const r=q(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");Ye(r)&&q(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")},mceInsertLink:t,createLink:t})},B6=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);const n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){const s=n.parentNode;if(s&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const o=e.selection.getBookmark();e.dom.split(s,n),e.selection.moveToBookmark(o)}}}})},O6=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{const n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&(t==="insertunorderedlist"&&n.tagName==="UL"||t==="insertorderedlist"&&n.tagName==="OL")}},"state")},I6=e=>{B6(e),O6(e)},L6=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Yl(cS,e)},mceInsertNewLine:(t,n,s)=>{hS(e,s)},InsertLineBreak:(t,n,s)=>{Yl(dS,e)}})},$6=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>H(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),Nn);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},F6=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s??e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{ZP(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},M6=e=>{o6(e),r6(e),T6(e),$6(e),c6(e),D6(e),P6(e),L6(e),I6(e),R6(e),F6(e)},U6=["toggleview"],Pw=e=>Te(U6,e.toLowerCase());class Dw{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():PP(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const c=this.commands.exec[a];return Ce(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!Pw(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return Ce(s)?s(n):!1}queryCommandValue(t){if(!Pw(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return Ce(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Pe(t,(o,r)=>{B(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}const Po="data-mce-contenteditable",z6=(e,t,n)=>{Rc(e,t)&&!n?zr(e,t):n&&Ko(e,t)},wm=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},rc=(e,t)=>{e.dom.contentEditable=t?"true":"false"},H6=e=>{B(kt(e,'*[contenteditable="true"]'),t=>{dt(t,Po,"true"),rc(t,!1)})},V6=e=>{B(kt(e,`*[${Po}="true"]`),t=>{vt(t,Po),rc(t,!0)})},W6=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},j6=e=>{e.selection.setRng(e.selection.getRng())},q6=(e,t)=>{const n=v.fromDom(e.getBody());z6(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),W6(e),e.readonly=!0,rc(n,!1),H6(n)):(e.readonly=!1,rc(n,!0),V6(n),wm(e,"StyleWithCSS",!1),wm(e,"enableInlineTableEditing",!1),wm(e,"enableObjectResizing",!1),XP(e)&&e.focus(),j6(e),e.nodeChanged())},Do=e=>e.readonly,Bw=e=>{e.parser.addAttributeFilter("contenteditable",t=>{Do(e)&&B(t,n=>{n.attr(Po,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(Po,t=>{Do(e)&&B(t,n=>{n.attr("contenteditable",n.attr(Po))})}),e.serializer.addTempAttr(Po)},K6=e=>{e.serializer?Bw(e):e.on("PreInit",()=>{Bw(e)})},G6=e=>e.type==="click",Y6=["copy"],X6=e=>Te(Y6,e.type),Q6=(e,t)=>Js(t,"a",s=>ye(s,v.fromDom(e.getBody()))).bind(s=>rs(s,"href")),Z6=(e,t)=>{if(G6(t)&&!Y.metaKeyPressed(t)){const n=v.fromDom(t.target);Q6(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${qm(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else X6(t)&&e.dispatch(t.type,t)},J6=e=>{e.on("ShowCaret",t=>{Do(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{Do(e)&&t.preventDefault()})},e5=L.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class km{constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||ze}static isNative(t){return!!e5[t.toLowerCase()]}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=nu(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=ze),n){const r={func:n,removed:!1};o&&L.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Pe(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{const i=Tr(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,B(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Pe(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const Ka=e=>(e._eventDispatcher||(e._eventDispatcher=new km({scope:e,toggleEvent:(t,n)=>{km.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),xm={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return nu(e.toLowerCase(),t??{},s);const o=Ka(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return Ka(this).on(e,t,n)},off(e,t){return Ka(this).off(e,t)},once(e,t){return Ka(this).once(e,t)},hasEventListeners(e){return Ka(this).has(e)}},ac=_e.DOM;let Bo;const ic=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=hh(e);return n?(e.eventRoot||(e.eventRoot=ac.select(n)[0]),e.eventRoot):e.getBody()},t5=e=>!e.hidden&&!Do(e),Ow=(e,t,n)=>{t5(e)?e.dispatch(t,n):Do(e)&&Z6(e,n)},Iw=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=ic(e,t);if(hh(e)){if(Bo||(Bo={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||Bo&&(Pe(Bo,(o,r)=>{e.dom.unbind(ic(e,r))}),Bo=null)})),Bo[t])return;const s=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===r||ac.isChildOf(r,l))&&Ow(a[i],t,o)}};Bo[t]=s,ac.bind(n,t,s)}else{const s=o=>{Ow(e,t,o)};ac.bind(n,t,s),e.delegates[t]=s}},Lw={...xm,bindPendingEventDelegates(){const e=this;L.each(e._pendingNativeEvents,t=>{Iw(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?Iw(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(ic(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Pe(e.delegates,(s,o)=>{e.dom.unbind(ic(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},n5=e=>q(e)?{value:e.split(/[ ,]/),valid:!0}:Ho(e,q)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},s5=e=>{const t=(()=>{switch(e){case"array":return ot;case"boolean":return Ws;case"function":return Ce;case"number":return Sn;case"object":return Ye;case"string":return q;case"string[]":return n5;case"object[]":return n=>Ho(n,Ye);case"regexp":return n=>ft(n,RegExp);default:return et}})();return n=>Nm(n,t,`The value must be a ${e}.`)},o5=e=>q(e.processor),$w=(e,t)=>{const n=$r(t.message)?"":`. ${t.message}`;return e+n},Fw=e=>e.valid,Nm=(e,t,n="")=>{const s=t(e);return Ws(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},r5=(e,t,n)=>{if(!Pt(t)){const s=Nm(t,n);if(Fw(s))return s.value;console.error($w(`Invalid default value passed for the "${e}" option`,s))}},a5=(e,t)=>{const n={},s={},o=(u,d,p)=>{const b=Nm(d,p);return Fw(b)?(s[u]=b.value,!0):(console.warn($w(`Invalid value passed for the ${u} option`,b)),!1)},r=(u,d)=>{const p=o5(d)?s5(d.processor):d.processor,b=r5(u,d.default,p);n[u]={...d,default:b,processor:p},Oe(s,u).orThunk(()=>Oe(t,u)).each(h=>o(u,h,p))},a=u=>le(n,u);return{register:r,isRegistered:a,get:u=>Oe(s,u).orThunk(()=>Oe(n,u).map(d=>d.default)).getOrUndefined(),set:(u,d)=>{if(a(u)){const p=n[u];return p.immutable?(console.error(`"${u}" is an immutable option and cannot be updated`),!1):o(u,d,p.processor)}else return console.warn(`"${u}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:u=>{const d=a(u);return d&&delete s[u],d},isSet:u=>le(s,u)}},i5=["design","readonly"],Mw=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&q6(e,r.editorReadOnly),t.set(s),g1(e,s)},l5=(e,t,n,s)=>{if(s!==n.get()){if(!le(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?Mw(e,n,t,s):e.on("init",()=>Mw(e,n,t,s))}},c5=(e,t,n)=>{if(Te(i5,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},u5=e=>{const t=ct("design"),n=ct({design:{activate:de,deactivate:de,editorReadOnly:!1},readonly:{activate:de,deactivate:de,editorReadOnly:!0}});return K6(e),J6(e),{isReadOnly:()=>Do(e),set:s=>l5(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(c5(n.get(),s,o))}}},_m=L.each,Am=L.explode,f5={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Uw=L.makeMap("alt,ctrl,shift,meta,access"),d5=e=>e in Uw,m5=e=>{const t={},n=be.os.isMacOS()||be.os.isiOS();_m(Am(e.toLowerCase(),"+"),r=>{d5(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=f5[r]||r.toUpperCase().charCodeAt(0))});const s=[t.keyCode];let o;for(o in Uw)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class zw{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(_m(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return _m(Am(L.trim(t)),i=>{const l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:L.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=L.map(Am(t,">"),m5);return r[r.length-1]=L.extend(r[r.length-1],{func:s,scope:o||this.editor}),L.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const g5=()=>{const e={},t={},n={},s={},o={},r={},a={},i={},l=(f,u)=>(d,p)=>{f[d.toLowerCase()]={...p,type:u}},c=(f,u)=>s[f.toLowerCase()]=u;return{addButton:l(e,"button"),addGroupToolbarButton:l(e,"grouptoolbarbutton"),addToggleButton:l(e,"togglebutton"),addMenuButton:l(e,"menubutton"),addSplitButton:l(e,"splitbutton"),addMenuItem:l(t,"menuitem"),addNestedMenuItem:l(t,"nestedmenuitem"),addToggleMenuItem:l(t,"togglemenuitem"),addAutocompleter:l(n,"autocompleter"),addContextMenu:l(o,"contextmenu"),addContextToolbar:l(r,"contexttoolbar"),addContextForm:l(r,"contextform"),addSidebar:l(a,"sidebar"),addView:l(i,"views"),addIcon:c,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:a,views:i})}},p5=()=>{const e=g5();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},Oo=_e.DOM,Hw=L.extend,h5=L.each;class lc{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,Hw(this,Lw);const o=this;this.id=t,this.hidden=!1;const r=e6(s.defaultOptions,n);this.options=a5(o,r),AA(o);const a=this.options.get;a("deprecation_warnings")&&QF(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;const c=vu(o);c&&(ds.ScriptLoader._setReferrerPolicy(c),_e.DOM.styleSheetLoader._setReferrerPolicy(c));const f=vh(o);z(f)&&_e.DOM.styleSheetLoader._setContentCssCors(f),Nt.languageLoad=a("language_load"),Nt.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new Pn(ih(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=yu(o),this.hasVisual=hR(o),this.shortcuts=new zw(this),this.editorCommands=new Dw(this),M6(this);const u=a("cache_suffix");u&&(be.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:p5(),styleSheetLoader:void 0,show:de,hide:de,setEnabled:de,isEnabled:et},this.mode=u5(o),s.dispatch("SetupEditor",{editor:this});const d=CR(o);Ce(d)&&d.call(o,o)}render(){z8(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return So(this)}translate(t){return _n.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(z(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:et,default:n})),!o.isSet(t)&&!Pt(n)?n:o.get(t)}hasPlugin(t,n){return Te(Fi(this),t)?n?br.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(Oo.show(t.getContainer()),Oo.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(Oo.hide(t.getContainer()),Oo.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,s=n.getElement();if(n.removed)return"";if(s){const o={...t,load:!0},r=Fc(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",{...o,element:s}),a}else return""}save(t={}){const n=this;let s=n.getElement();if(!s||!n.initialized||n.removed)return"";const o={...t,save:!0,element:s};let r=n.getContent(o);const a={...o,content:r};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,Fc(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);const i=Oo.getParent(n.id,"form");i&&h5(i.elements,l=>l.name===n.id?(l.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return gd(this,t,n)}getContent(t){return FF(this,t)}insertContent(t,n){n&&(t=Hw({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?gd(this,this.startContent,{format:"raw"}):gd(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||Oo.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=Oo.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s==null?void 0:s.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){const o=this,r=o.options.get,a=ER(o);return Ce(a)?a.call(o,t,s,!0,n):!r("convert_urls")||s==="link"||Ye(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){t6(this,t)}remove(){tM(this)}destroy(t){nM(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const wr=_e.DOM,cc=L.each;let Vw=!1,uc,$t=[];const fc=e=>{const t=e.type;cc(Us.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},Ww=e=>{if(e!==Vw){const t=_e.DOM;e?(t.bind(window,"resize",fc),t.bind(window,"scroll",fc)):(t.unbind(window,"resize",fc),t.unbind(window,"scroll",fc)),Vw=e}},jw=e=>{const t=$t;return $t=oe($t,n=>e!==n),Us.activeEditor===e&&(Us.activeEditor=$t.length>0?$t[0]:null),Us.focusedEditor===e&&(Us.focusedEditor=null),t.length!==$t.length},b5=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(jw(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},v5=document.compatMode!=="CSS1Compat",Us={...xm,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"4.1",releaseDate:"2023-03-29",i18n:_n,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",s=Pn.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new Pn(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new Pn(e.baseURL),e.suffix=n,HP(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Pe(s,(o,r)=>{Nt.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=L.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(f,u)=>f.inline&&u.tagName.toLowerCase()in s,r=f=>{let u=f.id;return u||(u=Oe(f,"name").filter(d=>!wr.get(d)).getOrThunk(wr.uniqueId),f.setAttribute("id",u)),u},a=f=>{const u=e[f];if(u)return u.apply(t,[])},i=f=>be.browser.isIE()||be.browser.isEdge()?(Al("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):v5?(Al("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):q(f.selector)?wr.select(f.selector):z(f.target)?[f.target]:[];let l=f=>{n=f};const c=()=>{let f=0;const u=[];let d;const p=(b,g,h)=>{const y=new lc(b,g,t);u.push(y),y.on("init",()=>{++f===d.length&&l(u)}),y.targetElm=y.targetElm||h,y.render()};wr.unbind(window,"ready",c),a("onpageload"),d=uk(i(e)),L.each(d,b=>{b5(t.get(b.id))}),d=L.grep(d,b=>!t.get(b.id)),d.length===0?l([]):cc(d,b=>{o(e,b)?Al("Could not initialize inline editor on invalid inline target element",b):p(r(b),e,b)})};return wr.bind(window,"ready",c),new Promise(f=>{n?f(n):l=u=>{f(u)}})},get(e){return arguments.length===0?$t.slice(0):q(e)?rt($t,t=>t.id===e).getOr(null):Sn(e)&&$t[e]?$t[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&$t.push(e),Ww(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),uc||(uc=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",uc))),e},createEditor(e,t){return this.add(new lc(e,t,this))},remove(e){const t=this;let n;if(!e){for(let s=$t.length-1;s>=0;s--)t.remove($t[s]);return}if(q(e)){cc(wr.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,hn(t.get(n.id))?null:(jw(n)&&t.dispatch("RemoveEditor",{editor:n}),$t.length===0&&window.removeEventListener("beforeunload",uc),n.remove(),Ww($t.length>0),n)},execCommand(e,t,n){var s;const o=this,r=Ye(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new lc(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{cc($t,e=>{e.save()})},addI18n:(e,t)=>{_n.add(e,t)},translate:e=>_n.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new Pn(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new Pn(this.baseURL)}};Us.setup();const C5=(()=>{const e=As(),t=r=>({items:r,types:qt(r),getType:a=>Oe(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),qw=Math.min,kr=Math.max,dc=Math.round,Kw=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=dc(l/2)),c[1]==="c"&&(s+=dc(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=dc(a/2)),c[4]==="c"&&(s-=dc(r/2)),xr(s,o,r,a)},y5=(e,t,n,s)=>{for(let o=0;o<s.length;o++){const r=Kw(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},E5=(e,t,n)=>xr(e.x-t,e.y-n,e.w+t*2,e.h+n*2),S5=(e,t)=>{const n=kr(e.x,t.x),s=kr(e.y,t.y),o=qw(e.x+e.w,t.x+t.w),r=qw(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:xr(n,s,o-n,r-s)},w5=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=kr(0,t.x-s),f=kr(0,t.y-o),u=kr(0,r-i),d=kr(0,a-l);return s+=c,o+=f,n&&(r+=c,a+=f,s-=u,o-=d),r-=u,a-=d,xr(s,o,r-s,a-o)},xr=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),k5={inflate:E5,relativePosition:Kw,findBestRelativePosition:y5,intersect:S5,clamp:w5,create:xr,fromClientRect:e=>xr(e.left,e.top,e.width,e.height)},x5=(e,t,n=1e3)=>{let s=!1,o=null;const r=c=>(...f)=>{s||(s=!0,o!==null&&(clearTimeout(o),o=null),c.apply(null,f))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},N5=(()=>{const e={},t={};return{load:(r,a)=>{const i=`Script at URL "${a}" failed to load`,l=`Script at URL "${a}" did not call \`tinymce.Resource.add('${r}', data)\` within 1 second`;if(e[r]!==void 0)return e[r];{const c=new Promise((f,u)=>{const d=x5(f,u);t[r]=d.resolve,ds.ScriptLoader.loadScript(a).then(()=>d.start(l),()=>d.reject(i))});return e[r]=c,c}},add:(r,a)=>{t[r]!==void 0&&(t[r](a),delete t[r]),e[r]=Promise.resolve(a)},unload:r=>{delete e[r]}}})(),_5=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let Ga;try{const e="__storage_test__";Ga=window.localStorage,Ga.setItem(e,e),Ga.removeItem(e)}catch{Ga=_5()}var A5=Ga;const R5={geom:{Rect:k5},util:{Delay:ln,Tools:L,VK:Y,URI:Pn,EventDispatcher:km,Observable:xm,I18n:_n,LocalStorage:A5,ImageUploader:BM},dom:{EventUtils:lo,TreeWalker:it,TextSeeker:fo,DOMUtils:_e,ScriptLoader:ds,RangeUtils:Eo,Serializer:Oy,StyleSheetLoader:rp,ControlSelection:kb,BookmarkManager:Ca,Selection:By,Event:lo.Event},html:{Styles:tu,Entities:Ns,Node:Lt,Schema:_s,DomParser:pr,Writer:lv,Serializer:Bs},Env:be,AddOnManager:Nt,Annotator:pb,Formatter:Yy,UndoManager:Qy,EditorCommands:Dw,WindowManager:zy,NotificationManager:Uy,EditorObservable:Lw,Shortcuts:zw,Editor:lc,FocusManager:Kb,EditorManager:Us,DOM:_e.DOM,ScriptLoader:ds.ScriptLoader,PluginManager:br,ThemeManager:Ro,ModelManager:hr,IconManager:Nl,Resource:N5,FakeClipboard:C5,trim:L.trim,isArray:L.isArray,is:L.is,toArray:L.toArray,makeMap:L.makeMap,each:L.each,map:L.map,grep:L.grep,inArray:L.inArray,extend:L.extend,walk:L.walk,resolve:L.resolve,explode:L.explode,_addCacheSuffix:L._addCacheSuffix},Gw=L.extend(Us,R5),T5=e=>{try{te.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(Gw),T5(Gw)})()})(ok);var H5=ok.exports;const Wq=O5(H5);var V5=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],W5=function(te){return V5.map(function(Be){return Be.toLowerCase()}).indexOf(te.toLowerCase())!==-1},j5=function(te,Be,ke){Object.keys(Be).filter(W5).forEach(function(nt){var st=Be[nt];typeof st=="function"&&(nt==="onInit"?st(te,ke):ke.on(nt.substring(2),function(Ke){return st(Ke,ke)}))})},q5=function(te,Be,ke,nt){var st=te.modelEvents?te.modelEvents:null,Ke=Array.isArray(st)?st.join(" "):st;Dm(nt,function(Qt,Tt){ke&&typeof Qt=="string"&&Qt!==Tt&&Qt!==ke.getContent({format:te.outputFormat})&&ke.setContent(Qt)}),ke.on(Ke||"change input undo redo",function(){Be.emit("update:modelValue",ke.getContent({format:te.outputFormat}))})},K5=function(te,Be,ke,nt,st,Ke){nt.setContent(Ke()),ke.attrs["onUpdate:modelValue"]&&q5(Be,ke,nt,st),j5(te,ke.attrs,nt)},tk=0,rk=function(te){var Be=Date.now(),ke=Math.floor(Math.random()*1e9);return tk++,te+"_"+ke+tk+String(Be)},G5=function(te){return te!==null&&te.tagName.toLowerCase()==="textarea"},nk=function(te){return typeof te>"u"||te===""?[]:Array.isArray(te)?te:te.split(" ")},Y5=function(te,Be){return nk(te).concat(nk(Be))},X5=function(te){return te==null},sk=function(){return{listeners:[],scriptId:rk("tiny-script"),scriptLoaded:!1}},Q5=function(){var te=sk(),Be=function(st,Ke,Qt,Tt){var Ge=Ke.createElement("script");Ge.referrerPolicy="origin",Ge.type="application/javascript",Ge.id=st,Ge.src=Qt;var Hs=function(){Ge.removeEventListener("load",Hs),Tt()};Ge.addEventListener("load",Hs),Ke.head&&Ke.head.appendChild(Ge)},ke=function(st,Ke,Qt){te.scriptLoaded?Qt():(te.listeners.push(Qt),st.getElementById(te.scriptId)||Be(te.scriptId,st,Ke,function(){te.listeners.forEach(function(Tt){return Tt()}),te.scriptLoaded=!0}))},nt=function(){te=sk()};return{load:ke,reinitialize:nt}},Z5=Q5(),J5=function(){return typeof window<"u"?window:global},Fo=function(){var te=J5();return te&&te.tinymce?te.tinymce:null},eq={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(te){return te==="html"||te==="text"}}},Mo=function(){return Mo=Object.assign||function(te){for(var Be,ke=1,nt=arguments.length;ke<nt;ke++){Be=arguments[ke];for(var st in Be)Object.prototype.hasOwnProperty.call(Be,st)&&(te[st]=Be[st])}return te},Mo.apply(this,arguments)},tq=function(te,Be,ke,nt){return te(nt||"div",{id:Be,ref:ke})},nq=function(te,Be,ke){return te("textarea",{id:Be,visibility:"hidden",ref:ke})},jq=I5({props:eq,setup:function(te,Be){var ke=te.init?Mo({},te.init):{},nt=L5(te),st=nt.disabled,Ke=nt.modelValue,Qt=nt.tagName,Tt=$5(null),Ge=null,Hs=te.id||rk("tiny-vue"),Uo=te.init&&te.init.inline||te.inline,Vs=!!Be.attrs["onUpdate:modelValue"],_r=!0,Qa=te.initialValue?te.initialValue:"",zo="",Ar=function(ft){return Vs?function(){return Ke!=null&&Ke.value?Ke.value:""}:function(){return ft?Qa:zo}},ss=function(){var ft=Ar(_r),q=Mo(Mo({},ke),{readonly:te.disabled,target:Tt.value,plugins:Y5(ke.plugins,te.plugins),toolbar:te.toolbar||ke.toolbar,inline:Uo,setup:function(Ye){Ge=Ye,Ye.on("init",function(Ja){return K5(Ja,te,Be,Ye,Ke,ft)}),typeof ke.setup=="function"&&ke.setup(Ye)}});G5(Tt.value)&&(Tt.value.style.visibility=""),Fo().init(q),_r=!1};Dm(st,function(ft){var q;Ge!==null&&(typeof((q=Ge.mode)===null||q===void 0?void 0:q.set)=="function"?Ge.mode.set(ft?"readonly":"design"):Ge.setMode(ft?"readonly":"design"))}),Dm(Qt,function(ft){var q;Vs||(zo=Ge.getContent()),(q=Fo())===null||q===void 0||q.remove(Ge),Jw(function(){return ss()})}),F5(function(){if(Fo()!==null)ss();else if(Tt.value&&Tt.value.ownerDocument){var ft=te.cloudChannel?te.cloudChannel:"6",q=te.apiKey?te.apiKey:"no-api-key",Ye=X5(te.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(q,"/tinymce/").concat(ft,"/tinymce.min.js"):te.tinymceScriptSrc;Z5.load(Tt.value.ownerDocument,Ye,ss)}}),M5(function(){Fo()!==null&&Fo().remove(Ge)}),Uo||(U5(function(){_r||ss()}),z5(function(){var ft;Vs||(zo=Ge.getContent()),(ft=Fo())===null||ft===void 0||ft.remove(Ge)}));var Za=function(ft){var q;zo=Ge.getContent(),(q=Fo())===null||q===void 0||q.remove(Ge),ke=Mo(Mo({},ke),ft),Jw(function(){return ss()})};return Be.expose({rerender:Za,getEditor:function(){return Ge}}),function(){return Uo?tq(ek,Hs,Tt,te.tagName):nq(ek,Hs,Tt)}}});export{jq as E,Wq as t};
