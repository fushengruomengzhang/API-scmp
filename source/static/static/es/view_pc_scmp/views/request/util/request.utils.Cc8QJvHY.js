import{u as L}from"../../../../resources/global/global.util.CrvsVFo3.js";import{a as N}from"../../../../resources/util/crypto.util.Cg1BRL9K.js";import{s as O}from"../../../../../../public.scmp.config.js";import{G as H}from"../../../../vue.CpRb0aFL.js";const v=new TextDecoder("utf-8"),D={String:"",Number:0,Boolean:!1,List:[],Object:{}},q=t=>Array.isArray(t)?t.map(q):t!==null&&typeof t=="object"?Object.keys(t).sort().reduce((e,n)=>(e[n]=q(t[n]),e),{}):t,_=t=>{if(t)try{const e=q(t instanceof Object?t:new Function("return "+t)());return JSON.stringify(e,null,4).replace(new RegExp('(?<!\\\\)"([^"]+)":',"g"),'"$1": ')}catch(e){return e}},S=(t,e=void 0)=>{const n=e==="List"?[]:{};for(let p in t){let{key:l,type:a,value:i,children:r}=t[p];const s=e==="List";if(a==="List"||a==="Object"){const c=S(r,a);s?n.push(c):n[l]=c}else{let c=D[a];i&&(c=a==="Number"?Number(i):a==="Boolean"?new Function(`return !!${i}`)():i),s?n.push(c):n[l]=c}}return n},b=(t,e="",n=void 0,p=!1)=>{const l=e==="List"?[]:{};for(let a in t){let{check:i,key:r,type:s,value:c,desc:u,children:g}=t[a];const y=e==="List";if(s==="List"||s==="Object"){n&&(n[r]=s==="List"?[]:{});const d=e==="List"||!u?r:r+" // "+u;l[d]=b(g,s,n?n[r]:void 0,p)}else{const d=c||D[s];n&&(n[r]=d);const h=p?{类型:s,描述:u}:{参数值:d,参数类型:s,是否必填:i,描述:u};y?l.push(h):l[r]=h}}return l},x=t=>t.map((e,n)=>{const{name:p,desc:l,config:{method:a,contextPath:i,prefix:r,url:s}}=e;return`${n}. ${p}
    ${l||""}
    ${a} ${L(i,r,s)}`}).join(`

`),F=(t,e)=>{const{method:n,header:p,query:l,queryBody:a,bodyType:i,formBodyDocument:r}=t.config,s=i||"application/json",c={},u=p||[];(localStorage.get("RequestApi_GlobalRequestHeader")||[]).filter(o=>o.check).forEach(o=>c[o.key]=c[o.key]?c[o.key]+";"+o.value:o.value),u.filter(o=>o.check).forEach(o=>c[o.key]=c[o.key]?c[o.key]+";"+o.value:o.value);const y=!!u.filter(o=>o.key==="Content-Type").length;let d={},h;return l&&l.filter(o=>o.check).forEach(o=>{d[o.key]||(d[o.key]=[]),d[o.key].push(o.value)}),["application/json","application/xml"].includes(s)?(y||(c["Content-Type"]=s),h=JSON.stringify(new Function("return "+a)())):s==="application/x-www-form-urlencoded"?y||(c["Content-Type"]=s):(h=new FormData,r.filter(o=>o.check).forEach(o=>{if(o.type==="File")o.value.filter(m=>e.contains(m)).forEach(m=>h.append(o.key,e.get(m).raw,m));else{let m=o.type!=="List"?o.value:o.children.map(w=>w.value);h.append(o.key,m)}})),{method:n,headers:c,params:d,data:h}},P=(t,e=1,n,p,l)=>{const{method:a,header:i,query:r,queryBody:s,bodyType:c,formBodyDocument:u,urlBodyDocument:g}=p.config,y=c||"application/json",d=i?i.map(f=>f):[],h=localStorage.get("RequestApi_GlobalRequestHeader")||[],o=d.map(f=>f.key);h.filter(f=>f.check&&!o.includes(f.key)).forEach(f=>d.push(f));let m,w;["application/json","application/xml"].includes(y)?m=new Function("return "+s)():y==="application/x-www-form-urlencoded"?w=g:w=u,!!!d.filter(f=>f.key==="Content-Type").length&&(s||w&&w.length)&&d.push({check:!0,key:"Content-Type",value:y});const A=l.values().map(f=>f.raw),R={reqNum:e,method:a,url:t,param:m,config:{header:d,query:r,body:w}},k=new FormData;A.forEach(f=>k.append("files",f,f.name));const E=n?N(JSON.stringify(R),"request/api/req"):JSON.stringify(R);return k.append("reqDetail",new Blob([E],{type:"application/json"}),"reqDetail.json"),k},G=t=>!!window._GM_xmlHttpRequest&&O.request.checkLocalIp&&["127.0.0.1","localhost"].includes(t),$=(t="GET",e,n,p,l)=>{if(!window._GM_xmlHttpRequest)return Promise.reject("请安装篡改猴>5.3.3插件,配置跨域脚本,详情请查看说明文档");if(!t||!e)return Promise.reject("请配置请求方法和请求路径,详情请查看说明文档");if(t=t.toLocaleUpperCase(),p)try{e=e.replace(/\{([^}]+)}/g,(a,i)=>p[i]||a),e=new URL(e),Object.entries(p).forEach(([a,i])=>i.forEach(r=>e.searchParams.append(a,r))),e=e.toString()}catch(a){return Promise.reject(a)}return["GET","HEAD"].includes(t)&&(l=void 0),new Promise((a,i)=>{window._GM_xmlHttpRequest({method:t,url:e,headers:n,data:l,onabort:r=>i("Local Request aborted"),onerror:r=>i(r.error||"Local Request Fail"),onload:r=>{const s={};r.responseHeaders.split(`\r
`).forEach(u=>{const[g,y]=u.split(":");s[g]=decodeURIComponent(y)});let c=r.response;r.status===200?a({_data:c,request:r,headers:s}):i({response:{data:c,headers:s,status:r.status}})}})})},M=(t,e,n,p,l,a)=>new Promise((i,r)=>{const{decryEncryAttempt:s}=l,c=L(t,n),u=new XMLHttpRequest;let g=H(""),y={};u.onreadystatechange=d=>{if(u.readyState===2)return u.getAllResponseHeaders().split(`\r
`).forEach(h=>{const[o,m]=h.split(":");o&&m&&(y[o]=decodeURIComponent(m))}),a({_data:g,headers:y});u.readyState===4&&i({_data:g,headers:y})},u.onprogress=d=>g.value=u.response,u.open(e,c,!0),s||u.setRequestHeader("Attempt-Decry-Encry","Base64"),u.send(p)}),I=t=>{let e=t._data,n=t.headers;if(n){n.toJSON&&(n=n.toJSON());const p=n["content-disposition"];if(p){const l=p.match(/filename\*=([^']*)'([^']*)'([^;]+)/);let a="";if(l){const[,s,,c]=l;a=decodeURIComponent(c)}if(!a){const s=p.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);s!=null&&s[1]&&(a=s[1].replace(/['"]/g,""))}const i=n["content-type"],r=URL.createObjectURL(new Blob([t.request.response],{type:i}));e={fileName:a,download:JSON.stringify({downloadUrl:r,fileName:a,isDownload:!0})}}}if(e&&e.byteLength>-1&&(e=v.decode(new Uint8Array(e))),e&&typeof e=="string")try{e=JSON.parse(e)}catch{}return{ResponseData:e,ResponseHeader:n}},j=t=>{if(t.response){let e=t.response.data,n=t.response.headers;return n!=null&&n.toJSON&&(n=n.toJSON()),e&&e.byteLength>-1&&(e=v.decode(new Uint8Array(e))),{ResponseData:e,ResponseHeader:n}}return{ResponseData:t}},K="apiUseDoc",V="apiAdmin",X="ApiDocAdmin";export{X as A,V as a,K as b,j as c,F as d,P as e,_ as f,S as g,I as h,x as i,$ as l,M as s,b as t,G as u};
