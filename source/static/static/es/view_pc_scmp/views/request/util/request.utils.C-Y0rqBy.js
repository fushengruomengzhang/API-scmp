import{r as b,u as O,f as J}from"../../../../resources/global/global.util.CdGU-cda.js";import{a as P}from"../../../../resources/util/crypto.util.De05Bpu1.js";import{s as T}from"../../../../../../public.scmp.config.js";import{G as U}from"../../../../vue.B9VI7CMM.js";const q=new TextDecoder("utf-8"),v={String:"",Number:0,Boolean:!1,List:[],Object:{}},k=t=>Array.isArray(t)?t.map(k):t!==null&&typeof t=="object"?Object.keys(t).sort().reduce((e,n)=>(e[n]=k(t[n]),e),{}):t,z=t=>{if(t)try{const e=k(t instanceof Object?t:new Function("return "+t)());return JSON.stringify(e,null,4).replace(new RegExp('(?<!\\\\)"([^"]+)":',"g"),'"$1":')}catch(e){return e}},F=(t,e=void 0)=>{const n=e==="List"?[]:{};for(let a in t){let{key:f,type:o,value:i,children:c}=t[a];const r=e==="List";if(o==="List"||o==="Object"){const p=F(c,o);r?n.push(p):n[f]=p}else{let p=v[o];i&&(p=o==="Number"?Number(i):o==="Boolean"?new Function(`return !!${i}`)():i),r?n.push(p):n[f]=p}}return n},x=(t,e="",n=void 0,a=!1)=>{const f=e==="List"?[]:{};for(let o in t){let{check:i,key:c,type:r,value:p,desc:l,children:h}=t[o];const g=e==="List";if(r==="List"||r==="Object"){n&&(n[c]=r==="List"?[]:{});const d=e==="List"||!l?c:c+" // "+l;f[d]=x(h,r,n?n[c]:void 0,a)}else{const d=p||v[r];n&&(n[c]=d);const w=a?{类型:r,描述:l}:{参数值:d,参数类型:r,是否必填:i,描述:l};g?f.push(w):f[c]=w}}return f},I=t=>t.map((e,n)=>{const{name:a,desc:f,config:{method:o,contextPath:i,prefix:c,url:r}}=e;return`${n}. ${a}
    ${f||""}
    ${o} ${O(i,c,r)}`}).join(`

`),K=(t,e,n)=>{const{method:a,header:f,query:o,queryBody:i,bodyType:c,formBodyDocument:r}=e.config,p=c||"application/json",l={},h=f||[];(localStorage.get("RequestApi_GlobalRequestHeader")||[]).filter(s=>s.check).forEach(s=>l[s.key]=l[s.key]?l[s.key]+";"+s.value:s.value),h.filter(s=>s.check).forEach(s=>l[s.key]=l[s.key]?l[s.key]+";"+s.value:s.value);const d=!!h.filter(s=>s.key==="Content-Type").length;let w={},m;if(i&&(m=new Function("return "+i)()),_()){const s=E(e);o&&L(s,t,o),i&&L(s,t,m,"","Object"),r&&L(s,t,r)}return o&&o.filter(s=>s.check).forEach(s=>{w[s.key]||(w[s.key]=[]),w[s.key].push(s.value)}),["application/json","application/xml"].includes(p)?(d||(l["Content-Type"]=p),m=JSON.stringify(m)):p==="application/x-www-form-urlencoded"?d||(l["Content-Type"]=p):(m=new FormData,r.filter(s=>s.check).forEach(s=>{if(s.type==="File")s.value.filter(y=>n.contains(y)).forEach(y=>m.append(s.key,n.get(y).raw,y));else{let y=s.type!=="List"?s.value:s.children.map(A=>A.value);m.append(s.key,y)}})),{method:a,headers:l,params:w,data:m}},V=(t,e=1,n,a,f)=>{let{method:o,header:i,query:c,queryBody:r,bodyType:p,formBodyDocument:l,urlBodyDocument:h}=a.config;const g=p||"application/json",d=i?i.map(u=>u):[],w=localStorage.get("RequestApi_GlobalRequestHeader")||[],m=d.map(u=>u.key);w.filter(u=>u.check&&!m.includes(u.key)).forEach(u=>d.push(u));let s,y;if(["application/json","application/xml"].includes(g)?s=new Function("return "+r)():g==="application/x-www-form-urlencoded"?y=h:y=l,!!!d.filter(u=>u.key==="Content-Type").length&&(r||y&&y.length)&&d.push({check:!0,key:"Content-Type",value:g}),_()){const u=E(a);s&&L(u,e,s,"","Object"),y&&L(u,e,y),c&&L(u,e,c)}const H=f.values().map(u=>u.raw),D={reqNum:e,method:o,url:t,param:s,config:{header:d,query:c,body:y}},R=new FormData;H.forEach(u=>R.append("files",u,u.name));const C=n?P(JSON.stringify(D),"request/api/req"):JSON.stringify(D);return R.append("reqDetail",new Blob([C],{type:"application/json"}),"reqDetail.json"),R},E=({name:t,config:{method:e,contextPath:n,prefix:a,url:f}})=>({name:t,method:e,url:O(n,a,f)}),L=(t,e,n,a="",f)=>{f==="Object"?Object.keys(n).forEach(o=>{n[o]=S(t,e,o,n[o])}):n.forEach(o=>{const{key:i,value:c,type:r}=o;r!=="File"&&((r==="Object"||r==="List")&&L(t,e,c,[a,i].join(".")),o.value=S(t,e,i,c,a))})},S=(t,e,n,a,f)=>{if(!window._NBA_formatParam)return a;const o=window._NBA_formatParam(t,e,n,a,f);return o||a},_=()=>!!window._NBA_formatParam,X=t=>!!window._GM_xmlHttpRequest&&T.request.checkLocalIp&&["127.0.0.1","localhost"].includes(t),Q=(t="GET",e,n,a,f)=>{if(!window._GM_xmlHttpRequest)return Promise.reject("请安装篡改猴>5.3.3插件,配置跨域脚本,详情请查看说明文档");if(!t||!e)return Promise.reject("请配置请求方法和请求路径,详情请查看说明文档");if(t=t.toLocaleUpperCase(),a)try{e=e.replace(/\{([^}]+)}/g,(o,i)=>a[i]||o),e=new URL(e),Object.entries(a).forEach(([o,i])=>i.forEach(c=>e.searchParams.append(o,c))),e=e.toString()}catch(o){return Promise.reject(o)}return["GET","HEAD"].includes(t)&&(f=void 0),new Promise((o,i)=>{window._GM_xmlHttpRequest({method:t,url:e,headers:n,data:f,onabort:c=>i("Local Request aborted"),onerror:c=>i(c.error||"Local Request Fail"),onload:c=>{const r={};c.responseHeaders.split(`\r
`).forEach(l=>{const[h,g]=l.split(":");r[h]=decodeURIComponent(g)});let p=c.response;c.status===200?o({_data:p,request:c,headers:r}):i({response:{data:p,headers:r,status:c.status}})}})})},W=(t,e,n,a,f,o)=>new Promise((i,c)=>{const{decryEncryAttempt:r}=f,p=O(t,n),l=new XMLHttpRequest;let h=U(""),g={};l.onreadystatechange=d=>{if(l.readyState===2)return l.getAllResponseHeaders().split(`\r
`).forEach(w=>{const[m,s]=w.split(":");m&&s&&(g[m]=decodeURIComponent(s))}),o({_data:h,headers:g,status:l.status});l.readyState===4&&i()},l.onprogress=d=>Object.assign(h,{value:l.response,byteLength:d.loaded}),l.open(e,p,!0),r||l.setRequestHeader("Attempt-Decry-Encry","Base64"),l.send(a)}),Y=t=>{let e=t._data,n=t.headers;if(n){n.toJSON&&(n=n.toJSON());const a=n["content-disposition"];if(a){const f=a.match(/filename\*=([^']*)'([^']*)'([^;]+)/);let o="";if(f){const[,r,,p]=f;o=decodeURIComponent(p)}if(!o){const r=a.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);r!=null&&r[1]&&(o=r[1].replace(/['"]/g,""))}const i=n["content-type"],c=URL.createObjectURL(new Blob([t.request.response],{type:i}));e={fileName:o,download:JSON.stringify({downloadUrl:c,fileName:o,isDownload:!0})}}}if(e&&e.byteLength>-1&&(e=q.decode(new Uint8Array(e))),e&&typeof e=="string")try{e=JSON.parse(e)}catch{}return{ResponseData:e,ResponseHeader:n,ContentSize:N(t),ResponseStatus:B(t)}},Z=t=>{if(t.response){let e=t.response.data,n=t.response.headers;if(n!=null&&n.toJSON&&(n=n.toJSON()),e&&e.byteLength>-1&&(e=q.decode(new Uint8Array(e))),e&&typeof e=="string")try{e=JSON.parse(e)}catch{}return{ResponseData:e,ResponseHeader:n,ContentSize:N(t),ResponseStatus:B(t)}}return{ResponseData:t,ContentSize:()=>"0B"}},B=t=>b(()=>t.status||t.response.status,.3),N=t=>b(()=>{var n,a;let e=((n=t._data)==null?void 0:n.byteLength)||((a=t.request)==null?void 0:a.response.byteLength);return J(Number(e||0))},.3),ee="apiUseDoc",te="apiAdmin",ne="ApiDocAdmin",se="swaggerAdminName";export{ne as A,te as a,ee as b,Z as c,_ as d,W as e,K as f,V as g,Y as h,x as i,F as j,z as k,Q as l,v as m,se as s,I as t,X as u};
